!function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},t=e._,n=Array.prototype,i=Object.prototype,r="undefined"!=typeof Symbol?Symbol.prototype:null,o=n.push,s=n.slice,a=i.toString,l=i.hasOwnProperty,u=Array.isArray,c=Object.keys,h=Object.create,d=function(){},f=function(e){return e instanceof f?e:this instanceof f?void(this._wrapped=e):new f(e)};"undefined"==typeof exports||exports.nodeType?e._=f:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=f),exports._=f),f.VERSION="1.9.1";var p,m=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return function(){return e.apply(t,arguments)}},g=function(e,t,n){return f.iteratee!==p?f.iteratee(e,t):null==e?f.identity:f.isFunction(e)?m(e,t,n):f.isObject(e)&&!f.isArray(e)?f.matcher(e):f.property(e)};f.iteratee=p=function(e,t){return g(e,t,1/0)};var v=function(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),i=Array(n),r=0;n>r;r++)i[r]=arguments[r+t];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,arguments[0],i);case 2:return e.call(this,arguments[0],arguments[1],i)}var o=Array(t+1);for(r=0;t>r;r++)o[r]=arguments[r];return o[t]=i,e.apply(this,o)}},y=function(e){if(!f.isObject(e))return{};if(h)return h(e);d.prototype=e;var t=new d;return d.prototype=null,t},b=function(e){return function(t){return null==t?void 0:t[e]}},w=function(e,t){return null!=e&&l.call(e,t)},x=function(e,t){for(var n=t.length,i=0;n>i;i++){if(null==e)return void 0;e=e[t[i]]}return n?e:void 0},_=Math.pow(2,53)-1,C=b("length"),k=function(e){var t=C(e);return"number"==typeof t&&t>=0&&_>=t};f.each=f.forEach=function(e,t,n){t=m(t,n);var i,r;if(k(e))for(i=0,r=e.length;r>i;i++)t(e[i],i,e);else{var o=f.keys(e);for(i=0,r=o.length;r>i;i++)t(e[o[i]],o[i],e)}return e},f.map=f.collect=function(e,t,n){t=g(t,n);for(var i=!k(e)&&f.keys(e),r=(i||e).length,o=Array(r),s=0;r>s;s++){var a=i?i[s]:s;o[s]=t(e[a],a,e)}return o};var E=function(e){var t=function(t,n,i,r){var o=!k(t)&&f.keys(t),s=(o||t).length,a=e>0?0:s-1;for(r||(i=t[o?o[a]:a],a+=e);a>=0&&s>a;a+=e){var l=o?o[a]:a;i=n(i,t[l],l,t)}return i};return function(e,n,i,r){var o=arguments.length>=3;return t(e,m(n,r,4),i,o)}};f.reduce=f.foldl=f.inject=E(1),f.reduceRight=f.foldr=E(-1),f.find=f.detect=function(e,t,n){var i=k(e)?f.findIndex:f.findKey,r=i(e,t,n);return void 0!==r&&-1!==r?e[r]:void 0},f.filter=f.select=function(e,t,n){var i=[];return t=g(t,n),f.each(e,function(e,n,r){t(e,n,r)&&i.push(e)}),i},f.reject=function(e,t,n){return f.filter(e,f.negate(g(t)),n)},f.every=f.all=function(e,t,n){t=g(t,n);for(var i=!k(e)&&f.keys(e),r=(i||e).length,o=0;r>o;o++){var s=i?i[o]:o;if(!t(e[s],s,e))return!1}return!0},f.some=f.any=function(e,t,n){t=g(t,n);for(var i=!k(e)&&f.keys(e),r=(i||e).length,o=0;r>o;o++){var s=i?i[o]:o;if(t(e[s],s,e))return!0}return!1},f.contains=f.includes=f.include=function(e,t,n,i){return k(e)||(e=f.values(e)),("number"!=typeof n||i)&&(n=0),f.indexOf(e,t,n)>=0},f.invoke=v(function(e,t,n){var i,r;return f.isFunction(t)?r=t:f.isArray(t)&&(i=t.slice(0,-1),t=t[t.length-1]),f.map(e,function(e){var o=r;if(!o){if(i&&i.length&&(e=x(e,i)),null==e)return void 0;o=e[t]}return null==o?o:o.apply(e,n)})}),f.pluck=function(e,t){return f.map(e,f.property(t))},f.where=function(e,t){return f.filter(e,f.matcher(t))},f.findWhere=function(e,t){return f.find(e,f.matcher(t))},f.max=function(e,t,n){var i,r,o=-(1/0),s=-(1/0);if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e){e=k(e)?e:f.values(e);for(var a=0,l=e.length;l>a;a++)i=e[a],null!=i&&i>o&&(o=i)}else t=g(t,n),f.each(e,function(e,n,i){r=t(e,n,i),(r>s||r===-(1/0)&&o===-(1/0))&&(o=e,s=r)});return o},f.min=function(e,t,n){var i,r,o=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e){e=k(e)?e:f.values(e);for(var a=0,l=e.length;l>a;a++)i=e[a],null!=i&&o>i&&(o=i)}else t=g(t,n),f.each(e,function(e,n,i){r=t(e,n,i),(s>r||r===1/0&&o===1/0)&&(o=e,s=r)});return o},f.shuffle=function(e){return f.sample(e,1/0)},f.sample=function(e,t,n){if(null==t||n)return k(e)||(e=f.values(e)),e[f.random(e.length-1)];var i=k(e)?f.clone(e):f.values(e),r=C(i);t=Math.max(Math.min(t,r),0);for(var o=r-1,s=0;t>s;s++){var a=f.random(s,o),l=i[s];i[s]=i[a],i[a]=l}return i.slice(0,t)},f.sortBy=function(e,t,n){var i=0;return t=g(t,n),f.pluck(f.map(e,function(e,n,r){return{value:e,index:i++,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var T=function(e,t){return function(n,i,r){var o=t?[[],[]]:{};return i=g(i,r),f.each(n,function(t,r){var s=i(t,r,n);e(o,t,s)}),o}};f.groupBy=T(function(e,t,n){w(e,n)?e[n].push(t):e[n]=[t]}),f.indexBy=T(function(e,t,n){e[n]=t}),f.countBy=T(function(e,t,n){w(e,n)?e[n]++:e[n]=1});var S=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;f.toArray=function(e){return e?f.isArray(e)?s.call(e):f.isString(e)?e.match(S):k(e)?f.map(e,f.identity):f.values(e):[]},f.size=function(e){return null==e?0:k(e)?e.length:f.keys(e).length},f.partition=T(function(e,t,n){e[n?0:1].push(t)},!0),f.first=f.head=f.take=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[0]:f.initial(e,e.length-t)},f.initial=function(e,t,n){return s.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},f.last=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[e.length-1]:f.rest(e,Math.max(0,e.length-t))},f.rest=f.tail=f.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},f.compact=function(e){return f.filter(e,Boolean)};var M=function(e,t,n,i){i=i||[];for(var r=i.length,o=0,s=C(e);s>o;o++){var a=e[o];if(k(a)&&(f.isArray(a)||f.isArguments(a)))if(t)for(var l=0,u=a.length;u>l;)i[r++]=a[l++];else M(a,t,n,i),r=i.length;else n||(i[r++]=a)}return i};f.flatten=function(e,t){return M(e,t,!1)},f.without=v(function(e,t){return f.difference(e,t)}),f.uniq=f.unique=function(e,t,n,i){f.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=g(n,i));for(var r=[],o=[],s=0,a=C(e);a>s;s++){var l=e[s],u=n?n(l,s,e):l;t&&!n?(s&&o===u||r.push(l),o=u):n?f.contains(o,u)||(o.push(u),r.push(l)):f.contains(r,l)||r.push(l)}return r},f.union=v(function(e){return f.uniq(M(e,!0,!0))}),f.intersection=function(e){for(var t=[],n=arguments.length,i=0,r=C(e);r>i;i++){var o=e[i];if(!f.contains(t,o)){var s;for(s=1;n>s&&f.contains(arguments[s],o);s++);s===n&&t.push(o)}}return t},f.difference=v(function(e,t){return t=M(t,!0,!0),f.filter(e,function(e){return!f.contains(t,e)})}),f.unzip=function(e){for(var t=e&&f.max(e,C).length||0,n=Array(t),i=0;t>i;i++)n[i]=f.pluck(e,i);return n},f.zip=v(f.unzip),f.object=function(e,t){for(var n={},i=0,r=C(e);r>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n};var R=function(e){return function(t,n,i){n=g(n,i);for(var r=C(t),o=e>0?0:r-1;o>=0&&r>o;o+=e)if(n(t[o],o,t))return o;return-1}};f.findIndex=R(1),f.findLastIndex=R(-1),f.sortedIndex=function(e,t,n,i){n=g(n,i,1);for(var r=n(t),o=0,s=C(e);s>o;){var a=Math.floor((o+s)/2);n(e[a])<r?o=a+1:s=a}return o};var A=function(e,t,n){return function(i,r,o){var a=0,l=C(i);if("number"==typeof o)e>0?a=o>=0?o:Math.max(o+l,a):l=o>=0?Math.min(o+1,l):o+l+1;else if(n&&o&&l)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=t(s.call(i,a,l),f.isNaN),o>=0?o+a:-1;for(o=e>0?a:l-1;o>=0&&l>o;o+=e)if(i[o]===r)return o;return-1}};f.indexOf=A(1,f.findIndex,f.sortedIndex),f.lastIndexOf=A(-1,f.findLastIndex),f.range=function(e,t,n){null==t&&(t=e||0,e=0),n||(n=e>t?-1:1);for(var i=Math.max(Math.ceil((t-e)/n),0),r=Array(i),o=0;i>o;o++,e+=n)r[o]=e;return r},f.chunk=function(e,t){if(null==t||1>t)return[];for(var n=[],i=0,r=e.length;r>i;)n.push(s.call(e,i,i+=t));return n};var V=function(e,t,n,i,r){if(!(i instanceof t))return e.apply(n,r);var o=y(e.prototype),s=e.apply(o,r);return f.isObject(s)?s:o};f.bind=v(function(e,t,n){if(!f.isFunction(e))throw new TypeError("Bind must be called on a function");var i=v(function(r){return V(e,i,t,this,n.concat(r))});return i}),f.partial=v(function(e,t){var n=f.partial.placeholder,i=function(){for(var r=0,o=t.length,s=Array(o),a=0;o>a;a++)s[a]=t[a]===n?arguments[r++]:t[a];for(;r<arguments.length;)s.push(arguments[r++]);return V(e,i,this,this,s)};return i}),f.partial.placeholder=f,f.bindAll=v(function(e,t){t=M(t,!1,!1);var n=t.length;if(1>n)throw new Error("bindAll must be passed function names");for(;n--;){var i=t[n];e[i]=f.bind(e[i],e)}}),f.memoize=function(e,t){var n=function(i){var r=n.cache,o=""+(t?t.apply(this,arguments):i);return w(r,o)||(r[o]=e.apply(this,arguments)),r[o]};return n.cache={},n},f.delay=v(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),f.defer=f.partial(f.delay,f,1),f.throttle=function(e,t,n){var i,r,o,s,a=0;n||(n={});var l=function(){a=n.leading===!1?0:f.now(),i=null,s=e.apply(r,o),i||(r=o=null)},u=function(){var u=f.now();a||n.leading!==!1||(a=u);var c=t-(u-a);return r=this,o=arguments,0>=c||c>t?(i&&(clearTimeout(i),i=null),a=u,s=e.apply(r,o),i||(r=o=null)):i||n.trailing===!1||(i=setTimeout(l,c)),s};return u.cancel=function(){clearTimeout(i),a=0,i=r=o=null},u},f.debounce=function(e,t,n){var i,r,o=function(t,n){i=null,n&&(r=e.apply(t,n))},s=v(function(s){if(i&&clearTimeout(i),n){var a=!i;i=setTimeout(o,t),a&&(r=e.apply(this,s))}else i=f.delay(o,t,this,s);return r});return s.cancel=function(){clearTimeout(i),i=null},s},f.wrap=function(e,t){return f.partial(t,e)},f.negate=function(e){return function(){return!e.apply(this,arguments)}},f.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},f.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},f.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},f.once=f.partial(f.before,2),f.restArguments=v;var P=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],N=function(e,t){var n=D.length,r=e.constructor,o=f.isFunction(r)&&r.prototype||i,s="constructor";for(w(e,s)&&!f.contains(t,s)&&t.push(s);n--;)s=D[n],s in e&&e[s]!==o[s]&&!f.contains(t,s)&&t.push(s)};f.keys=function(e){if(!f.isObject(e))return[];if(c)return c(e);var t=[];for(var n in e)w(e,n)&&t.push(n);return P&&N(e,t),t},f.allKeys=function(e){if(!f.isObject(e))return[];var t=[];for(var n in e)t.push(n);return P&&N(e,t),t},f.values=function(e){for(var t=f.keys(e),n=t.length,i=Array(n),r=0;n>r;r++)i[r]=e[t[r]];return i},f.mapObject=function(e,t,n){t=g(t,n);for(var i=f.keys(e),r=i.length,o={},s=0;r>s;s++){var a=i[s];o[a]=t(e[a],a,e)}return o},f.pairs=function(e){for(var t=f.keys(e),n=t.length,i=Array(n),r=0;n>r;r++)i[r]=[t[r],e[t[r]]];return i},f.invert=function(e){for(var t={},n=f.keys(e),i=0,r=n.length;r>i;i++)t[e[n[i]]]=n[i];return t},f.functions=f.methods=function(e){var t=[];for(var n in e)f.isFunction(e[n])&&t.push(n);return t.sort()};var j=function(e,t){return function(n){var i=arguments.length;if(t&&(n=Object(n)),2>i||null==n)return n;for(var r=1;i>r;r++)for(var o=arguments[r],s=e(o),a=s.length,l=0;a>l;l++){var u=s[l];t&&void 0!==n[u]||(n[u]=o[u])}return n}};f.extend=j(f.allKeys),f.extendOwn=f.assign=j(f.keys),f.findKey=function(e,t,n){t=g(t,n);for(var i,r=f.keys(e),o=0,s=r.length;s>o;o++)if(i=r[o],t(e[i],i,e))return i};var O=function(e,t,n){return t in n};f.pick=v(function(e,t){var n={},i=t[0];if(null==e)return n;f.isFunction(i)?(t.length>1&&(i=m(i,t[1])),t=f.allKeys(e)):(i=O,t=M(t,!1,!1),e=Object(e));for(var r=0,o=t.length;o>r;r++){var s=t[r],a=e[s];i(a,s,e)&&(n[s]=a)}return n}),f.omit=v(function(e,t){var n,i=t[0];return f.isFunction(i)?(i=f.negate(i),t.length>1&&(n=t[1])):(t=f.map(M(t,!1,!1),String),i=function(e,n){return!f.contains(t,n)}),f.pick(e,i,n)}),f.defaults=j(f.allKeys,!0),f.create=function(e,t){var n=y(e);return t&&f.extendOwn(n,t),n},f.clone=function(e){return f.isObject(e)?f.isArray(e)?e.slice():f.extend({},e):e},f.tap=function(e,t){return t(e),e},f.isMatch=function(e,t){var n=f.keys(t),i=n.length;if(null==e)return!i;for(var r=Object(e),o=0;i>o;o++){var s=n[o];if(t[s]!==r[s]||!(s in r))return!1}return!0};var I,F;I=function(e,t,n,i){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return!1;if(e!==e)return t!==t;var r=typeof e;return"function"!==r&&"object"!==r&&"object"!=typeof t?!1:F(e,t,n,i)},F=function(e,t,n,i){e instanceof f&&(e=e._wrapped),t instanceof f&&(t=t._wrapped);var o=a.call(e);if(o!==a.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return r.valueOf.call(e)===r.valueOf.call(t)}var s="[object Array]"===o;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,u=t.constructor;if(l!==u&&!(f.isFunction(l)&&l instanceof l&&f.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var c=n.length;c--;)if(n[c]===e)return i[c]===t;if(n.push(e),i.push(t),s){if(c=e.length,c!==t.length)return!1;for(;c--;)if(!I(e[c],t[c],n,i))return!1}else{var h,d=f.keys(e);if(c=d.length,f.keys(t).length!==c)return!1;for(;c--;)if(h=d[c],!w(t,h)||!I(e[h],t[h],n,i))return!1}return n.pop(),i.pop(),!0},f.isEqual=function(e,t){return I(e,t)},f.isEmpty=function(e){return null==e?!0:k(e)&&(f.isArray(e)||f.isString(e)||f.isArguments(e))?0===e.length:0===f.keys(e).length},f.isElement=function(e){return!(!e||1!==e.nodeType)},f.isArray=u||function(e){return"[object Array]"===a.call(e)},f.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},f.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){f["is"+e]=function(t){return a.call(t)==="[object "+e+"]"}}),f.isArguments(arguments)||(f.isArguments=function(e){return w(e,"callee")});var B=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof B&&(f.isFunction=function(e){return"function"==typeof e||!1}),f.isFinite=function(e){return!f.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},f.isNaN=function(e){return f.isNumber(e)&&isNaN(e)},f.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===a.call(e)},f.isNull=function(e){return null===e},f.isUndefined=function(e){return void 0===e},f.has=function(e,t){if(!f.isArray(t))return w(e,t);for(var n=t.length,i=0;n>i;i++){var r=t[i];if(null==e||!l.call(e,r))return!1;e=e[r]}return!!n},f.noConflict=function(){return e._=t,this},f.identity=function(e){return e},f.constant=function(e){return function(){return e}},f.noop=function(){},f.property=function(e){return f.isArray(e)?function(t){return x(t,e)}:b(e)},f.propertyOf=function(e){return null==e?function(){}:function(t){return f.isArray(t)?x(e,t):e[t]}},f.matcher=f.matches=function(e){return e=f.extendOwn({},e),function(t){return f.isMatch(t,e)}},f.times=function(e,t,n){var i=Array(Math.max(0,e));t=m(t,n,1);for(var r=0;e>r;r++)i[r]=t(r);return i},f.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},f.now=Date.now||function(){return(new Date).getTime()};var q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},$=f.invert(q),L=function(e){var t=function(t){return e[t]},n="(?:"+f.keys(e).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(r,t):e}};f.escape=L(q),f.unescape=L($),f.result=function(e,t,n){f.isArray(t)||(t=[t]);var i=t.length;if(!i)return f.isFunction(n)?n.call(e):n;for(var r=0;i>r;r++){var o=null==e?void 0:e[t[r]];void 0===o&&(o=n,r=i),e=f.isFunction(o)?o.call(e):o}return e};var z=0;f.uniqueId=function(e){var t=++z+"";return e?e+t:t},f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,W={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,X=function(e){return"\\"+W[e]};f.template=function(e,t,n){!t&&n&&(t=n),t=f.defaults({},t,f.templateSettings);var i=RegExp([(t.escape||H).source,(t.interpolate||H).source,(t.evaluate||H).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(i,function(t,n,i,s,a){return o+=e.slice(r,a).replace(U,X),r=a+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";var s;try{s=new Function(t.variable||"obj","_",o)}catch(a){throw a.source=o,a}var l=function(e){return s.call(this,e,f)},u=t.variable||"obj";return l.source="function("+u+"){\n"+o+"}",l},f.chain=function(e){var t=f(e);return t._chain=!0,t};var K=function(e,t){return e._chain?f(t).chain():t};f.mixin=function(e){return f.each(f.functions(e),function(t){var n=f[t]=e[t];f.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),K(this,n.apply(f,e))}}),f},f.mixin(f),f.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];f.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],K(this,n)}}),f.each(["concat","join","slice"],function(e){var t=n[e];f.prototype[e]=function(){return K(this,t.apply(this._wrapped,arguments))}}),f.prototype.value=function(){return this._wrapped},f.prototype.valueOf=f.prototype.toJSON=f.prototype.value,f.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return f})}(),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e,t,n){t=t||se;var i,r=t.createElement("script");if(r.text=e,n)for(i in we)n[i]&&(r[i]=n[i]);t.head.appendChild(r).parentNode.removeChild(r)}function i(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?de[fe.call(e)]||"object":typeof e}function r(e){var t=!!e&&"length"in e&&e.length,n=i(e);return ye(e)||be(e)?!1:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function o(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function s(e,t,n){return ye(t)?_e.grep(e,function(e,i){return!!t.call(e,i,e)!==n}):t.nodeType?_e.grep(e,function(e){return e===t!==n}):"string"!=typeof t?_e.grep(e,function(e){return he.call(t,e)>-1!==n}):_e.filter(t,e,n)}function a(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function l(e){var t={};return _e.each(e.match(Ne)||[],function(e,n){t[n]=!0}),t}function u(e){return e}function c(e){throw e}function h(e,t,n,i){var r;try{e&&ye(r=e.promise)?r.call(e).done(t).fail(n):e&&ye(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}function d(){se.removeEventListener("DOMContentLoaded",d),e.removeEventListener("load",d),_e.ready()}function f(e,t){return t.toUpperCase()}function p(e){return e.replace(Fe,"ms-").replace(Be,f)}function m(){this.expando=_e.expando+m.uid++}function g(e){return"true"===e?!0:"false"===e?!1:"null"===e?null:e===+e+""?+e:ze.test(e)?JSON.parse(e):e}function v(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(He,"-$&").toLowerCase(),n=e.getAttribute(i),"string"==typeof n){try{n=g(n)}catch(r){}Le.set(e,t,n)}else n=void 0;return n}function y(e,t,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return _e.css(e,t,"")},l=a(),u=n&&n[3]||(_e.cssNumber[t]?"":"px"),c=(_e.cssNumber[t]||"px"!==u&&+l)&&Ue.exec(_e.css(e,t));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;s--;)_e.style(e,t,c+u),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),c/=o;c=2*c,_e.style(e,t,c+u),n=n||[]}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=c,i.end=r)),r}function b(e){var t,n=e.ownerDocument,i=e.nodeName,r=Ye[i];return r?r:(t=n.body.appendChild(n.createElement(i)),r=_e.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),Ye[i]=r,r)}function w(e,t){for(var n,i,r=[],o=0,s=e.length;s>o;o++)i=e[o],i.style&&(n=i.style.display,t?("none"===n&&(r[o]=$e.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&Ke(i)&&(r[o]=b(i))):"none"!==n&&(r[o]="none",$e.set(i,"display",n)));for(o=0;s>o;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}function x(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&o(e,t)?_e.merge([e],n):n}function _(e,t){for(var n=0,i=e.length;i>n;n++)$e.set(e[n],"globalEval",!t||$e.get(t[n],"globalEval"))}function C(e,t,n,r,o){for(var s,a,l,u,c,h,d=t.createDocumentFragment(),f=[],p=0,m=e.length;m>p;p++)if(s=e[p],s||0===s)if("object"===i(s))_e.merge(f,s.nodeType?[s]:s);else if(tt.test(s)){for(a=a||d.appendChild(t.createElement("div")),l=(Qe.exec(s)||["",""])[1].toLowerCase(),u=et[l]||et._default,a.innerHTML=u[1]+_e.htmlPrefilter(s)+u[2],h=u[0];h--;)a=a.lastChild;_e.merge(f,a.childNodes),a=d.firstChild,a.textContent=""}else f.push(t.createTextNode(s));for(d.textContent="",p=0;s=f[p++];)if(r&&_e.inArray(s,r)>-1)o&&o.push(s);else if(c=_e.contains(s.ownerDocument,s),a=x(d.appendChild(s),"script"),c&&_(a),n)for(h=0;s=a[h++];)Ze.test(s.type||"")&&n.push(s);return d}function k(){return!0}function E(){return!1}function T(){try{return se.activeElement}catch(e){}}function S(e,t,n,i,r,o){var s,a;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=void 0);for(a in t)S(e,a,n,i,t[a],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),r===!1)r=E;else if(!r)return e;return 1===o&&(s=r,r=function(e){return _e().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=_e.guid++)),e.each(function(){_e.event.add(this,t,r,i,n)})}function M(e,t){return o(e,"table")&&o(11!==t.nodeType?t:t.firstChild,"tr")?_e(e).children("tbody")[0]||e:e}function R(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function A(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function V(e,t){var n,i,r,o,s,a,l,u;if(1===t.nodeType){if($e.hasData(e)&&(o=$e.access(e),s=$e.set(t,o),u=o.events)){delete s.handle,s.events={};for(r in u)for(n=0,i=u[r].length;i>n;n++)_e.event.add(t,r,u[r][n])}Le.hasData(e)&&(a=Le.access(e),l=_e.extend({},a),Le.set(t,l))}}function P(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Je.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function D(e,t,i,r){t=ue.apply([],t);var o,s,a,l,u,c,h=0,d=e.length,f=d-1,p=t[0],m=ye(p);if(m||d>1&&"string"==typeof p&&!ve.checkClone&&lt.test(p))return e.each(function(n){var o=e.eq(n);m&&(t[0]=p.call(this,n,o.html())),D(o,t,i,r)});if(d&&(o=C(t,e[0].ownerDocument,!1,e,r),s=o.firstChild,1===o.childNodes.length&&(o=s),s||r)){for(a=_e.map(x(o,"script"),R),l=a.length;d>h;h++)u=o,h!==f&&(u=_e.clone(u,!0,!0),l&&_e.merge(a,x(u,"script"))),i.call(e[h],u,h);if(l)for(c=a[a.length-1].ownerDocument,_e.map(a,A),h=0;l>h;h++)u=a[h],Ze.test(u.type||"")&&!$e.access(u,"globalEval")&&_e.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?_e._evalUrl&&_e._evalUrl(u.src):n(u.textContent.replace(ut,""),c,u))}return e}function N(e,t,n){for(var i,r=t?_e.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||_e.cleanData(x(i)),i.parentNode&&(n&&_e.contains(i.ownerDocument,i)&&_(x(i,"script")),i.parentNode.removeChild(i));return e}function j(e,t,n){var i,r,o,s,a=e.style;return n=n||ht(e),n&&(s=n.getPropertyValue(t)||n[t],""!==s||_e.contains(e.ownerDocument,e)||(s=_e.style(e,t)),!ve.pixelBoxStyles()&&ct.test(s)&&dt.test(t)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function O(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function I(e){if(e in yt)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=vt.length;n--;)if(e=vt[n]+t,e in yt)return e}function F(e){var t=_e.cssProps[e];return t||(t=_e.cssProps[e]=I(e)||e),t}function B(e,t,n){var i=Ue.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function q(e,t,n,i,r,o){var s="width"===t?1:0,a=0,l=0;if(n===(i?"border":"content"))return 0;for(;4>s;s+=2)"margin"===n&&(l+=_e.css(e,n+Xe[s],!0,r)),i?("content"===n&&(l-=_e.css(e,"padding"+Xe[s],!0,r)),"margin"!==n&&(l-=_e.css(e,"border"+Xe[s]+"Width",!0,r))):(l+=_e.css(e,"padding"+Xe[s],!0,r),"padding"!==n?l+=_e.css(e,"border"+Xe[s]+"Width",!0,r):a+=_e.css(e,"border"+Xe[s]+"Width",!0,r));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-a-.5))),l}function $(e,t,n){var i=ht(e),r=j(e,t,i),o="border-box"===_e.css(e,"boxSizing",!1,i),s=o;if(ct.test(r)){if(!n)return r;r="auto"}return s=s&&(ve.boxSizingReliable()||r===e.style[t]),("auto"===r||!parseFloat(r)&&"inline"===_e.css(e,"display",!1,i))&&(r=e["offset"+t[0].toUpperCase()+t.slice(1)],s=!0),r=parseFloat(r)||0,r+q(e,t,n||(o?"border":"content"),s,i,r)+"px"}function L(e,t,n,i,r){return new L.prototype.init(e,t,n,i,r)}function z(){wt&&(se.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(z):e.setTimeout(z,_e.fx.interval),_e.fx.tick())}function H(){return e.setTimeout(function(){bt=void 0}),bt=Date.now()}function W(e,t){var n,i=0,r={height:e};for(t=t?1:0;4>i;i+=2-t)n=Xe[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function U(e,t,n){for(var i,r=(G.tweeners[t]||[]).concat(G.tweeners["*"]),o=0,s=r.length;s>o;o++)if(i=r[o].call(n,t,e))return i}function X(e,t,n){var i,r,o,s,a,l,u,c,h="width"in t||"height"in t,d=this,f={},p=e.style,m=e.nodeType&&Ke(e),g=$e.get(e,"fxshow");n.queue||(s=_e._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,_e.queue(e,"fx").length||s.empty.fire()})}));for(i in t)if(r=t[i],xt.test(r)){if(delete t[i],o=o||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;m=!0}f[i]=g&&g[i]||_e.style(e,i)}if(l=!_e.isEmptyObject(t),l||!_e.isEmptyObject(f)){h&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],u=g&&g.display,null==u&&(u=$e.get(e,"display")),c=_e.css(e,"display"),"none"===c&&(u?c=u:(w([e],!0),u=e.style.display||u,c=_e.css(e,"display"),w([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===_e.css(e,"float")&&(l||(d.done(function(){p.display=u}),null==u&&(c=p.display,u="none"===c?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),l=!1;for(i in f)l||(g?"hidden"in g&&(m=g.hidden):g=$e.access(e,"fxshow",{display:u}),o&&(g.hidden=!m),m&&w([e],!0),d.done(function(){m||w([e]),$e.remove(e,"fxshow");for(i in f)_e.style(e,i,f[i])})),l=U(m?g[i]:0,i,d),i in g||(g[i]=l.start,m&&(l.end=l.start,l.start=0))}}function K(e,t){var n,i,r,o,s;for(n in e)if(i=p(n),r=t[i],o=e[n],Array.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),s=_e.cssHooks[i],s&&"expand"in s){o=s.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=r)}else t[i]=r}function G(e,t,n){var i,r,o=0,s=G.prefilters.length,a=_e.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=bt||H(),n=Math.max(0,u.startTime+u.duration-t),i=n/u.duration||0,o=1-i,s=0,l=u.tweens.length;l>s;s++)u.tweens[s].run(o);return a.notifyWith(e,[u,o,n]),1>o&&l?n:(l||a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u]),!1)},u=a.promise({elem:e,props:_e.extend({},t),opts:_e.extend(!0,{specialEasing:{},easing:_e.easing._default},n),originalProperties:t,originalOptions:n,startTime:bt||H(),duration:n.duration,tweens:[],createTween:function(t,n){var i=_e.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(i),i},stop:function(t){var n=0,i=t?u.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)u.tweens[n].run(1);return t?(a.notifyWith(e,[u,1,0]),a.resolveWith(e,[u,t])):a.rejectWith(e,[u,t]),this}}),c=u.props;for(K(c,u.opts.specialEasing);s>o;o++)if(i=G.prefilters[o].call(u,e,c,u.opts))return ye(i.stop)&&(_e._queueHooks(u.elem,u.opts.queue).stop=i.stop.bind(i)),i;return _e.map(c,U,u),ye(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),_e.fx.timer(_e.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u}function Y(e){var t=e.match(Ne)||[];return t.join(" ")}function J(e){return e.getAttribute&&e.getAttribute("class")||""}function Q(e){return Array.isArray(e)?e:"string"==typeof e?e.match(Ne)||[]:[]}function Z(e,t,n,r){var o;if(Array.isArray(t))_e.each(t,function(t,i){n||Dt.test(e)?r(e,i):Z(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==i(t))r(e,t);else for(o in t)Z(e+"["+o+"]",t[o],n,r)}function ee(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(Ne)||[];if(ye(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function te(e,t,n,i){function r(a){var l;return o[a]=!0,_e.each(e[a]||[],function(e,a){var u=a(t,n,i);return"string"!=typeof u||s||o[u]?s?!(l=u):void 0:(t.dataTypes.unshift(u),r(u),!1)}),l}var o={},s=e===Wt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function ne(e,t){var n,i,r=_e.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&_e.extend(!0,e,i),e}function ie(e,t,n){for(var i,r,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}function re(e,t,n,i){var r,o,s,a,l,u={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)u[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(s=u[l+" "+o]||u["* "+o],!s)for(r in u)if(a=r.split(" "),a[1]===o&&(s=u[l+" "+a[0]]||u["* "+a[0]])){s===!0?s=u[r]:u[r]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(h){return{state:"parsererror",error:s?h:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}var oe=[],se=e.document,ae=Object.getPrototypeOf,le=oe.slice,ue=oe.concat,ce=oe.push,he=oe.indexOf,de={},fe=de.toString,pe=de.hasOwnProperty,me=pe.toString,ge=me.call(Object),ve={},ye=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},be=function(e){return null!=e&&e===e.window},we={type:!0,src:!0,noModule:!0},xe="3.3.1",_e=function(e,t){return new _e.fn.init(e,t)},Ce=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;_e.fn=_e.prototype={jquery:xe,constructor:_e,length:0,toArray:function(){return le.call(this)},get:function(e){return null==e?le.call(this):0>e?this[e+this.length]:this[e]},pushStack:function(e){var t=_e.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return _e.each(this,e)},map:function(e){return this.pushStack(_e.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(le.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:ce,sort:oe.sort,splice:oe.splice},_e.extend=_e.fn.extend=function(){
var e,t,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[a]||{},a++),"object"==typeof s||ye(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],i=e[t],s!==i&&(u&&i&&(_e.isPlainObject(i)||(r=Array.isArray(i)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&_e.isPlainObject(n)?n:{},s[t]=_e.extend(u,o,i)):void 0!==i&&(s[t]=i));return s},_e.extend({expando:"jQuery"+(xe+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return e&&"[object Object]"===fe.call(e)?(t=ae(e))?(n=pe.call(t,"constructor")&&t.constructor,"function"==typeof n&&me.call(n)===ge):!0:!1},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){n(e)},each:function(e,t){var n,i=0;if(r(e))for(n=e.length;n>i&&t.call(e[i],i,e[i])!==!1;i++);else for(i in e)if(t.call(e[i],i,e[i])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(Ce,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(r(Object(e))?_e.merge(n,"string"==typeof e?[e]:e):ce.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:he.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;n>i;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i,r=[],o=0,s=e.length,a=!n;s>o;o++)i=!t(e[o],o),i!==a&&r.push(e[o]);return r},map:function(e,t,n){var i,o,s=0,a=[];if(r(e))for(i=e.length;i>s;s++)o=t(e[s],s,n),null!=o&&a.push(o);else for(s in e)o=t(e[s],s,n),null!=o&&a.push(o);return ue.apply([],a)},guid:1,support:ve}),"function"==typeof Symbol&&(_e.fn[Symbol.iterator]=oe[Symbol.iterator]),_e.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){de["[object "+t+"]"]=t.toLowerCase()});var ke=function(e){function t(e,t,n,i){var r,o,s,a,l,u,c,d=t&&t.ownerDocument,p=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==p&&9!==p&&11!==p)return n;if(!i&&((t?t.ownerDocument||t:$)!==D&&P(t),t=t||D,j)){if(11!==p&&(l=ve.exec(e)))if(r=l[1]){if(9===p){if(!(s=t.getElementById(r)))return n;if(s.id===r)return n.push(s),n}else if(d&&(s=d.getElementById(r))&&B(t,s)&&s.id===r)return n.push(s),n}else{if(l[2])return Q.apply(n,t.getElementsByTagName(e)),n;if((r=l[3])&&_.getElementsByClassName&&t.getElementsByClassName)return Q.apply(n,t.getElementsByClassName(r)),n}if(!(!_.qsa||U[e+" "]||O&&O.test(e))){if(1!==p)d=t,c=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(xe,_e):t.setAttribute("id",a=q),u=T(e),o=u.length;o--;)u[o]="#"+a+" "+f(u[o]);c=u.join(","),d=ye.test(e)&&h(t.parentNode)||t}if(c)try{return Q.apply(n,d.querySelectorAll(c)),n}catch(m){}finally{a===q&&t.removeAttribute("id")}}}return M(e.replace(ae,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>C.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[q]=!0,e}function r(e){var t=D.createElement("fieldset");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),i=n.length;i--;)C.attrHandle[n[i]]=t}function s(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function u(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ke(t)===e:t.disabled===e:"label"in t?t.disabled===e:!1}}function c(e){return i(function(t){return t=+t,i(function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function h(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function d(){}function f(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function p(e,t,n){var i=t.dir,r=t.next,o=r||i,s=n&&"parentNode"===o,a=z++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,r);return!1}:function(t,n,l){var u,c,h,d=[L,a];if(l){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(h=t[q]||(t[q]={}),c=h[t.uniqueID]||(h[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[i]||t;else{if((u=c[o])&&u[0]===L&&u[1]===a)return d[2]=u[2];if(c[o]=d,d[2]=e(t,n,l))return!0}return!1}}function m(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function g(e,n,i){for(var r=0,o=n.length;o>r;r++)t(e,n[r],i);return i}function v(e,t,n,i,r){for(var o,s=[],a=0,l=e.length,u=null!=t;l>a;a++)(o=e[a])&&(!n||n(o,i,r))&&(s.push(o),u&&t.push(a));return s}function y(e,t,n,r,o,s){return r&&!r[q]&&(r=y(r)),o&&!o[q]&&(o=y(o,s)),i(function(i,s,a,l){var u,c,h,d=[],f=[],p=s.length,m=i||g(t||"*",a.nodeType?[a]:a,[]),y=!e||!i&&t?m:v(m,d,e,a,l),b=n?o||(i?e:p||r)?[]:s:y;if(n&&n(y,b,a,l),r)for(u=v(b,f),r(u,[],a,l),c=u.length;c--;)(h=u[c])&&(b[f[c]]=!(y[f[c]]=h));if(i){if(o||e){if(o){for(u=[],c=b.length;c--;)(h=b[c])&&u.push(y[c]=h);o(null,b=[],u,l)}for(c=b.length;c--;)(h=b[c])&&(u=o?ee(i,h):d[c])>-1&&(i[u]=!(s[u]=h))}}else b=v(b===s?b.splice(p,b.length):b),o?o(null,s,b,l):Q.apply(s,b)})}function b(e){for(var t,n,i,r=e.length,o=C.relative[e[0].type],s=o||C.relative[" "],a=o?1:0,l=p(function(e){return e===t},s,!0),u=p(function(e){return ee(t,e)>-1},s,!0),c=[function(e,n,i){var r=!o&&(i||n!==R)||((t=n).nodeType?l(e,n,i):u(e,n,i));return t=null,r}];r>a;a++)if(n=C.relative[e[a].type])c=[p(m(c),n)];else{if(n=C.filter[e[a].type].apply(null,e[a].matches),n[q]){for(i=++a;r>i&&!C.relative[e[i].type];i++);return y(a>1&&m(c),a>1&&f(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ae,"$1"),n,i>a&&b(e.slice(a,i)),r>i&&b(e=e.slice(i)),r>i&&f(e))}c.push(n)}return m(c)}function w(e,n){var r=n.length>0,o=e.length>0,s=function(i,s,a,l,u){var c,h,d,f=0,p="0",m=i&&[],g=[],y=R,b=i||o&&C.find.TAG("*",u),w=L+=null==y?1:Math.random()||.1,x=b.length;for(u&&(R=s===D||s||u);p!==x&&null!=(c=b[p]);p++){if(o&&c){for(h=0,s||c.ownerDocument===D||(P(c),a=!j);d=e[h++];)if(d(c,s||D,a)){l.push(c);break}u&&(L=w)}r&&((c=!d&&c)&&f--,i&&m.push(c))}if(f+=p,r&&p!==f){for(h=0;d=n[h++];)d(m,g,s,a);if(i){if(f>0)for(;p--;)m[p]||g[p]||(g[p]=Y.call(l));g=v(g)}Q.apply(l,g),u&&!i&&g.length>0&&f+n.length>1&&t.uniqueSort(l)}return u&&(L=w,R=y),m};return r?i(s):s}var x,_,C,k,E,T,S,M,R,A,V,P,D,N,j,O,I,F,B,q="sizzle"+1*new Date,$=e.document,L=0,z=0,H=n(),W=n(),U=n(),X=function(e,t){return e===t&&(V=!0),0},K={}.hasOwnProperty,G=[],Y=G.pop,J=G.push,Q=G.push,Z=G.slice,ee=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\x00-\\xa0])+",re="\\["+ne+"*("+ie+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ie+"))|)"+ne+"*\\]",oe=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",se=new RegExp(ne+"+","g"),ae=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),le=new RegExp("^"+ne+"*,"+ne+"*"),ue=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ce=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),he=new RegExp(oe),de=new RegExp("^"+ie+"$"),fe={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie+"|[*])"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},pe=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,be=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),we=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},xe=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,_e=function(e,t){return t?"\x00"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Ce=function(){P()},ke=p(function(e){return e.disabled===!0&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{Q.apply(G=Z.call($.childNodes),$.childNodes),G[$.childNodes.length].nodeType}catch(Ee){Q={apply:G.length?function(e,t){J.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}_=t.support={},E=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},P=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:$;return i!==D&&9===i.nodeType&&i.documentElement?(D=i,N=D.documentElement,j=!E(D),$!==D&&(n=D.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Ce,!1):n.attachEvent&&n.attachEvent("onunload",Ce)),_.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=r(function(e){return e.appendChild(D.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=ge.test(D.getElementsByClassName),_.getById=r(function(e){return N.appendChild(e).id=q,!D.getElementsByName||!D.getElementsByName(q).length}),_.getById?(C.filter.ID=function(e){var t=e.replace(be,we);return function(e){return e.getAttribute("id")===t}},C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&j){var n=t.getElementById(e);return n?[n]:[]}}):(C.filter.ID=function(e){var t=e.replace(be,we);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&j){var n,i,r,o=t.getElementById(e);if(o){if(n=o.getAttributeNode("id"),n&&n.value===e)return[o];for(r=t.getElementsByName(e),i=0;o=r[i++];)if(n=o.getAttributeNode("id"),n&&n.value===e)return[o]}return[]}}),C.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},C.find.CLASS=_.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&j?t.getElementsByClassName(e):void 0},I=[],O=[],(_.qsa=ge.test(D.querySelectorAll))&&(r(function(e){N.appendChild(e).innerHTML="<a id='"+q+"'></a><select id='"+q+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+q+"-]").length||O.push("~="),e.querySelectorAll(":checked").length||O.push(":checked"),e.querySelectorAll("a#"+q+"+*").length||O.push(".#.+[+~]")}),r(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=D.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+ne+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&O.push(":enabled",":disabled"),N.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(_.matchesSelector=ge.test(F=N.matches||N.webkitMatchesSelector||N.mozMatchesSelector||N.oMatchesSelector||N.msMatchesSelector))&&r(function(e){_.disconnectedMatch=F.call(e,"*"),F.call(e,"[s!='']:x"),I.push("!=",oe)}),O=O.length&&new RegExp(O.join("|")),I=I.length&&new RegExp(I.join("|")),t=ge.test(N.compareDocumentPosition),B=t||ge.test(N.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},X=t?function(e,t){if(e===t)return V=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!_.sortDetached&&t.compareDocumentPosition(e)===n?e===D||e.ownerDocument===$&&B($,e)?-1:t===D||t.ownerDocument===$&&B($,t)?1:A?ee(A,e)-ee(A,t):0:4&n?-1:1)}:function(e,t){if(e===t)return V=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,a=[e],l=[t];if(!r||!o)return e===D?-1:t===D?1:r?-1:o?1:A?ee(A,e)-ee(A,t):0;if(r===o)return s(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;a[i]===l[i];)i++;return i?s(a[i],l[i]):a[i]===$?-1:l[i]===$?1:0},D):D},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==D&&P(e),n=n.replace(ce,"='$1']"),!(!_.matchesSelector||!j||U[n+" "]||I&&I.test(n)||O&&O.test(n)))try{var i=F.call(e,n);if(i||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(r){}return t(n,D,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==D&&P(e),B(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==D&&P(e);var n=C.attrHandle[t.toLowerCase()],i=n&&K.call(C.attrHandle,t.toLowerCase())?n(e,t,!j):void 0;return void 0!==i?i:_.attributes||!j?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.escape=function(e){return(e+"").replace(xe,_e)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,r=0;if(V=!_.detectDuplicates,A=!_.sortStable&&e.slice(0),e.sort(X),V){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return A=null,e},k=t.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=k(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=k(t);return n},C=t.selectors={cacheLength:50,createPseudo:i,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,we),e[3]=(e[3]||e[4]||e[5]||"").replace(be,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&he.test(n)&&(t=T(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(be,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&H(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(r){var o=t.attr(r,e);return null==o?"!="===n:n?(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(se," ")+" ").indexOf(i)>-1:"|="===n?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var u,c,h,d,f,p,m=o!==s?"nextSibling":"previousSibling",g=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(g){if(o){for(;m;){for(d=t;d=d[m];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=m="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?g.firstChild:g.lastChild],s&&y){for(d=g,h=d[q]||(d[q]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),u=c[e]||[],f=u[0]===L&&u[1],b=f&&u[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===t){c[e]=[L,f,b];break}}else if(y&&(d=t,h=d[q]||(d[q]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),u=c[e]||[],f=u[0]===L&&u[1],b=f),b===!1)for(;(d=++f&&d&&d[m]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&(h=d[q]||(d[q]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),c[e]=[L,b]),d!==t)););return b-=r,b===i||b%i===0&&b/i>=0}}},PSEUDO:function(e,n){var r,o=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[q]?o(n):o.length>1?(r=[e,e,"",n],C.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,r=o(e,n),s=r.length;s--;)i=ee(e,r[s]),e[i]=!(t[i]=r[s])}):function(e){return o(e,0,r)}):o}},pseudos:{not:i(function(e){var t=[],n=[],r=S(e.replace(ae,"$1"));return r[q]?i(function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(be,we),function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:i(function(e){return de.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(be,we).toLowerCase(),function(t){var n;do if(n=j?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===N},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:u(!1),disabled:u(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return pe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[0>n?n+t:n]}),even:c(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},C.pseudos.nth=C.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[x]=a(x);for(x in{submit:!0,reset:!0})C.pseudos[x]=l(x);return d.prototype=C.filters=C.pseudos,C.setFilters=new d,T=t.tokenize=function(e,n){var i,r,o,s,a,l,u,c=W[e+" "];if(c)return n?0:c.slice(0);for(a=e,l=[],u=C.preFilter;a;){(!i||(r=le.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=ue.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(ae," ")}),a=a.slice(i.length));for(s in C.filter)!(r=fe[s].exec(a))||u[s]&&!(r=u[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return n?a.length:a?t.error(e):W(e,l).slice(0)},S=t.compile=function(e,t){var n,i=[],r=[],o=U[e+" "];if(!o){for(t||(t=T(e)),n=t.length;n--;)o=b(t[n]),o[q]?i.push(o):r.push(o);o=U(e,w(r,i)),o.selector=e}return o},M=t.select=function(e,t,n,i){var r,o,s,a,l,u="function"==typeof e&&e,c=!i&&T(e=u.selector||e);if(n=n||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&j&&C.relative[o[1].type]){if(t=(C.find.ID(s.matches[0].replace(be,we),t)||[])[0],!t)return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=fe.needsContext.test(e)?0:o.length;r--&&(s=o[r],!C.relative[a=s.type]);)if((l=C.find[a])&&(i=l(s.matches[0].replace(be,we),ye.test(o[0].type)&&h(t.parentNode)||t))){if(o.splice(r,1),e=i.length&&f(o),!e)return Q.apply(n,i),n;break}}return(u||S(e,c))(i,t,!j,n,!t||ye.test(e)&&h(t.parentNode)||t),n},_.sortStable=q.split("").sort(X).join("")===q,_.detectDuplicates=!!V,P(),_.sortDetached=r(function(e){return 1&e.compareDocumentPosition(D.createElement("fieldset"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);_e.find=ke,_e.expr=ke.selectors,_e.expr[":"]=_e.expr.pseudos,_e.uniqueSort=_e.unique=ke.uniqueSort,_e.text=ke.getText,_e.isXMLDoc=ke.isXML,_e.contains=ke.contains,_e.escapeSelector=ke.escape;var Ee=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&_e(e).is(n))break;i.push(e)}return i},Te=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},Se=_e.expr.match.needsContext,Me=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;_e.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?_e.find.matchesSelector(i,e)?[i]:[]:_e.find.matches(e,_e.grep(t,function(e){return 1===e.nodeType}))},_e.fn.extend({find:function(e){var t,n,i=this.length,r=this;if("string"!=typeof e)return this.pushStack(_e(e).filter(function(){for(t=0;i>t;t++)if(_e.contains(r[t],this))return!0}));for(n=this.pushStack([]),t=0;i>t;t++)_e.find(e,r[t],n);return i>1?_e.uniqueSort(n):n},filter:function(e){return this.pushStack(s(this,e||[],!1))},not:function(e){return this.pushStack(s(this,e||[],!0))},is:function(e){return!!s(this,"string"==typeof e&&Se.test(e)?_e(e):e||[],!1).length}});var Re,Ae=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Ve=_e.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||Re,"string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:Ae.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof _e?t[0]:t,_e.merge(this,_e.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:se,!0)),Me.test(i[1])&&_e.isPlainObject(t))for(i in t)ye(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return r=se.getElementById(i[2]),r&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):ye(e)?void 0!==n.ready?n.ready(e):e(_e):_e.makeArray(e,this)};Ve.prototype=_e.fn,Re=_e(se);var Pe=/^(?:parents|prev(?:Until|All))/,De={children:!0,contents:!0,next:!0,prev:!0};_e.fn.extend({has:function(e){var t=_e(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(_e.contains(this,t[e]))return!0})},closest:function(e,t){var n,i=0,r=this.length,o=[],s="string"!=typeof e&&_e(e);if(!Se.test(e))for(;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&_e.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?_e.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?he.call(_e(e),this[0]):he.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(_e.uniqueSort(_e.merge(this.get(),_e(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),_e.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Ee(e,"parentNode")},parentsUntil:function(e,t,n){return Ee(e,"parentNode",n)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Ee(e,"nextSibling")},prevAll:function(e){return Ee(e,"previousSibling")},nextUntil:function(e,t,n){return Ee(e,"nextSibling",n)},prevUntil:function(e,t,n){return Ee(e,"previousSibling",n)},siblings:function(e){return Te((e.parentNode||{}).firstChild,e)},children:function(e){return Te(e.firstChild)},contents:function(e){return o(e,"iframe")?e.contentDocument:(o(e,"template")&&(e=e.content||e),_e.merge([],e.childNodes))}},function(e,t){_e.fn[e]=function(n,i){var r=_e.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=_e.filter(i,r)),this.length>1&&(De[e]||_e.uniqueSort(r),Pe.test(e)&&r.reverse()),this.pushStack(r)}});var Ne=/[^\x20\t\r\n\f]+/g;_e.Callbacks=function(e){e="string"==typeof e?l(e):_e.extend({},e);var t,n,r,o,s=[],a=[],u=-1,c=function(){for(o=o||e.once,r=t=!0;a.length;u=-1)for(n=a.shift();++u<s.length;)s[u].apply(n[0],n[1])===!1&&e.stopOnFalse&&(u=s.length,n=!1);e.memory||(n=!1),t=!1,o&&(s=n?[]:"")},h={add:function(){return s&&(n&&!t&&(u=s.length-1,a.push(n)),function r(t){_e.each(t,function(t,n){ye(n)?e.unique&&h.has(n)||s.push(n):n&&n.length&&"string"!==i(n)&&r(n)})}(arguments),n&&!t&&c()),this},remove:function(){return _e.each(arguments,function(e,t){for(var n;(n=_e.inArray(t,s,n))>-1;)s.splice(n,1),u>=n&&u--}),this},has:function(e){return e?_e.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=a=[],s=n="",this},disabled:function(){return!s},lock:function(){return o=a=[],n||t||(s=n=""),this},locked:function(){return!!o},fireWith:function(e,n){return o||(n=n||[],n=[e,n.slice?n.slice():n],a.push(n),t||c()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!r}};return h},_e.extend({Deferred:function(t){var n=[["notify","progress",_e.Callbacks("memory"),_e.Callbacks("memory"),2],["resolve","done",_e.Callbacks("once memory"),_e.Callbacks("once memory"),0,"resolved"],["reject","fail",_e.Callbacks("once memory"),_e.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},"catch":function(e){return r.then(null,e)},pipe:function(){var e=arguments;return _e.Deferred(function(t){_e.each(n,function(n,i){var r=ye(e[i[4]])&&e[i[4]];o[i[1]](function(){var e=r&&r.apply(this,arguments);e&&ye(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[i[0]+"With"](this,r?[e]:arguments)})}),e=null}).promise()},then:function(t,i,r){function o(t,n,i,r){return function(){var a=this,l=arguments,h=function(){var e,h;if(!(s>t)){if(e=i.apply(a,l),e===n.promise())throw new TypeError("Thenable self-resolution");h=e&&("object"==typeof e||"function"==typeof e)&&e.then,ye(h)?r?h.call(e,o(s,n,u,r),o(s,n,c,r)):(s++,h.call(e,o(s,n,u,r),o(s,n,c,r),o(s,n,u,n.notifyWith))):(i!==u&&(a=void 0,l=[e]),(r||n.resolveWith)(a,l))}},d=r?h:function(){try{h()}catch(e){_e.Deferred.exceptionHook&&_e.Deferred.exceptionHook(e,d.stackTrace),t+1>=s&&(i!==c&&(a=void 0,l=[e]),n.rejectWith(a,l))}};t?d():(_e.Deferred.getStackHook&&(d.stackTrace=_e.Deferred.getStackHook()),e.setTimeout(d))}}var s=0;return _e.Deferred(function(e){n[0][3].add(o(0,e,ye(r)?r:u,e.notifyWith)),n[1][3].add(o(0,e,ye(t)?t:u)),n[2][3].add(o(0,e,ye(i)?i:c))}).promise()},promise:function(e){return null!=e?_e.extend(e,r):r}},o={};return _e.each(n,function(e,t){var s=t[2],a=t[5];r[t[1]]=s.add,a&&s.add(function(){i=a},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),s.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=s.fireWith}),r.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,i=Array(n),r=le.call(arguments),o=_e.Deferred(),s=function(e){return function(n){i[e]=this,r[e]=arguments.length>1?le.call(arguments):n,--t||o.resolveWith(i,r)}};if(1>=t&&(h(e,o.done(s(n)).resolve,o.reject,!t),"pending"===o.state()||ye(r[n]&&r[n].then)))return o.then();for(;n--;)h(r[n],s(n),o.reject);return o.promise()}});var je=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;_e.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&je.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},_e.readyException=function(t){e.setTimeout(function(){throw t})};var Oe=_e.Deferred();_e.fn.ready=function(e){return Oe.then(e)["catch"](function(e){_e.readyException(e)}),this},_e.extend({isReady:!1,readyWait:1,ready:function(e){(e===!0?--_e.readyWait:_e.isReady)||(_e.isReady=!0,e!==!0&&--_e.readyWait>0||Oe.resolveWith(se,[_e]))}}),_e.ready.then=Oe.then,"complete"===se.readyState||"loading"!==se.readyState&&!se.documentElement.doScroll?e.setTimeout(_e.ready):(se.addEventListener("DOMContentLoaded",d),e.addEventListener("load",d));var Ie=function(e,t,n,r,o,s,a){var l=0,u=e.length,c=null==n;if("object"===i(n)){o=!0;for(l in n)Ie(e,t,l,n[l],!0,s,a)}else if(void 0!==r&&(o=!0,ye(r)||(a=!0),c&&(a?(t.call(e,r),t=null):(c=t,t=function(e,t,n){return c.call(_e(e),n)})),t))for(;u>l;l++)t(e[l],n,a?r:r.call(e[l],l,t(e[l],n)));return o?e:c?t.call(e):u?t(e[0],n):s},Fe=/^-ms-/,Be=/-([a-z])/g,qe=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};m.uid=1,m.prototype={cache:function(e){var t=e[this.expando];return t||(t={},qe(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[p(t)]=n;else for(i in t)r[p(i)]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][p(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){Array.isArray(t)?t=t.map(p):(t=p(t),t=t in i?[t]:t.match(Ne)||[]),n=t.length;for(;n--;)delete i[t[n]]}(void 0===t||_e.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!_e.isEmptyObject(t)}};var $e=new m,Le=new m,ze=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,He=/[A-Z]/g;_e.extend({hasData:function(e){return Le.hasData(e)||$e.hasData(e)},data:function(e,t,n){return Le.access(e,t,n)},removeData:function(e,t){Le.remove(e,t)},_data:function(e,t,n){return $e.access(e,t,n)},_removeData:function(e,t){$e.remove(e,t)}}),_e.fn.extend({data:function(e,t){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=Le.get(o),1===o.nodeType&&!$e.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(i=s[n].name,0===i.indexOf("data-")&&(i=p(i.slice(5)),v(o,i,r[i])));$e.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){Le.set(this,e)}):Ie(this,function(t){var n;if(o&&void 0===t){if(n=Le.get(o,e),void 0!==n)return n;if(n=v(o,e),void 0!==n)return n}else this.each(function(){Le.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Le.remove(this,e)})}}),_e.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=$e.get(e,t),n&&(!i||Array.isArray(n)?i=$e.access(e,t,_e.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=_e.queue(e,t),i=n.length,r=n.shift(),o=_e._queueHooks(e,t),s=function(){_e.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return $e.get(e,n)||$e.access(e,n,{empty:_e.Callbacks("once memory").add(function(){$e.remove(e,[t+"queue",n])})})}}),_e.fn.extend({queue:function(e,t){
var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?_e.queue(this[0],e):void 0===t?this:this.each(function(){var n=_e.queue(this,e,t);_e._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&_e.dequeue(this,e)})},dequeue:function(e){return this.each(function(){_e.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=_e.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)n=$e.get(o[s],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(t)}});var We=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ue=new RegExp("^(?:([+-])=|)("+We+")([a-z%]*)$","i"),Xe=["Top","Right","Bottom","Left"],Ke=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&_e.contains(e.ownerDocument,e)&&"none"===_e.css(e,"display")},Ge=function(e,t,n,i){var r,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=s[o];return r},Ye={};_e.fn.extend({show:function(){return w(this,!0)},hide:function(){return w(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ke(this)?_e(this).show():_e(this).hide()})}});var Je=/^(?:checkbox|radio)$/i,Qe=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ze=/^$|^module$|\/(?:java|ecma)script/i,et={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};et.optgroup=et.option,et.tbody=et.tfoot=et.colgroup=et.caption=et.thead,et.th=et.td;var tt=/<|&#?\w+;/;!function(){var e=se.createDocumentFragment(),t=e.appendChild(se.createElement("div")),n=se.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),ve.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",ve.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var nt=se.documentElement,it=/^key/,rt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ot=/^([^.]*)(?:\.(.+)|)/;_e.event={global:{},add:function(e,t,n,i,r){var o,s,a,l,u,c,h,d,f,p,m,g=$e.get(e);if(g)for(n.handler&&(o=n,n=o.handler,r=o.selector),r&&_e.find.matchesSelector(nt,r),n.guid||(n.guid=_e.guid++),(l=g.events)||(l=g.events={}),(s=g.handle)||(s=g.handle=function(t){return"undefined"!=typeof _e&&_e.event.triggered!==t.type?_e.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Ne)||[""],u=t.length;u--;)a=ot.exec(t[u])||[],f=m=a[1],p=(a[2]||"").split(".").sort(),f&&(h=_e.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=_e.event.special[f]||{},c=_e.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&_e.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||(d=l[f]=[],d.delegateCount=0,h.setup&&h.setup.call(e,i,p,s)!==!1||e.addEventListener&&e.addEventListener(f,s)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),_e.event.global[f]=!0)},remove:function(e,t,n,i,r){var o,s,a,l,u,c,h,d,f,p,m,g=$e.hasData(e)&&$e.get(e);if(g&&(l=g.events)){for(t=(t||"").match(Ne)||[""],u=t.length;u--;)if(a=ot.exec(t[u])||[],f=m=a[1],p=(a[2]||"").split(".").sort(),f){for(h=_e.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,d=l[f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)c=d[o],!r&&m!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(e,c));s&&!d.length&&(h.teardown&&h.teardown.call(e,p,g.handle)!==!1||_e.removeEvent(e,f,g.handle),delete l[f])}else for(f in l)_e.event.remove(e,f+t[u],n,i,!0);_e.isEmptyObject(l)&&$e.remove(e,"handle events")}},dispatch:function(e){var t,n,i,r,o,s,a=_e.event.fix(e),l=new Array(arguments.length),u=($e.get(this,"events")||{})[a.type]||[],c=_e.event.special[a.type]||{};for(l[0]=a,t=1;t<arguments.length;t++)l[t]=arguments[t];if(a.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,a)!==!1){for(s=_e.event.handlers.call(this,a,u),t=0;(r=s[t++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!a.isImmediatePropagationStopped();)(!a.rnamespace||a.rnamespace.test(o.namespace))&&(a.handleObj=o,a.data=o.data,i=((_e.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l),void 0!==i&&(a.result=i)===!1&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(e,t){var n,i,r,o,s,a=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||u.disabled!==!0)){for(o=[],s={},n=0;l>n;n++)i=t[n],r=i.selector+" ",void 0===s[r]&&(s[r]=i.needsContext?_e(r,this).index(u)>-1:_e.find(r,this,null,[u]).length),s[r]&&o.push(i);o.length&&a.push({elem:u,handlers:o})}return u=this,l<t.length&&a.push({elem:u,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(_e.Event.prototype,e,{enumerable:!0,configurable:!0,get:ye(t)?function(){return this.originalEvent?t(this.originalEvent):void 0}:function(){return this.originalEvent?this.originalEvent[e]:void 0},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[_e.expando]?e:new _e.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==T()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===T()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&o(this,"input")?(this.click(),!1):void 0},_default:function(e){return o(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},_e.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},_e.Event=function(e,t){return this instanceof _e.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?k:E,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&_e.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),void(this[_e.expando]=!0)):new _e.Event(e,t)},_e.Event.prototype={constructor:_e.Event,isDefaultPrevented:E,isPropagationStopped:E,isImmediatePropagationStopped:E,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=k,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=k,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=k,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},_e.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&it.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&rt.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},_e.event.addProp),_e.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){_e.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!_e.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),_e.fn.extend({on:function(e,t,n,i){return S(this,e,t,n,i)},one:function(e,t,n,i){return S(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,_e(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=E),this.each(function(){_e.event.remove(this,e,n,t)})}});var st=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,at=/<script|<style|<link/i,lt=/checked\s*(?:[^=]|=\s*.checked.)/i,ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;_e.extend({htmlPrefilter:function(e){return e.replace(st,"<$1></$2>")},clone:function(e,t,n){var i,r,o,s,a=e.cloneNode(!0),l=_e.contains(e.ownerDocument,e);if(!(ve.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||_e.isXMLDoc(e)))for(s=x(a),o=x(e),i=0,r=o.length;r>i;i++)P(o[i],s[i]);if(t)if(n)for(o=o||x(e),s=s||x(a),i=0,r=o.length;r>i;i++)V(o[i],s[i]);else V(e,a);return s=x(a,"script"),s.length>0&&_(s,!l&&x(e,"script")),a},cleanData:function(e){for(var t,n,i,r=_e.event.special,o=0;void 0!==(n=e[o]);o++)if(qe(n)){if(t=n[$e.expando]){if(t.events)for(i in t.events)r[i]?_e.event.remove(n,i):_e.removeEvent(n,i,t.handle);n[$e.expando]=void 0}n[Le.expando]&&(n[Le.expando]=void 0)}}}),_e.fn.extend({detach:function(e){return N(this,e,!0)},remove:function(e){return N(this,e)},text:function(e){return Ie(this,function(e){return void 0===e?_e.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return D(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=M(this,e);t.appendChild(e)}})},prepend:function(){return D(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=M(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return D(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return D(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(_e.cleanData(x(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return _e.clone(this,e,t)})},html:function(e){return Ie(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!at.test(e)&&!et[(Qe.exec(e)||["",""])[1].toLowerCase()]){e=_e.htmlPrefilter(e);try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(_e.cleanData(x(t,!1)),t.innerHTML=e);t=0}catch(r){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return D(this,arguments,function(t){var n=this.parentNode;_e.inArray(this,e)<0&&(_e.cleanData(x(this)),n&&n.replaceChild(t,this))},e)}}),_e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){_e.fn[e]=function(e){for(var n,i=[],r=_e(e),o=r.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),_e(r[s])[t](n),ce.apply(i,n.get());return this.pushStack(i)}});var ct=new RegExp("^("+We+")(?!px)[a-z%]+$","i"),ht=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},dt=new RegExp(Xe.join("|"),"i");!function(){function t(){if(u){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",nt.appendChild(l).appendChild(u);var t=e.getComputedStyle(u);i="1%"!==t.top,a=12===n(t.marginLeft),u.style.right="60%",s=36===n(t.right),r=36===n(t.width),u.style.position="absolute",o=36===u.offsetWidth||"absolute",nt.removeChild(l),u=null}}function n(e){return Math.round(parseFloat(e))}var i,r,o,s,a,l=se.createElement("div"),u=se.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",ve.clearCloneStyle="content-box"===u.style.backgroundClip,_e.extend(ve,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),a},scrollboxSize:function(){return t(),o}}))}();var ft=/^(none|table(?!-c[ea]).+)/,pt=/^--/,mt={position:"absolute",visibility:"hidden",display:"block"},gt={letterSpacing:"0",fontWeight:"400"},vt=["Webkit","Moz","ms"],yt=se.createElement("div").style;_e.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=j(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=p(t),l=pt.test(t),u=e.style;return l||(t=F(a)),s=_e.cssHooks[t]||_e.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(r=s.get(e,!1,i))?r:u[t]:(o=typeof n,"string"===o&&(r=Ue.exec(n))&&r[1]&&(n=y(e,t,r),o="number"),null!=n&&n===n&&("number"===o&&(n+=r&&r[3]||(_e.cssNumber[a]?"":"px")),ve.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(l?u.setProperty(t,n):u[t]=n)),void 0)}},css:function(e,t,n,i){var r,o,s,a=p(t),l=pt.test(t);return l||(t=F(a)),s=_e.cssHooks[t]||_e.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,n)),void 0===r&&(r=j(e,t,i)),"normal"===r&&t in gt&&(r=gt[t]),""===n||n?(o=parseFloat(r),n===!0||isFinite(o)?o||0:r):r}}),_e.each(["height","width"],function(e,t){_e.cssHooks[t]={get:function(e,n,i){return n?!ft.test(_e.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?$(e,t,i):Ge(e,mt,function(){return $(e,t,i)}):void 0},set:function(e,n,i){var r,o=ht(e),s="border-box"===_e.css(e,"boxSizing",!1,o),a=i&&q(e,t,i,s,o);return s&&ve.scrollboxSize()===o.position&&(a-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-q(e,t,"border",!1,o)-.5)),a&&(r=Ue.exec(n))&&"px"!==(r[3]||"px")&&(e.style[t]=n,n=_e.css(e,t)),B(e,n,a)}}}),_e.cssHooks.marginLeft=O(ve.reliableMarginLeft,function(e,t){return t?(parseFloat(j(e,"marginLeft"))||e.getBoundingClientRect().left-Ge(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px":void 0}),_e.each({margin:"",padding:"",border:"Width"},function(e,t){_e.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+Xe[i]+t]=o[i]||o[i-2]||o[0];return r}},"margin"!==e&&(_e.cssHooks[e+t].set=B)}),_e.fn.extend({css:function(e,t){return Ie(this,function(e,t,n){var i,r,o={},s=0;if(Array.isArray(t)){for(i=ht(e),r=t.length;r>s;s++)o[t[s]]=_e.css(e,t[s],!1,i);return o}return void 0!==n?_e.style(e,t,n):_e.css(e,t)},e,t,arguments.length>1)}}),_e.Tween=L,L.prototype={constructor:L,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||_e.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(_e.cssNumber[n]?"":"px")},cur:function(){var e=L.propHooks[this.prop];return e&&e.get?e.get(this):L.propHooks._default.get(this)},run:function(e){var t,n=L.propHooks[this.prop];return this.options.duration?this.pos=t=_e.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=_e.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){_e.fx.step[e.prop]?_e.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[_e.cssProps[e.prop]]&&!_e.cssHooks[e.prop]?e.elem[e.prop]=e.now:_e.style(e.elem,e.prop,e.now+e.unit)}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},_e.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},_e.fx=L.prototype.init,_e.fx.step={};var bt,wt,xt=/^(?:toggle|show|hide)$/,_t=/queueHooks$/;_e.Animation=_e.extend(G,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return y(n.elem,e,Ue.exec(t),n),n}]},tweener:function(e,t){ye(e)?(t=e,e=["*"]):e=e.match(Ne);for(var n,i=0,r=e.length;r>i;i++)n=e[i],G.tweeners[n]=G.tweeners[n]||[],G.tweeners[n].unshift(t)},prefilters:[X],prefilter:function(e,t){t?G.prefilters.unshift(e):G.prefilters.push(e)}}),_e.speed=function(e,t,n){var i=e&&"object"==typeof e?_e.extend({},e):{complete:n||!n&&t||ye(e)&&e,duration:e,easing:n&&t||t&&!ye(t)&&t};return _e.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in _e.fx.speeds?i.duration=_e.fx.speeds[i.duration]:i.duration=_e.fx.speeds._default),(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){ye(i.old)&&i.old.call(this),i.queue&&_e.dequeue(this,i.queue)},i},_e.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ke).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=_e.isEmptyObject(e),o=_e.speed(t,n,i),s=function(){var t=G(this,_e.extend({},e),o);(r||$e.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=_e.timers,s=$e.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&_t.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));(t||!n)&&_e.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=$e.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=_e.timers,s=i?i.length:0;for(n.finish=!0,_e.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),_e.each(["toggle","show","hide"],function(e,t){var n=_e.fn[t];_e.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(W(t,!0),e,i,r)}}),_e.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){_e.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),_e.timers=[],_e.fx.tick=function(){var e,t=0,n=_e.timers;for(bt=Date.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||_e.fx.stop(),bt=void 0},_e.fx.timer=function(e){_e.timers.push(e),_e.fx.start()},_e.fx.interval=13,_e.fx.start=function(){wt||(wt=!0,z())},_e.fx.stop=function(){wt=null},_e.fx.speeds={slow:600,fast:200,_default:400},_e.fn.delay=function(t,n){return t=_e.fx?_e.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,i){var r=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(r)}})},function(){var e=se.createElement("input"),t=se.createElement("select"),n=t.appendChild(se.createElement("option"));e.type="checkbox",ve.checkOn=""!==e.value,ve.optSelected=n.selected,e=se.createElement("input"),e.value="t",e.type="radio",ve.radioValue="t"===e.value}();var Ct,kt=_e.expr.attrHandle;_e.fn.extend({attr:function(e,t){return Ie(this,_e.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){_e.removeAttr(this,e)})}}),_e.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?_e.prop(e,t,n):(1===o&&_e.isXMLDoc(e)||(r=_e.attrHooks[t.toLowerCase()]||(_e.expr.match.bool.test(t)?Ct:void 0)),void 0!==n?null===n?void _e.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:(i=_e.find.attr(e,t),null==i?void 0:i))},attrHooks:{type:{set:function(e,t){if(!ve.radioValue&&"radio"===t&&o(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,r=t&&t.match(Ne);if(r&&1===e.nodeType)for(;n=r[i++];)e.removeAttribute(n)}}),Ct={set:function(e,t,n){return t===!1?_e.removeAttr(e,n):e.setAttribute(n,n),n}},_e.each(_e.expr.match.bool.source.match(/\w+/g),function(e,t){var n=kt[t]||_e.find.attr;kt[t]=function(e,t,i){var r,o,s=t.toLowerCase();return i||(o=kt[s],kt[s]=r,r=null!=n(e,t,i)?s:null,kt[s]=o),r}});var Et=/^(?:input|select|textarea|button)$/i,Tt=/^(?:a|area)$/i;_e.fn.extend({prop:function(e,t){return Ie(this,_e.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[_e.propFix[e]||e]})}}),_e.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&_e.isXMLDoc(e)||(t=_e.propFix[t]||t,r=_e.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=_e.find.attr(e,"tabindex");return t?parseInt(t,10):Et.test(e.nodeName)||Tt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),ve.optSelected||(_e.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),_e.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_e.propFix[this.toLowerCase()]=this}),_e.fn.extend({addClass:function(e){var t,n,i,r,o,s,a,l=0;if(ye(e))return this.each(function(t){_e(this).addClass(e.call(this,t,J(this)))});if(t=Q(e),t.length)for(;n=this[l++];)if(r=J(n),i=1===n.nodeType&&" "+Y(r)+" "){for(s=0;o=t[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=Y(i),r!==a&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,i,r,o,s,a,l=0;if(ye(e))return this.each(function(t){_e(this).removeClass(e.call(this,t,J(this)))});if(!arguments.length)return this.attr("class","");if(t=Q(e),t.length)for(;n=this[l++];)if(r=J(n),i=1===n.nodeType&&" "+Y(r)+" "){for(s=0;o=t[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");a=Y(i),r!==a&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e,i="string"===n||Array.isArray(e);return"boolean"==typeof t&&i?t?this.addClass(e):this.removeClass(e):ye(e)?this.each(function(n){_e(this).toggleClass(e.call(this,n,J(this),t),t)}):this.each(function(){var t,r,o,s;if(i)for(r=0,o=_e(this),s=Q(e);t=s[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(void 0===e||"boolean"===n)&&(t=J(this),t&&$e.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":$e.get(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+Y(J(n))+" ").indexOf(t)>-1)return!0;return!1}});var St=/\r/g;_e.fn.extend({val:function(e){var t,n,i,r=this[0];{if(arguments.length)return i=ye(e),this.each(function(n){var r;1===this.nodeType&&(r=i?e.call(this,n,_e(this).val()):e,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=_e.map(r,function(e){return null==e?"":e+""})),t=_e.valHooks[this.type]||_e.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return t=_e.valHooks[r.type]||_e.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(St,""):null==n?"":n)}}}),_e.extend({valHooks:{option:{get:function(e){var t=_e.find.attr(e,"value");return null!=t?t:Y(_e.text(e))}},select:{get:function(e){var t,n,i,r=e.options,s=e.selectedIndex,a="select-one"===e.type,l=a?null:[],u=a?s+1:r.length;for(i=0>s?u:a?s:0;u>i;i++)if(n=r[i],!(!n.selected&&i!==s||n.disabled||n.parentNode.disabled&&o(n.parentNode,"optgroup"))){if(t=_e(n).val(),a)return t;l.push(t)}return l},set:function(e,t){for(var n,i,r=e.options,o=_e.makeArray(t),s=r.length;s--;)i=r[s],(i.selected=_e.inArray(_e.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),_e.each(["radio","checkbox"],function(){_e.valHooks[this]={set:function(e,t){return Array.isArray(t)?e.checked=_e.inArray(_e(e).val(),t)>-1:void 0}},ve.checkOn||(_e.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),ve.focusin="onfocusin"in e;var Mt=/^(?:focusinfocus|focusoutblur)$/,Rt=function(e){e.stopPropagation()};_e.extend(_e.event,{trigger:function(t,n,i,r){var o,s,a,l,u,c,h,d,f=[i||se],p=pe.call(t,"type")?t.type:t,m=pe.call(t,"namespace")?t.namespace.split("."):[];if(s=d=a=i=i||se,3!==i.nodeType&&8!==i.nodeType&&!Mt.test(p+_e.event.triggered)&&(p.indexOf(".")>-1&&(m=p.split("."),p=m.shift(),m.sort()),u=p.indexOf(":")<0&&"on"+p,t=t[_e.expando]?t:new _e.Event(p,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:_e.makeArray(n,[t]),h=_e.event.special[p]||{},r||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!r&&!h.noBubble&&!be(i)){for(l=h.delegateType||p,Mt.test(l+p)||(s=s.parentNode);s;s=s.parentNode)f.push(s),a=s;a===(i.ownerDocument||se)&&f.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=f[o++])&&!t.isPropagationStopped();)d=s,t.type=o>1?l:h.bindType||p,c=($e.get(s,"events")||{})[t.type]&&$e.get(s,"handle"),c&&c.apply(s,n),c=u&&s[u],c&&c.apply&&qe(s)&&(t.result=c.apply(s,n),t.result===!1&&t.preventDefault());return t.type=p,r||t.isDefaultPrevented()||h._default&&h._default.apply(f.pop(),n)!==!1||!qe(i)||u&&ye(i[p])&&!be(i)&&(a=i[u],a&&(i[u]=null),_e.event.triggered=p,t.isPropagationStopped()&&d.addEventListener(p,Rt),i[p](),t.isPropagationStopped()&&d.removeEventListener(p,Rt),_e.event.triggered=void 0,a&&(i[u]=a)),t.result}},simulate:function(e,t,n){var i=_e.extend(new _e.Event,n,{type:e,isSimulated:!0});_e.event.trigger(i,null,t)}}),_e.fn.extend({trigger:function(e,t){return this.each(function(){_e.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?_e.event.trigger(e,t,n,!0):void 0}}),ve.focusin||_e.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){_e.event.simulate(t,e.target,_e.event.fix(e))};_e.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=$e.access(i,t);r||i.addEventListener(e,n,!0),$e.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=$e.access(i,t)-1;r?$e.access(i,t,r):(i.removeEventListener(e,n,!0),$e.remove(i,t))}}});var At=e.location,Vt=Date.now(),Pt=/\?/;_e.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(i){n=void 0}return(!n||n.getElementsByTagName("parsererror").length)&&_e.error("Invalid XML: "+t),n};var Dt=/\[\]$/,Nt=/\r?\n/g,jt=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;_e.param=function(e,t){var n,i=[],r=function(e,t){var n=ye(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!_e.isPlainObject(e))_e.each(e,function(){r(this.name,this.value)});else for(n in e)Z(n,e[n],t,r);return i.join("&")},_e.fn.extend({serialize:function(){return _e.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=_e.prop(this,"elements");return e?_e.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!_e(this).is(":disabled")&&Ot.test(this.nodeName)&&!jt.test(e)&&(this.checked||!Je.test(e))}).map(function(e,t){var n=_e(this).val();return null==n?null:Array.isArray(n)?_e.map(n,function(e){return{name:t.name,value:e.replace(Nt,"\r\n")}}):{name:t.name,value:n.replace(Nt,"\r\n")}}).get()}});var It=/%20/g,Ft=/#.*$/,Bt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,$t=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Lt=/^(?:GET|HEAD)$/,zt=/^\/\//,Ht={},Wt={},Ut="*/".concat("*"),Xt=se.createElement("a");Xt.href=At.href,_e.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At.href,type:"GET",isLocal:$t.test(At.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":_e.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ne(ne(e,_e.ajaxSettings),t):ne(_e.ajaxSettings,e)},ajaxPrefilter:ee(Ht),ajaxTransport:ee(Wt),ajax:function(t,n){function i(t,n,i,a){var u,d,f,w,x,_=n;c||(c=!0,l&&e.clearTimeout(l),r=void 0,s=a||"",C.readyState=t>0?4:0,u=t>=200&&300>t||304===t,i&&(w=ie(p,C,i)),w=re(p,w,C,u),u?(p.ifModified&&(x=C.getResponseHeader("Last-Modified"),x&&(_e.lastModified[o]=x),x=C.getResponseHeader("etag"),x&&(_e.etag[o]=x)),204===t||"HEAD"===p.type?_="nocontent":304===t?_="notmodified":(_=w.state,d=w.data,f=w.error,u=!f)):(f=_,(t||!_)&&(_="error",0>t&&(t=0))),C.status=t,C.statusText=(n||_)+"",u?v.resolveWith(m,[d,_,C]):v.rejectWith(m,[C,_,f]),C.statusCode(b),b=void 0,h&&g.trigger(u?"ajaxSuccess":"ajaxError",[C,p,u?d:f]),y.fireWith(m,[C,_]),h&&(g.trigger("ajaxComplete",[C,p]),--_e.active||_e.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var r,o,s,a,l,u,c,h,d,f,p=_e.ajaxSetup({},n),m=p.context||p,g=p.context&&(m.nodeType||m.jquery)?_e(m):_e.event,v=_e.Deferred(),y=_e.Callbacks("once memory"),b=p.statusCode||{},w={},x={},_="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(c){if(!a)for(a={};t=qt.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(e,t){return null==c&&(e=x[e.toLowerCase()]=x[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==c&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)C.always(e[C.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||_;return r&&r.abort(t),i(0,t),this}};if(v.promise(C),p.url=((t||p.url||At.href)+"").replace(zt,At.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(Ne)||[""],null==p.crossDomain){u=se.createElement("a");try{u.href=p.url,u.href=u.href,p.crossDomain=Xt.protocol+"//"+Xt.host!=u.protocol+"//"+u.host}catch(k){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=_e.param(p.data,p.traditional)),te(Ht,p,n,C),c)return C;h=_e.event&&p.global,h&&0===_e.active++&&_e.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Lt.test(p.type),o=p.url.replace(Ft,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(It,"+")):(f=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(Pt.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(o=o.replace(Bt,"$1"),f=(Pt.test(o)?"&":"?")+"_="+Vt++ +f),p.url=o+f),p.ifModified&&(_e.lastModified[o]&&C.setRequestHeader("If-Modified-Since",_e.lastModified[o]),_e.etag[o]&&C.setRequestHeader("If-None-Match",_e.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ut+"; q=0.01":""):p.accepts["*"]);for(d in p.headers)C.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(p.beforeSend.call(m,C,p)===!1||c))return C.abort();
if(_="abort",y.add(p.complete),C.done(p.success),C.fail(p.error),r=te(Wt,p,n,C)){if(C.readyState=1,h&&g.trigger("ajaxSend",[C,p]),c)return C;p.async&&p.timeout>0&&(l=e.setTimeout(function(){C.abort("timeout")},p.timeout));try{c=!1,r.send(w,i)}catch(k){if(c)throw k;i(-1,k)}}else i(-1,"No Transport");return C},getJSON:function(e,t,n){return _e.get(e,t,n,"json")},getScript:function(e,t){return _e.get(e,void 0,t,"script")}}),_e.each(["get","post"],function(e,t){_e[t]=function(e,n,i,r){return ye(n)&&(r=r||i,i=n,n=void 0),_e.ajax(_e.extend({url:e,type:t,dataType:r,data:n,success:i},_e.isPlainObject(e)&&e))}}),_e._evalUrl=function(e){return _e.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},_e.fn.extend({wrapAll:function(e){var t;return this[0]&&(ye(e)&&(e=e.call(this[0])),t=_e(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return ye(e)?this.each(function(t){_e(this).wrapInner(e.call(this,t))}):this.each(function(){var t=_e(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ye(e);return this.each(function(n){_e(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){_e(this).replaceWith(this.childNodes)}),this}}),_e.expr.pseudos.hidden=function(e){return!_e.expr.pseudos.visible(e)},_e.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},_e.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(t){}};var Kt={0:200,1223:204},Gt=_e.ajaxSettings.xhr();ve.cors=!!Gt&&"withCredentials"in Gt,ve.ajax=Gt=!!Gt,_e.ajaxTransport(function(t){var n,i;return ve.cors||Gt&&!t.crossDomain?{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(s in r)a.setRequestHeader(s,r[s]);n=function(e){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Kt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){n&&i()})},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(l){if(n)throw l}},abort:function(){n&&n()}}:void 0}),_e.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),_e.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return _e.globalEval(e),e}}}),_e.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),_e.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,r){t=_e("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),se.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Yt=[],Jt=/(=)\?(?=&|$)|\?\?/;_e.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||_e.expando+"_"+Vt++;return this[e]=!0,e}}),_e.ajaxPrefilter("json jsonp",function(t,n,i){var r,o,s,a=t.jsonp!==!1&&(Jt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Jt.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=ye(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Jt,"$1"+r):t.jsonp!==!1&&(t.url+=(Pt.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||_e.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){s=arguments},i.always(function(){void 0===o?_e(e).removeProp(r):e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,Yt.push(r)),s&&ye(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),ve.createHTMLDocument=function(){var e=se.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),_e.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var i,r,o;return t||(ve.createHTMLDocument?(t=se.implementation.createHTMLDocument(""),i=t.createElement("base"),i.href=se.location.href,t.head.appendChild(i)):t=se),r=Me.exec(e),o=!n&&[],r?[t.createElement(r[1])]:(r=C([e],t,o),o&&o.length&&_e(o).remove(),_e.merge([],r.childNodes))},_e.fn.load=function(e,t,n){var i,r,o,s=this,a=e.indexOf(" ");return a>-1&&(i=Y(e.slice(a)),e=e.slice(0,a)),ye(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&_e.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(i?_e("<div>").append(_e.parseHTML(e)).find(i):e)}).always(n&&function(e,t){s.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},_e.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){_e.fn[t]=function(e){return this.on(t,e)}}),_e.expr.pseudos.animated=function(e){return _e.grep(_e.timers,function(t){return e===t.elem}).length},_e.offset={setOffset:function(e,t,n){var i,r,o,s,a,l,u,c=_e.css(e,"position"),h=_e(e),d={};"static"===c&&(e.style.position="relative"),a=h.offset(),o=_e.css(e,"top"),l=_e.css(e,"left"),u=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,u?(i=h.position(),s=i.top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),ye(t)&&(t=t.call(e,n,_e.extend({},a))),null!=t.top&&(d.top=t.top-a.top+s),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):h.css(d)}},_e.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){_e.offset.setOffset(this,e,t)});var t,n,i=this[0];if(i)return i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,n,i=this[0],r={top:0,left:0};if("fixed"===_e.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===_e.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&(r=_e(e).offset(),r.top+=_e.css(e,"borderTopWidth",!0),r.left+=_e.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-_e.css(i,"marginTop",!0),left:t.left-r.left-_e.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===_e.css(e,"position");)e=e.offsetParent;return e||nt})}}),_e.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;_e.fn[e]=function(i){return Ie(this,function(e,i,r){var o;return be(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r?o?o[t]:e[i]:void(o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):e[i]=r)},e,i,arguments.length)}}),_e.each(["top","left"],function(e,t){_e.cssHooks[t]=O(ve.pixelPosition,function(e,n){return n?(n=j(e,t),ct.test(n)?_e(e).position()[t]+"px":n):void 0})}),_e.each({Height:"height",Width:"width"},function(e,t){_e.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){_e.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(r===!0||o===!0?"margin":"border");return Ie(this,function(t,n,r){var o;return be(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?_e.css(t,n,a):_e.style(t,n,r,a)},t,s?r:void 0,s)}})}),_e.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){_e.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),_e.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),_e.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),_e.proxy=function(e,t){var n,i,r;return"string"==typeof t&&(n=e[t],t=e,e=n),ye(e)?(i=le.call(arguments,2),r=function(){return e.apply(t||this,i.concat(le.call(arguments)))},r.guid=e.guid=e.guid||_e.guid++,r):void 0},_e.holdReady=function(e){e?_e.readyWait++:_e.ready(!0)},_e.isArray=Array.isArray,_e.parseJSON=JSON.parse,_e.nodeName=o,_e.isFunction=ye,_e.isWindow=be,_e.camelCase=p,_e.type=i,_e.now=Date.now,_e.isNumeric=function(e){var t=_e.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return _e});var Qt=e.jQuery,Zt=e.$;return _e.noConflict=function(t){return e.$===_e&&(e.$=Zt),t&&e.jQuery===_e&&(e.jQuery=Qt),_e},t||(e.jQuery=e.$=_e),_e}),function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n,i=require("underscore");try{n=require("jquery")}catch(r){}e(t,exports,i,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,i){var r=e.Backbone,o=Array.prototype.slice;t.VERSION="1.3.3",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,i){switch(e){case 1:return function(){return n[t](this[i])};case 2:return function(e){return n[t](this[i],e)};case 3:return function(e,r){return n[t](this[i],l(e,this),r)};case 4:return function(e,r,o){return n[t](this[i],l(e,this),r,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[i]),n[t].apply(n,e)}}},a=function(e,t,i){n.each(t,function(t,r){n[r]&&(e.prototype[r]=s(t,r,i))})},l=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?u(e):n.isString(e)?function(t){return t.get(e)}:e},u=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},c=t.Events={},h=/\s+/,d=function(e,t,i,r,o){var s,a=0;if(i&&"object"==typeof i){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(s=n.keys(i);a<s.length;a++)t=d(e,t,s[a],i[s[a]],o)}else if(i&&h.test(i))for(s=i.split(h);a<s.length;a++)t=e(t,s[a],r,o);else t=e(t,i,r,o);return t};c.on=function(e,t,n){return f(this,e,t,n)};var f=function(e,t,n,i,r){if(e._events=d(p,e._events||{},t,n,{context:i,ctx:e,listening:r}),r){var o=e._listeners||(e._listeners={});o[r.id]=r}return e};c.listenTo=function(e,t,i){if(!e)return this;var r=e._listenId||(e._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[r];if(!s){var a=this._listenId||(this._listenId=n.uniqueId("l"));s=o[r]={obj:e,objId:r,id:a,listeningTo:o,count:0}}return f(e,t,i,this,s),this};var p=function(e,t,n,i){if(n){var r=e[t]||(e[t]=[]),o=i.context,s=i.ctx,a=i.listening;a&&a.count++,r.push({callback:n,context:o,ctx:o||s,listening:a})}return e};c.off=function(e,t,n){return this._events?(this._events=d(m,this._events,e,t,{context:n,listeners:this._listeners}),this):this},c.stopListening=function(e,t,i){var r=this._listeningTo;if(!r)return this;for(var o=e?[e._listenId]:n.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(t,i,this)}return this};var m=function(e,t,i,r){if(e){var o,s=0,a=r.context,l=r.listeners;if(t||i||a){for(var u=t?[t]:n.keys(e);s<u.length;s++){t=u[s];var c=e[t];if(!c)break;for(var h=[],d=0;d<c.length;d++){var f=c[d];i&&i!==f.callback&&i!==f.callback._callback||a&&a!==f.context?h.push(f):(o=f.listening,o&&0===--o.count&&(delete l[o.id],delete o.listeningTo[o.objId]))}h.length?e[t]=h:delete e[t]}return e}for(var p=n.keys(l);s<p.length;s++)o=l[p[s]],delete l[o.id],delete o.listeningTo[o.objId]}};c.once=function(e,t,i){var r=d(g,{},e,t,n.bind(this.off,this));return"string"==typeof e&&null==i&&(t=void 0),this.on(r,t,i)},c.listenToOnce=function(e,t,i){var r=d(g,{},t,i,n.bind(this.stopListening,this,e));return this.listenTo(e,r)};var g=function(e,t,i,r){if(i){var o=e[t]=n.once(function(){r(t,o),i.apply(this,arguments)});o._callback=i}return e};c.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),i=0;t>i;i++)n[i]=arguments[i+1];return d(v,this._events,e,void 0,n),this};var v=function(e,t,n,i){if(e){var r=e[t],o=e.all;r&&o&&(o=o.slice()),r&&y(r,i),o&&y(o,[t].concat(i))}return e},y=function(e,t){var n,i=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t);return}};c.bind=c.on,c.unbind=c.off,n.extend(t,c);var b=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{});var r=n.result(this,"defaults");i=n.defaults(n.extend({},r,i),r),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,i){if(null==e)return this;var r;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;var o=i.unset,s=i.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,c=this.changed,h=this._previousAttributes;for(var d in r)t=r[d],n.isEqual(u[d],t)||a.push(d),n.isEqual(h[d],t)?delete c[d]:c[d]=t,o?delete u[d]:u[d]=t;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=i);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,u[a[f]],i)}if(l)return this;if(!s)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,i={};for(var r in e){var o=e[r];n.isEqual(t[r],o)||(i[r]=o)}return n.size(i)?i:!1},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,i=e.success;return e.success=function(n){var r=e.parse?t.parse(n,e):n;return t.set(r,e)?(i&&i.call(e.context,t,n,e),void t.trigger("sync",t,n,e)):!1},$(this,e),this.sync("read",this,e)},save:function(e,t,i){var r;null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0,parse:!0},i);var o=i.wait;if(r&&!o){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;var s=this,a=i.success,l=this.attributes;i.success=function(e){s.attributes=l;var t=i.parse?s.parse(e,i):e;return o&&(t=n.extend({},r,t)),t&&!s.set(t,i)?!1:(a&&a.call(i.context,s,e,i),void s.trigger("sync",s,e,i))},$(this,i),r&&o&&(this.attributes=n.extend({},l,r));var u=this.isNew()?"create":i.patch?"patch":"update";"patch"!==u||i.attrs||(i.attrs=r);var c=this.sync(u,this,i);return this.attributes=l,c},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=e.wait,o=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){r&&o(),i&&i.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var s=!1;return this.isNew()?n.defer(e.success):($(this,e),s=this.sync("delete",this,e)),r||o(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||q();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(b,w,"attributes");var x=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},_={add:!0,remove:!0,merge:!0},C={add:!0,remove:!1},k=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var i,r=Array(e.length-n),o=t.length;for(i=0;i<r.length;i++)r[i]=e[i+n];for(i=0;o>i;i++)e[i+n]=t[i];for(i=0;i<r.length;i++)e[i+o+n]=r[i]};n.extend(x.prototype,c,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,C))},remove:function(e,t){t=n.extend({},t);var i=!n.isArray(e);e=i?[e]:e.slice();var r=this._removeModels(e,t);return!t.silent&&r.length&&(t.changes={added:[],merged:[],removed:r},this.trigger("update",this,t)),i?r[0]:r},set:function(e,t){if(null!=e){t=n.extend({},_,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var i=!n.isArray(e);e=i?[e]:e.slice();var r=t.at;null!=r&&(r=+r),r>this.length&&(r=this.length),0>r&&(r+=this.length+1);var o,s,a=[],l=[],u=[],c=[],h={},d=t.add,f=t.merge,p=t.remove,m=!1,g=this.comparator&&null==r&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null;for(s=0;s<e.length;s++){o=e[s];var y=this.get(o);if(y){if(f&&o!==y){var b=this._isModel(o)?o.attributes:o;t.parse&&(b=y.parse(b,t)),y.set(b,t),u.push(y),g&&!m&&(m=y.hasChanged(v))}h[y.cid]||(h[y.cid]=!0,a.push(y)),e[s]=y}else d&&(o=e[s]=this._prepareModel(o,t),o&&(l.push(o),this._addReference(o,t),h[o.cid]=!0,a.push(o)))}if(p){for(s=0;s<this.length;s++)o=this.models[s],h[o.cid]||c.push(o);c.length&&this._removeModels(c,t)}var w=!1,x=!g&&d&&p;if(a.length&&x?(w=this.length!==a.length||n.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,k(this.models,a,0),this.length=this.models.length):l.length&&(g&&(m=!0),k(this.models,l,null==r?this.length:r),this.length=this.models.length),m&&this.sort({silent:!0}),!t.silent){for(s=0;s<l.length;s++)null!=r&&(t.index=r+s),o=l[s],o.trigger("add",o,this,t);(m||w)&&this.trigger("sort",this,t),(l.length||c.length||u.length)&&(t.changes={added:l,removed:c,merged:u},this.trigger("update",this,t))}return i?e[0]:e}},reset:function(e,t){t=t?n.clone(t):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return o.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return 0>e&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var i=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),1===i||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t.call(e.context,i,n,e),i.trigger("sync",i,n,e)},$(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var i=t.wait;if(e=this._prepareModel(e,t),!e)return!1;i||this.add(e,t);var r=this,o=t.success;return t.success=function(e,t,n){i&&r.add(e,n),o&&o.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeModels:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=this.get(e[i]);if(r){var o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];var s=this.modelId(r.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=o,r.trigger("remove",r,this,t)),n.push(r),this._removeReference(r,t)}}return n},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,i),"change"===e){var r=this.modelId(t.previousAttributes()),o=this.modelId(t.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=t))}}this.trigger.apply(this,arguments)}});var E={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};a(x,E,"models");var T=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,M)),this._ensureElement(),this.initialize.apply(this,arguments)},S=/^(\S+)\s*(.*)$/,M=["model","collection","el","id","attributes","className","tagName","events"];n.extend(T.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=n.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[i]),i){var r=t.match(S);this.delegate(r[1],r[2],n.bind(i,this))}}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,i,r){var o=R[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=n.result(i,"url")||q()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===s.type||r.emulateJSON||(s.processData=!1);var l=r.error;r.error=function(e,t,n){r.textStatus=t,r.errorThrown=n,l&&l.call(r.context,e,t,n)};var u=r.xhr=t.ajax(n.extend(s,r));return i.trigger("request",i,u,r),u};var R={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var A=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},V=/\((.*?)\)/g,P=/(\(\?)?:\w+/g,D=/\*\w+/g,N=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(A.prototype,c,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return t.history.route(e,function(n){var s=o._extractParameters(e,n);o.execute(r,s,i)!==!1&&(o.trigger.apply(o,["route:"+i].concat(s)),o.trigger("route",i,s),t.history.trigger("route",o,i,s))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(N,"\\$&").replace(V,"(?:$1)?").replace(P,function(e,t){return t?e:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var j=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,F=/#.*$/;j.started=!1,n.extend(j.prototype,c,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(O,"")},start:function(e){if(j.started)throw new Error("Backbone.history has already been started");if(j.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(I,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,r=i.insertBefore(this.iframe,i.firstChild).contentWindow;r.document.open(),r.document.close(),r.location.hash="#"+this.fragment}var o=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};return this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),j.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})):!1},navigate:function(e,t){if(!j.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var n=this.root;(""===e||"?"===e.charAt(0))&&(n=n.slice(0,-1)||"/");var i=n+e;if(e=this.decodeFragment(e.replace(F,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;t.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new j;var B=function(e,t){var i,r=this;return i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t),i.prototype=n.create(r.prototype,e),i.prototype.constructor=i,i.__super__=r.prototype,i};b.extend=x.extend=A.extend=T.extend=j.extend=B;var q=function(){throw new Error('A "url" property or function must be specified')},$=function(e,t){var n=t.error;t.error=function(i){n&&n.call(t.context,e,i,t),e.trigger("error",e,i,t)}};return t}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define("backbone.radio",["underscore","backbone"],t):(e.Backbone=e.Backbone||{},
e.Backbone.Radio=t(e._,e.Backbone))}(this,function(e,t){"use strict";function n(e,t,n,i){var r=e[t];return n&&n!==r.callback&&n!==r.callback._callback||i&&i!==r.context?void 0:(delete e[t],!0)}function i(t,i,r,o){t||(t={});for(var s=i?[i]:e.keys(t),a=!1,l=0,u=s.length;u>l;l++)i=s[l],t[i]&&n(t,i,r,o)&&(a=!0);return a}function r(t){return c[t]||(c[t]=e.bind(l.log,l,t))}function o(t){return e.isFunction(t)?t:function(){return t}}e="default"in e?e["default"]:e,t="default"in t?t["default"]:t;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=t.Radio,l=t.Radio={};l.VERSION="2.0.0",l.noConflict=function(){return t.Radio=a,this},l.DEBUG=!1,l._debugText=function(e,t,n){return e+(n?" on the "+n+" channel":"")+': "'+t+'"'},l.debugLog=function(e,t,n){l.DEBUG&&console&&console.warn&&console.warn(l._debugText(e,t,n))};var u=/\s+/;l._eventsApi=function(t,n,i,r){if(!i)return!1;var o={};if("object"===("undefined"==typeof i?"undefined":s(i))){for(var a in i){var l=t[n].apply(t,[a,i[a]].concat(r));u.test(a)?e.extend(o,l):o[a]=l}return o}if(u.test(i)){for(var c=i.split(u),h=0,d=c.length;d>h;h++)o[c[h]]=t[n].apply(t,[c[h]].concat(r));return o}return!1},l._callHandler=function(e,t,n){var i=n[0],r=n[1],o=n[2];switch(n.length){case 0:return e.call(t);case 1:return e.call(t,i);case 2:return e.call(t,i,r);case 3:return e.call(t,i,r,o);default:return e.apply(t,n)}};var c={};e.extend(l,{log:function(t,n){if("undefined"!=typeof console){var i=e.toArray(arguments).slice(2);console.log("["+t+'] "'+n+'"',i)}},tuneIn:function(e){var t=l.channel(e);return t._tunedIn=!0,t.on("all",r(e)),this},tuneOut:function(e){var t=l.channel(e);return t._tunedIn=!1,t.off("all",r(e)),delete c[e],this}}),l.Requests={request:function(t){var n=e.toArray(arguments).slice(1),i=l._eventsApi(this,"request",t,n);if(i)return i;var r=this.channelName,o=this._requests;if(r&&this._tunedIn&&l.log.apply(this,[r,t].concat(n)),o&&(o[t]||o["default"])){var s=o[t]||o["default"];return n=o[t]?n:arguments,l._callHandler(s.callback,s.context,n)}l.debugLog("An unhandled request was fired",t,r)},reply:function(e,t,n){return l._eventsApi(this,"reply",e,[t,n])?this:(this._requests||(this._requests={}),this._requests[e]&&l.debugLog("A request was overwritten",e,this.channelName),this._requests[e]={callback:o(t),context:n||this},this)},replyOnce:function(t,n,i){if(l._eventsApi(this,"replyOnce",t,[n,i]))return this;var r=this,s=e.once(function(){return r.stopReplying(t),o(n).apply(this,arguments)});return this.reply(t,s,i)},stopReplying:function(e,t,n){return l._eventsApi(this,"stopReplying",e)?this:(e||t||n?i(this._requests,e,t,n)||l.debugLog("Attempted to remove the unregistered request",e,this.channelName):delete this._requests,this)}},l._channels={},l.channel=function(e){if(!e)throw new Error("You must provide a name for the channel.");return l._channels[e]?l._channels[e]:l._channels[e]=new l.Channel(e)},l.Channel=function(e){this.channelName=e},e.extend(l.Channel.prototype,t.Events,l.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var h,d,f=[t.Events,l.Requests];return e.each(f,function(t){e.each(t,function(t,n){l[n]=function(t){return d=e.toArray(arguments).slice(1),h=this.channel(t),h[n].apply(h,d)}})}),l.reset=function(t){var n=t?[this._channels[t]]:this._channels;e.each(n,function(e){e.reset()})},l}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("backbone"),require("underscore"),require("backbone.radio")):"function"==typeof define&&define.amd?define("backbone.marionette",["backbone","underscore","backbone.radio"],t):e.Marionette=t(e.Backbone,e._,e.Backbone.Radio)}(this,function(e,t,n){"use strict";function i(e,t,n){return n.toUpperCase()}function r(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];var o=G(e),s=U.call(this,o),a=void 0;return t.isFunction(s)&&(a=s.apply(this,i)),this.trigger.apply(this,arguments),a}function o(e){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;n>o;o++)i[o-1]=arguments[o];return t.isFunction(e.triggerMethod)?e.triggerMethod.apply(e,i):r.apply(e,i)}function s(e,n,i){e._getImmediateChildren&&t.each(e._getImmediateChildren(),function(e){i(e)&&o(e,n,e)})}function a(e){return!e._isAttached}function l(e){return a(e)?(e._isAttached=!0,!0):!1}function u(e){return e._isAttached}function c(e){return u(e)?(e._isAttached=!1,!0):!1}function h(e){e._isAttached&&e._isRendered&&o(e,"dom:refresh",e)}function d(e){e._isAttached&&e._isRendered&&o(e,"dom:remove",e)}function f(){s(this,"before:attach",a)}function p(){s(this,"attach",l),h(this)}function m(){s(this,"before:detach",u),d(this)}function g(){s(this,"detach",c)}function v(){d(this)}function y(){h(this)}function b(e){e._areViewEventsMonitored||e.monitorViewEvents===!1||(e._areViewEventsMonitored=!0,e.on({"before:attach":f,attach:p,"before:detach":m,detach:g,"before:render":v,render:y}))}function w(e,n,i,r,o){var s=r.split(/\s+/);s.length>1&&z("Multiple handlers for a single event are deprecated. If needed, use a single handler to call multiple methods."),t.each(s,function(t){var r=e[t];if(!r)throw new J('Method "'+t+'" was configured as an event handler, but does not exist.');e[o](n,i,r)})}function x(e,n,i,r){if(!t.isObject(i))throw new J({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindevents"});t.each(i,function(i,o){return t.isString(i)?void w(e,n,o,i,r):void e[r](n,o,i)})}function _(e,t){return e&&t?(x(this,e,t,"listenTo"),this):this}function C(e,t){return e?t?(x(this,e,t,"stopListening"),this):(this.stopListening(e),this):this}function k(e,n,i,r){if(!t.isObject(i))throw new J({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindrequests"});var o=X.call(e,i);n[r](o,e)}function E(e,t){return e&&t?(k(this,e,t,"reply"),this):this}function T(e,t){return e?t?(k(this,e,t,"stopReplying"),this):(e.stopReplying(null,null,this),this):this}function S(e,n){return e.behaviorClass?e.behaviorClass:t.isFunction(e)?e:t.isFunction(Le.Behaviors.behaviorsLookup)?Le.Behaviors.behaviorsLookup(e,n)[n]:Le.Behaviors.behaviorsLookup[n]}function M(e,n){return t.chain(n).map(function(n,i){var r=S(n,i),o=n===r?{}:n,s=new r(o,e),a=M(e,t.result(s,"behaviors"));return[s].concat(a)}).flatten().value()}function R(e){return!!ue[e]}function A(e,t){return ue[e]=t}function V(e,n){t.isString(n)&&(n={event:n});var i=n.event,r=!!n.preventDefault;R("triggersPreventDefault")&&(r=n.preventDefault!==!1);var o=!!n.stopPropagation;return R("triggersStopPropagation")&&(o=n.stopPropagation!==!1),function(t){r&&t.preventDefault(),o&&t.stopPropagation(),e.triggerMethod(i,e,t)}}function P(t){return t instanceof e.$?t:e.$(t)}function D(e){return this.prototype.Dom=t.extend({},this.prototype.Dom,e),this}function N(e){e._isRendered||(e.supportsRenderLifecycle||o(e,"before:render",e),e.render(),e.supportsRenderLifecycle||(e._isRendered=!0,o(e,"render",e)))}function j(e){if(e.destroy)return void e.destroy();e.supportsDestroyLifecycle||o(e,"before:destroy",e);var t=e._isAttached&&!e._shouldDisableEvents;t&&o(e,"before:detach",e),e.remove(),t&&(e._isAttached=!1,o(e,"detach",e)),e._isDestroyed=!0,e.supportsDestroyLifecycle||o(e,"destroy",e)}function O(e,n){var i=t.extend({},n);if(t.isString(e))return t.extend(i,{el:e}),I(i);if(t.isFunction(e))return t.extend(i,{regionClass:e}),I(i);if(t.isObject(e))return e.selector&&z("The selector option on a Region definition object is deprecated. Use el to pass a selector string"),t.extend(i,{el:e.selector},e),I(i);throw new J({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})}function I(e){var n=e.regionClass,i=t.omit(e,"regionClass");return new n(i)}function F(e,t){return t.model&&t.model.get(e)}function B(){throw new J({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.md#behaviorslookup"})}e=e&&e.hasOwnProperty("default")?e["default"]:e,t=t&&t.hasOwnProperty("default")?t["default"]:t,n=n&&n.hasOwnProperty("default")?n["default"]:n;var q="3.5.1",$=function(e){return function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];return e.apply(t,i)}},L=e.Model.extend,z=function ze(e,n){t.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),Le.DEV_MODE&&(void 0!==n&&n||ze._cache[e]||(ze._warn("Deprecation warning: "+e),ze._cache[e]=!0))};z._console="undefined"!=typeof console?console:{},z._warn=function(){var e=z._console.warn||z._console.log||t.noop;return e.apply(z._console,arguments)},z._cache={};var H=function(e){return document.documentElement.contains(e&&e.parentNode)},W=function(e,n){var i=this;e&&t.each(n,function(t){var n=e[t];void 0!==n&&(i[t]=n)})},U=function(e){return e?this.options&&void 0!==this.options[e]?this.options[e]:this[e]:void 0},X=function(e){var n=this;return t.reduce(e,function(e,i,r){return t.isFunction(i)||(i=n[i]),i&&(e[r]=i),e},{})},K=/(^|:)(\w)/gi,G=t.memoize(function(e){return"on"+e.replace(K,i)}),Y=["description","fileName","lineNumber","name","message","number"],J=L.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+q+"/",constructor:function(e,n){t.isObject(e)?(n=e,e=n.message):n||(n={});var i=Error.call(this,e);t.extend(this,t.pick(i,Y),t.pick(n,Y)),this.captureStackTrace(),n.url&&(this.url=this.urlRoot+n.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,J)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}});J.extend=L;var Q=function(e){this.options=t.extend({},t.result(this,"options"),e)},Z={normalizeMethods:X,_setOptions:Q,mergeOptions:W,getOption:U,bindEvents:_,unbindEvents:C},ee={_initRadio:function(){var e=t.result(this,"channelName");if(e){if(!n)throw new J({name:"BackboneRadioMissing",message:'The dependency "backbone.radio" is missing.'});var i=this._channel=n.channel(e),r=t.result(this,"radioEvents");this.bindEvents(i,r);var o=t.result(this,"radioRequests");this.bindRequests(i,o),this.on("destroy",this._destroyRadio)}},_destroyRadio:function(){this._channel.stopReplying(null,null,this)},getChannel:function(){return this._channel},bindEvents:_,unbindEvents:C,bindRequests:E,unbindRequests:T},te=["channelName","radioEvents","radioRequests"],ne=function(e){this.hasOwnProperty("options")||this._setOptions(e),this.mergeOptions(e,te),this._setCid(),this._initRadio(),this.initialize.apply(this,arguments)};ne.extend=L,t.extend(ne.prototype,e.Events,Z,ee,{cidPrefix:"mno",_isDestroyed:!1,isDestroyed:function(){return this._isDestroyed},initialize:function(){},_setCid:function(){this.cid||(this.cid=t.uniqueId(this.cidPrefix))},destroy:function(){if(this._isDestroyed)return this;for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return this.triggerMethod.apply(this,["before:destroy",this].concat(t)),this._isDestroyed=!0,this.triggerMethod.apply(this,["destroy",this].concat(t)),this.stopListening(),this},triggerMethod:r});var ie=function(e){this.templateId=e};t.extend(ie,{templateCaches:{},get:function(e,t){var n=this.templateCaches[e];return n||(n=new ie(e),this.templateCaches[e]=n),n.load(t)},clear:function(){for(var e=void 0,t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];var r=n.length;if(r>0)for(e=0;r>e;e++)delete this.templateCaches[n[e]];else this.templateCaches={}}}),t.extend(ie.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(t,n){var i=e.$(t);if(!i.length)throw new J({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return i.html()},compileTemplate:function(e,n){return t.template(e,n)}});var re=t.invokeMap||t.invoke,oe={_initBehaviors:function(){this._behaviors=this._getBehaviors()},_getBehaviors:function(){var e=t.result(this,"behaviors");return t.isObject(e)?M(this,e):{}},_getBehaviorTriggers:function(){var e=re(this._behaviors,"getTriggers");return t.reduce(e,function(e,n){return t.extend(e,n)},{})},_getBehaviorEvents:function(){var e=re(this._behaviors,"getEvents");return t.reduce(e,function(e,n){return t.extend(e,n)},{})},_proxyBehaviorViewProperties:function(){re(this._behaviors,"proxyViewProperties")},_delegateBehaviorEntityEvents:function(){re(this._behaviors,"delegateEntityEvents")},_undelegateBehaviorEntityEvents:function(){re(this._behaviors,"undelegateEntityEvents")},_destroyBehaviors:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];re.apply(void 0,[this._behaviors,"destroy"].concat(t))},_removeBehavior:function(e){this._isDestroyed||(this.undelegate(".trig"+e.cid+" ."+e.cid),this._behaviors=t.without(this._behaviors,e))},_bindBehaviorUIElements:function(){re(this._behaviors,"bindUIElements")},_unbindBehaviorUIElements:function(){re(this._behaviors,"unbindUIElements")},_triggerEventOnBehaviors:function(){for(var e=this._behaviors,t=0,n=e&&e.length;n>t;t++)r.apply(e[t],arguments)}},se={_delegateEntityEvents:function(e,n){var i=t.result(this,"modelEvents");i&&(C.call(this,e,i),_.call(this,e,i));var r=t.result(this,"collectionEvents");r&&(C.call(this,n,r),_.call(this,n,r))},_undelegateEntityEvents:function(e,n){var i=t.result(this,"modelEvents");C.call(this,e,i);var r=t.result(this,"collectionEvents");C.call(this,n,r)}},ae=/^(\S+)\s*(.*)$/,le=function(e,t){var n=e.match(ae);return n[1]+"."+t+" "+n[2]},ue={childViewEventPrefix:!0,triggersStopPropagation:!0,triggersPreventDefault:!0},ce={_getViewTriggers:function(e,n){var i=this;return t.reduce(n,function(t,n,r){return r=le(r,"trig"+i.cid),t[r]=V(e,n),t},{})}},he=function(e,n){return t.reduce(e,function(e,t,i){var r=de(i,n);return e[r]=t,e},{})},de=function(e,t){return e.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(e){return t[e.slice(4)]})},fe=function He(e,n,i){return t.each(e,function(r,o){t.isString(r)?e[o]=de(r,n):t.isObject(r)&&t.isArray(i)&&(t.extend(r,He(t.pick(r,i),n)),t.each(i,function(e){var i=r[e];t.isString(i)&&(r[e]=de(i,n))}))}),e},pe={normalizeUIKeys:function(e){var t=this._getUIBindings();return he(e,t)},normalizeUIString:function(e){var t=this._getUIBindings();return de(e,t)},normalizeUIValues:function(e,t){var n=this._getUIBindings();return fe(e,n,t)},_getUIBindings:function(){var e=t.result(this,"_uiBindings"),n=t.result(this,"ui");return e||n},_bindUIElements:function(){var e=this;if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var n=t.result(this,"_uiBindings");this._ui={},t.each(n,function(t,n){e._ui[n]=e.$(t)}),this.ui=this._ui}},_unbindUIElements:function(){var e=this;this.ui&&this._uiBindings&&(t.each(this.ui,function(t,n){delete e.ui[n]}),this.ui=this._uiBindings,delete this._uiBindings,delete this._ui)},_getUI:function(e){return this._ui[e]}},me={createBuffer:function(){return document.createDocumentFragment()},getEl:function(e){return P(e)},findEl:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P(e);return n.find(t)},hasEl:function(e,t){return e.contains(t&&t.parentNode)},detachEl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P(e);t.detach()},replaceEl:function(e,t){if(e!==t){var n=t.parentNode;n&&n.replaceChild(e,t)}},swapEl:function(e,t){if(e!==t){var n=e.parentNode,i=t.parentNode;if(n&&i){var r=e.nextSibling,o=t.nextSibling;n.insertBefore(t,r),i.insertBefore(e,o)}}},setContents:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:P(e);n.html(t)},appendContents:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n._$el,r=void 0===i?P(e):i,o=n._$contents,s=void 0===o?P(t):o;r.append(s)},hasContents:function(e){return!!e&&e.hasChildNodes()},detachContents:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P(e);t.contents().detach()}},ge={Dom:me,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,_isDestroyed:!1,isDestroyed:function(){return!!this._isDestroyed},_isRendered:!1,isRendered:function(){return!!this._isRendered},_isAttached:!1,isAttached:function(){return!!this._isAttached},delegateEvents:function(n){this._proxyBehaviorViewProperties(),this._buildEventProxies();var i=this._getEvents(n);"undefined"==typeof n&&(this.events=i);var r=t.extend({},this._getBehaviorEvents(),i,this._getBehaviorTriggers(),this.getTriggers());return e.View.prototype.delegateEvents.call(this,r),this},_getEvents:function(e){var n=e||this.events;return t.isFunction(n)?this.normalizeUIKeys(n.call(this)):this.normalizeUIKeys(n)},getTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(t.result(this,"triggers"));return this._getViewTriggers(this,e)}},delegateEntityEvents:function(){return this._delegateEntityEvents(this.model,this.collection),this._delegateBehaviorEntityEvents(),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.model,this.collection),this._undelegateBehaviorEntityEvents(),this},destroy:function(){if(this._isDestroyed)return this;for(var e=this._isAttached&&!this._shouldDisableEvents,t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];return this.triggerMethod.apply(this,["before:destroy",this].concat(n)),e&&this.triggerMethod("before:detach",this),this.unbindUIElements(),this._removeElement(),e&&(this._isAttached=!1,this.triggerMethod("detach",this)),this._removeChildren(),this._isDestroyed=!0,this._isRendered=!1,this._destroyBehaviors.apply(this,n),this.triggerMethod.apply(this,["destroy",this].concat(n)),this.stopListening(),this},_removeElement:function(){this.$el.off().removeData(),this.Dom.detachEl(this.el,this.$el)},bindUIElements:function(){return this._bindUIElements(),this._bindBehaviorUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this._unbindBehaviorUIElements(),this},getUI:function(e){return this._getUI(e)},childViewEventPrefix:function(){return R("childViewEventPrefix")?"childview":!1},triggerMethod:function(){var e=r.apply(this,arguments);return this._triggerEventOnBehaviors.apply(this,arguments),e},_buildEventProxies:function(){this._childViewEvents=t.result(this,"childViewEvents"),this._childViewTriggers=t.result(this,"childViewTriggers")},_proxyChildViewEvents:function(e){this.listenTo(e,"all",this._childViewEventHandler)},_childViewEventHandler:function(e){for(var n=this.normalizeMethods(this._childViewEvents),i=arguments.length,r=Array(i>1?i-1:0),o=1;i>o;o++)r[o-1]=arguments[o];"undefined"!=typeof n&&t.isFunction(n[e])&&n[e].apply(this,r);var s=this._childViewTriggers;s&&t.isString(s[e])&&this.triggerMethod.apply(this,[s[e]].concat(r));var a=t.result(this,"childViewEventPrefix");if(a!==!1){var l=a+":"+e;this.triggerMethod.apply(this,[l].concat(r))}}};t.extend(ge,oe,Z,se,ce,pe);var ve=["allowMissingEl","parentEl","replaceElement"],ye=ne.extend({Dom:me,cidPrefix:"mnr",replaceElement:!1,_isReplaced:!1,_isSwappingView:!1,constructor:function(t){if(this._setOptions(t),this.mergeOptions(t,ve),this._initEl=this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new J({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),ne.call(this,t)},show:function(e,t){return this._ensureElement(t)?(e=this._getView(e,t),e===this.currentView?this:(this._isSwappingView=!!this.currentView,this.triggerMethod("before:show",this,e,t),e._isAttached||this.empty(t),this._setupChildView(e),this.currentView=e,N(e),this._attachView(e,t),this.triggerMethod("show",this,e,t),this._isSwappingView=!1,this)):void 0},_setupChildView:function(e){b(e),this._proxyChildViewEvents(e),e.on("destroy",this._empty,this)},_proxyChildViewEvents:function(e){var t=this._parentView;t&&t._proxyChildViewEvents(e)},_shouldDisableMonitoring:function(){return this._parentView&&this._parentView.monitorViewEvents===!1},_attachView:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!e._isAttached&&H(this.el)&&!this._shouldDisableMonitoring(),r="undefined"==typeof n.replaceElement?!!t.result(this,"replaceElement"):!!n.replaceElement;i&&o(e,"before:attach",e),r?this._replaceEl(e):this.attachHtml(e),i&&(e._isAttached=!0,o(e,"attach",e))},_ensureElement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0],this.$el=this.Dom.getEl(this.el)),!this.$el||0===this.$el.length){var n="undefined"==typeof e.allowMissingEl?!!t.result(this,"allowMissingEl"):!!e.allowMissingEl;if(n)return!1;throw new J('An "el" must exist in DOM for this region '+this.cid)}return!0},_getView:function(t){if(!t)throw new J({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t._isDestroyed)throw new J({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'});if(t instanceof e.View)return t;var n=this._getViewOptions(t);return new Ce(n)},_getViewOptions:function(e){if(t.isFunction(e))return{template:e};if(t.isObject(e))return e;var n=function(){return e};return{template:n}},getEl:function(e){var n=t.result(this,"parentEl");return n&&t.isString(e)?this.Dom.findEl(n,e):this.Dom.getEl(e)},_replaceEl:function(e){this._restoreEl(),e.on("before:destroy",this._restoreEl,this),this.Dom.replaceEl(e.el,this.el),this._isReplaced=!0},_restoreEl:function(){if(this._isReplaced){var e=this.currentView;e&&(this._detachView(e),this._isReplaced=!1)}},isReplaced:function(){return!!this._isReplaced},isSwappingView:function(){return!!this._isSwappingView},attachHtml:function(e){this.Dom.appendContents(this.el,e.el,{_$el:this.$el,_$contents:e.$el})},empty:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allowMissingEl:!0},t=this.currentView;if(!t)return this._ensureElement(e)&&this.detachHtml(),this;var n=!e.preventDestroy;return n||z("The preventDestroy option is deprecated. Use Region#detachView"),this._empty(t,n),this},_empty:function(e,t){e.off("destroy",this._empty,this),this.triggerMethod("before:empty",this,e),this._restoreEl(),delete this.currentView,e._isDestroyed||(t?this.removeView(e):this._detachView(e),this._stopChildViewEvents(e)),this.triggerMethod("empty",this,e)},_stopChildViewEvents:function(e){var t=this._parentView;t&&this._parentView.stopListening(e)},destroyView:function(e){return e._isDestroyed?e:(e._shouldDisableEvents=this._shouldDisableMonitoring(),j(e),e)},removeView:function(e){this.destroyView(e)},detachView:function(){var e=this.currentView;if(e)return this._empty(e),e},_detachView:function(e){var t=e._isAttached&&!this._shouldDisableMonitoring(),n=this._isReplaced;t&&o(e,"before:detach",e),n?this.Dom.replaceEl(this.el,e.el):this.detachHtml(),t&&(e._isAttached=!1,o(e,"detach",e))},detachHtml:function(){this.Dom.detachContents(this.el,this.$el)},hasView:function(){return!!this.currentView},reset:function(e){return this.empty(e),this.$el&&(this.el=this._initEl),delete this.$el,this},destroy:function(e){return this._isDestroyed?this:(this.reset(e),this._name&&this._parentView._removeReferences(this._name),delete this._parentView,delete this._name,ne.prototype.destroy.apply(this,arguments))}},{setDomApi:D}),be=function(e,t){return e instanceof ye?e:O(e,t)},we={regionClass:ye,_initRegions:function(){this.regions=this.regions||{},this._regions={},this.addRegions(t.result(this,"regions"))},_reInitRegions:function(){re(this._regions,"reset")},addRegion:function(e,t){var n={};return n[e]=t,this.addRegions(n)[e]},addRegions:function(e){return t.isEmpty(e)?void 0:(e=this.normalizeUIValues(e,["selector","el"]),this.regions=t.extend({},this.regions,e),this._addRegions(e))},_addRegions:function(e){var n=this,i={regionClass:this.regionClass,parentEl:t.partial(t.result,this,"el")};return t.reduce(e,function(e,t,r){return e[r]=be(t,i),n._addRegion(e[r],r),e},{})},_addRegion:function(e,t){this.triggerMethod("before:add:region",this,t,e),e._parentView=this,e._name=t,this._regions[t]=e,this.triggerMethod("add:region",this,t,e)},removeRegion:function(e){var t=this._regions[e];return this._removeRegion(t,e),t},removeRegions:function(){var e=this._getRegions();return t.each(this._regions,t.bind(this._removeRegion,this)),e},_removeRegion:function(e,t){this.triggerMethod("before:remove:region",this,t,e),e.destroy(),this.triggerMethod("remove:region",this,t,e)},_removeReferences:function(e){delete this.regions[e],delete this._regions[e]},emptyRegions:function(){var e=this.getRegions();return re(e,"empty"),e},hasRegion:function(e){return!!this.getRegion(e)},getRegion:function(e){return this._isRendered||this.render(),this._regions[e]},_getRegions:function(){return t.clone(this._regions)},getRegions:function(){return this._isRendered||this.render(),this._getRegions()},showChildView:function(e,t){for(var n=this.getRegion(e),i=arguments.length,r=Array(i>2?i-2:0),o=2;i>o;o++)r[o-2]=arguments[o];return n.show.apply(n,[t].concat(r))},detachChildView:function(e){return this.getRegion(e).detachView()},getChildView:function(e){return this.getRegion(e).currentView}},xe={render:function(e,n){if(!e)throw new J({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var i=t.isFunction(e)?e:ie.get(e);return i(n)}},_e=["behaviors","childViewEventPrefix","childViewEvents","childViewTriggers","collectionEvents","events","modelEvents","regionClass","regions","template","templateContext","triggers","ui"],Ce=e.View.extend({constructor:function(n){this.render=t.bind(this.render,this),this._setOptions(n),this.mergeOptions(n,_e),b(this),this._initBehaviors(),this._initRegions();var i=Array.prototype.slice.call(arguments);i[0]=this.options,e.View.prototype.constructor.apply(this,i),this.delegateEntityEvents(),this._triggerEventOnBehaviors("initialize",this)},serializeData:function(){return this.model||this.collection?this.model?this.serializeModel():{items:this.serializeCollection()}:{}},serializeModel:function(){return this.model?t.clone(this.model.attributes):{}},serializeCollection:function(){return this.collection?this.collection.map(function(e){return t.clone(e.attributes)}):{}},setElement:function(){return e.View.prototype.setElement.apply(this,arguments),this._isRendered=this.Dom.hasContents(this.el),this._isAttached=H(this.el),this._isRendered&&this.bindUIElements(),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._isRendered&&this._reInitRegions(),this._renderTemplate(),this.bindUIElements(),this._isRendered=!0,this.triggerMethod("render",this),this)},_renderTemplate:function(){var e=this.getTemplate();if(e===!1)return void z("template:false is deprecated.  Use _.noop.");var t=this.mixinTemplateContext(this.serializeData()),n=this._renderHtml(e,t);this.attachElContent(n)},_renderHtml:function(e,t){return xe.render(e,t,this)},getTemplate:function(){return this.template},mixinTemplateContext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.result(this,"templateContext");return t.extend(e,n)},attachElContent:function(e){return this.Dom.setContents(this.el,e,this.$el),this},_removeChildren:function(){this.removeRegions()},_getImmediateChildren:function(){return t.chain(this._getRegions()).map("currentView").compact().value()}},{setRenderer:function(e){return this.prototype._renderHtml=e,this},setDomApi:D});t.extend(Ce.prototype,ge,we);var ke=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce","partition"],Ee=function(e,n){t.each(ke,function(i){e[i]=function(){var e=t.result(this,n),r=Array.prototype.slice.call(arguments);return t[i].apply(t,[e].concat(r))}})},Te=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,t.bind(this.add,this))};Ee(Te.prototype,"_getViews"),t.extend(Te.prototype,{_getViews:function(){return t.values(this._views)},add:function(e,t){return this._add(e,t)._updateLength()},_add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){return this._remove(e)._updateLength()},_remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.some(this._indexByCustom,t.bind(function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this)),delete this._views[n],this},_updateLength:function(){return this.length=t.size(this._views),this}});var Se=["behaviors","childView","childViewEventPrefix","childViewEvents","childViewOptions","childViewTriggers","collectionEvents","events","filter","emptyView","emptyViewOptions","modelEvents","reorderOnSort","sort","triggers","ui","viewComparator"],Me=e.View.extend({sort:!0,constructor:function(n){this.render=t.bind(this.render,this),this._setOptions(n),this.mergeOptions(n,Se),b(this),this._initBehaviors(),this.once("render",this._initialEvents),this._initChildViewStorage(),this._bufferedChildren=[];var i=Array.prototype.slice.call(arguments);i[0]=this.options,e.View.prototype.constructor.apply(this,i),this.delegateEntityEvents(),this._triggerEventOnBehaviors("initialize",this)},_startBuffering:function(){this._isBuffering=!0},_endBuffering:function(){var e=this._isAttached&&this.monitorViewEvents!==!1,n=e?this._getImmediateChildren():[];this._isBuffering=!1,t.each(n,function(e){o(e,"before:attach",e)}),this.attachBuffer(this,this._createBuffer()),t.each(n,function(e){e._isAttached=!0,o(e,"attach",e)}),this._bufferedChildren=[]},_getImmediateChildren:function(){return t.values(this.children._views)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"update",this._onCollectionUpdate),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,n,i){var r=void 0!==i.at&&(i.index||n.indexOf(e));(this.filter||r===!1)&&(r=t.indexOf(this._filteredSortedModels(r),e)),this._shouldAddChild(e,r)&&(this._destroyEmptyView(),this._addChild(e,r))},_onCollectionUpdate:function(e,t){var n=t.changes;this._removeChildModels(n.removed)},_removeChildModels:function(e){var t=this._getRemovedViews(e);t.length&&(this.children._updateLength(),this._updateIndices(t,!1),this.isEmpty()&&this._showEmptyView())},_getRemovedViews:function(e){var n=this;return t.reduce(e,function(e,t){var i=t&&n.children.findByModel(t);return!i||i._isDestroyed?e:(n._removeChildView(i),e.push(i),e)},[])},_removeChildView:function(e){this.triggerMethod("before:remove:child",this,e),this.children._remove(e),e._shouldDisableEvents=this.monitorViewEvents===!1,j(e),this.stopListening(e),this.triggerMethod("remove:child",this,e)},setElement:function(){return e.View.prototype.setElement.apply(this,arguments),this._isAttached=H(this.el),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._renderChildren(),this._isRendered=!0,this.triggerMethod("render",this),this)},setFilter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.preventRender,i=this._isRendered&&!this._isDestroyed,r=this.filter!==e,o=i&&r&&!n;if(o){var s=this._filteredSortedModels();this.filter=e;var a=this._filteredSortedModels();this._applyModelDeltas(a,s)}else this.filter=e;return this},removeFilter:function(e){return this.setFilter(null,e);
},_applyModelDeltas:function(e,n){var i=this,r={};t.each(e,function(e,t){var n=!i.children.findByModel(e);n&&i._onCollectionAdd(e,i.collection,{at:t}),r[e.cid]=!0});var o=t.filter(n,function(e){return!r[e.cid]&&i.children.findByModel(e)});this._removeChildModels(o)},reorder:function(){var e=this,n=this.children,i=this._filteredSortedModels();if(!i.length&&this._showingEmptyView)return this;var r=t.some(i,function(e){return!n.findByModel(e)});if(r)this.render();else{var o=[],s=t.reduce(this.children._views,function(e,n){var r=t.indexOf(i,n.model);return-1===r?(o.push(n.model),e):(n._index=r,e[r]=n.el,e)},new Array(i.length));this.triggerMethod("before:reorder",this);var a=this.Dom.createBuffer();t.each(s,function(t){e.Dom.appendContents(a,t)}),this._appendReorderedChildren(a),this._removeChildModels(o),this.triggerMethod("reorder",this)}return this},resortView:function(){return this.reorderOnSort?this.reorder():this._renderChildren(),this},_sortViews:function(){var e=this,n=this._filteredSortedModels(),i=t.find(n,function(t,n){var i=e.children.findByModel(t);return!i||i._index!==n});i&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.Dom.appendContents(this.el,e,{_$el:this.$el})},_renderChildren:function(){this._isRendered&&(this._destroyEmptyView(),this._destroyChildren());var e=this._filteredSortedModels();this.isEmpty({processedModels:e})?this._showEmptyView():(this.triggerMethod("before:render:children",this),this._startBuffering(),this._showCollection(e),this._endBuffering(),this.triggerMethod("render:children",this))},_createView:function(e,t){var n=this._getChildView(e),i=this._getChildViewOptions(e,t),r=this.buildChildView(e,n,i);return r},_setupChildView:function(e,t){b(e),this._proxyChildViewEvents(e),this.sort&&(e._index=t)},_showCollection:function(e){t.each(e,t.bind(this._addChild,this)),this.children._updateLength()},_filteredSortedModels:function(e){if(!this.collection||!this.collection.length)return[];var t=this.getViewComparator(),n=this.collection.models;if(e=Math.min(Math.max(e,0),n.length-1),t){var i=void 0;e&&(i=n[e],n=n.slice(0,e).concat(n.slice(e+1))),n=this._sortModelsBy(n,t),i&&n.splice(e,0,i)}return n=this._filterModels(n)},getViewComparator:function(){return this.viewComparator},_filterModels:function(e){var n=this;return this.filter&&(e=t.filter(e,function(e,t){return n._shouldAddChild(e,t)})),e},_sortModelsBy:function(e,n){return"string"==typeof n?t.sortBy(e,function(e){return e.get(n)}):1===n.length?t.sortBy(e,t.bind(n,this)):t.clone(e).sort(t.bind(n,this))},_showEmptyView:function(){var n=this._getEmptyView();if(n&&!this._showingEmptyView){this._showingEmptyView=!0;var i=new e.Model,r=this.emptyViewOptions||this.childViewOptions;t.isFunction(r)&&(r=r.call(this,i,this._emptyViewIndex));var o=this.buildChildView(i,n,r);this.triggerMethod("before:render:empty",this,o),this.addChildView(o,0),this.triggerMethod("render:empty",this,o)}},_destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty",this),this._destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty",this))},_getEmptyView:function(){var e=this.emptyView;if(e)return this._getView(e)},_getChildView:function(e){var t=this.childView;if(!t)throw new J({name:"NoChildViewError",message:'A "childView" must be specified'});if(t=this._getView(t,e),!t)throw new J({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return t},_getView:function(n,i){return n.prototype instanceof e.View||n===e.View?n:t.isFunction(n)?n.call(this,i):void 0},_addChild:function(e,t){var n=this._createView(e,t);return this.addChildView(n,t),n},_getChildViewOptions:function(e,n){return t.isFunction(this.childViewOptions)?this.childViewOptions(e,n):this.childViewOptions},addChildView:function(e,t){return this.triggerMethod("before:add:child",this,e),this._setupChildView(e,t),this._isBuffering?this.children._add(e):(this._updateIndices(e,!0),this.children.add(e)),N(e),this._attachView(e,t),this.triggerMethod("add:child",this,e),e},_updateIndices:function(e,n){if(this.sort){if(!n)return void t.each(t.sortBy(this.children._views,"_index"),function(e,t){e._index=t});var i=t.isArray(e)?t.max(e,"_index"):e;t.isObject(i)&&t.each(this.children._views,function(e){e._index>=i._index&&(e._index+=1)})}},_attachView:function(e,t){var n=!e._isAttached&&!this._isBuffering&&this._isAttached&&this.monitorViewEvents!==!1;n&&o(e,"before:attach",e),this.attachHtml(this,e,t),n&&(e._isAttached=!0,o(e,"attach",e))},buildChildView:function(e,n,i){var r=t.extend({model:e},i);return new n(r)},removeChildView:function(e){return!e||e._isDestroyed?e:(this._removeChildView(e),this.children._updateLength(),this._updateIndices(e,!1),e)},isEmpty:function(e){var n=void 0;return t.result(e,"processedModels")?n=e.processedModels:(n=this.collection?this.collection.models:[],n=this._filterModels(n)),0===n.length},attachBuffer:function(e,t){this.Dom.appendContents(e.el,t,{_$el:e.$el})},_createBuffer:function(){var e=this,n=this.Dom.createBuffer();return t.each(this._bufferedChildren,function(t){e.Dom.appendContents(n,t.el,{_$contents:t.$el})}),n},attachHtml:function(e,t,n){e._isBuffering?e._bufferedChildren.splice(n,0,t):e._insertBefore(t,n)||e._insertAfter(t)},_insertBefore:function(e,n){var i=void 0,r=this.sort&&n<this.children.length-1;return r&&(i=t.find(this.children._views,function(e){return e._index===n+1})),i?(this.beforeEl(i.el,e.el),!0):!1},beforeEl:function(e,t){this.$(e).before(t)},_insertAfter:function(e){this.Dom.appendContents(this.el,e.el,{_$el:this.$el,_$contents:e.$el})},_initChildViewStorage:function(){this.children=new Te},_removeChildren:function(){this._destroyChildren()},_destroyChildren:function(e){this.children.length&&(this.triggerMethod("before:destroy:children",this),t.each(this.children._views,t.bind(this._removeChildView,this)),this.children._updateLength(),this.triggerMethod("destroy:children",this))},_shouldAddChild:function(e,n){var i=this.filter;return!t.isFunction(i)||i.call(this,e,n,this.collection)}},{setDomApi:D});t.extend(Me.prototype,ge);var Re=function(){this._init()};Ee(Re.prototype,"_views"),t.extend(Re.prototype,{_init:function(){this._views=[],this._viewsByCid={},this._indexByModel={},this._updateLength()},_add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._views.length,n=e.cid;this._viewsByCid[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),this._views.splice(t,0,e),this._updateLength()},_sort:function(e,n){return"string"==typeof e?(e=t.partial(F,e),this._sortBy(e)):1===e.length?this._sortBy(t.bind(e,n)):this._views.sort(t.bind(e,n))},_sortBy:function(e){var n=t.sortBy(this._views,e);return this._set(n),n},_set:function(e){this._views.length=0,this._views.push.apply(this._views,e.slice(0)),this._updateLength()},_swap:function(e,t){var n=this.findIndexByView(e),i=this.findIndexByView(t);if(-1!==n&&-1!==i){var r=this._views[n];this._views[n]=this._views[i],this._views[i]=r}},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByIndex:function(e){return this._views[e]},findIndexByView:function(e){return this._views.indexOf(e)},findByCid:function(e){return this._viewsByCid[e]},hasView:function(e){return!!this.findByCid(e.cid)},_remove:function(e){if(this._viewsByCid[e.cid]){e.model&&delete this._indexByModel[e.model.cid],delete this._viewsByCid[e.cid];var t=this.findIndexByView(e);this._views.splice(t,1),this._updateLength()}},_updateLength:function(){this.length=this._views.length}});var Ae=["behaviors","childView","childViewEventPrefix","childViewEvents","childViewOptions","childViewTriggers","collectionEvents","emptyView","emptyViewOptions","events","modelEvents","sortWithCollection","triggers","ui","viewComparator","viewFilter"],Ve=e.View.extend({sortWithCollection:!0,constructor:function(t){this._setOptions(t),this.mergeOptions(t,Ae),b(this),this.once("render",this._initialEvents),this._initChildViewStorage(),this._initBehaviors();var n=Array.prototype.slice.call(arguments);n[0]=this.options,e.View.prototype.constructor.apply(this,n),this.getEmptyRegion(),this.delegateEntityEvents(),this._triggerEventOnBehaviors("initialize",this)},_initChildViewStorage:function(){this.children=new Re},getEmptyRegion:function(){return this._emptyRegion&&!this._emptyRegion.isDestroyed()?this._emptyRegion:(this._emptyRegion=new ye({el:this.el,replaceElement:!1}),this._emptyRegion._parentView=this,this._emptyRegion)},_initialEvents:function(){this.listenTo(this.collection,{sort:this._onCollectionSort,reset:this._onCollectionReset,update:this._onCollectionUpdate})},_onCollectionSort:function(e,t){var n=t.add,i=t.merge,r=t.remove;this.sortWithCollection&&this.viewComparator!==!1&&(n||r||i||this.sort())},_onCollectionReset:function(){this.render()},_onCollectionUpdate:function(e,t){var n=t.changes,i=n.removed.length&&this._removeChildModels(n.removed);this._addedViews=n.added.length&&this._addChildModels(n.added),this._detachChildren(i),this._showChildren(),this._removeChildViews(i)},_removeChildModels:function(e){var n=this;return t.reduce(e,function(e,t){var i=n._removeChildModel(t);return i&&e.push(i),e},[])},_removeChildModel:function(e){var t=this.children.findByModel(e);return t&&this._removeChild(t),t},_removeChild:function(e){this.triggerMethod("before:remove:child",this,e),this.children._remove(e),this.triggerMethod("remove:child",this,e)},_addChildModels:function(e){return t.map(e,t.bind(this._addChildModel,this))},_addChildModel:function(e){var t=this._createChildView(e);return this._addChild(t),t},_createChildView:function(e){var t=this._getChildView(e),n=this._getChildViewOptions(e),i=this.buildChildView(e,t,n);return i},_addChild:function(e,t){this.triggerMethod("before:add:child",this,e),this._setupChildView(e),this.children._add(e,t),this.triggerMethod("add:child",this,e)},_getChildView:function(e){var t=this.childView;if(!t)throw new J({name:"NoChildViewError",message:'A "childView" must be specified'});if(t=this._getView(t,e),!t)throw new J({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return t},_getView:function(n,i){return n.prototype instanceof e.View||n===e.View?n:t.isFunction(n)?n.call(this,i):void 0},_getChildViewOptions:function(e){return t.isFunction(this.childViewOptions)?this.childViewOptions(e):this.childViewOptions},buildChildView:function(e,n,i){var r=t.extend({model:e},i);return new n(r)},_setupChildView:function(e){b(e),e.on("destroy",this.removeChildView,this),this._proxyChildViewEvents(e)},_getImmediateChildren:function(){return this.children._views},setElement:function(){return e.View.prototype.setElement.apply(this,arguments),this._isAttached=H(this.el),this},render:function(){return this._isDestroyed?this:(this.triggerMethod("before:render",this),this._destroyChildren(),this.children._init(),this.collection&&this._addChildModels(this.collection.models),this._showChildren(),this._isRendered=!0,this.triggerMethod("render",this),this)},sort:function(){return this._isDestroyed?this:this.children.length?(this._showChildren(),this):this},_showChildren:function(){return this.isEmpty()?void this._showEmptyView():(this._sortChildren(),void this.filter())},isEmpty:function(e){return e||!this.children.length},_showEmptyView:function(){var e=this._getEmptyView();if(e){var t=this._getEmptyViewOptions(),n=this.getEmptyRegion();n.show(new e(t))}},_getEmptyView:function(){var e=this.emptyView;if(e)return this._getView(e)},_destroyEmptyView:function(){var e=this.getEmptyRegion();e.hasView()&&e.empty()},_getEmptyViewOptions:function(){var e=this.emptyViewOptions||this.childViewOptions;return t.isFunction(e)?e.call(this):e},_sortChildren:function(){var e=this.getComparator();e&&(delete this._addedViews,this.triggerMethod("before:sort",this),this.children._sort(e,this),this.triggerMethod("sort",this))},setComparator:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.preventRender,i=this.viewComparator!==e,r=i&&!n;return this.viewComparator=e,r&&this.sort(),this},removeComparator:function(e){return this.setComparator(null,e)},getComparator:function(){return this.viewComparator?this.viewComparator:this.sortWithCollection&&this.viewComparator!==!1&&this.collection?this._viewComparator:!1},_viewComparator:function(e){return this.collection.indexOf(e.model)},filter:function(){if(this._isDestroyed)return this;if(!this.children.length)return this;var e=this._filterChildren();return this._renderChildren(e),this},_filterChildren:function(){var e=this,n=this._getFilter(),i=this._addedViews;if(delete this._addedViews,!n)return i?i:this.children._views;this.triggerMethod("before:filter",this);var r=[],o=[];return t.each(this.children._views,function(t,i,s){(n.call(e,t,i,s)?r:o).push(t)}),this._detachChildren(o),this.triggerMethod("filter",this,r,o),r},_getFilter:function(){var e=this.getFilter();if(!e)return!1;if(t.isFunction(e))return e;if(t.isObject(e)){var n=t.matches(e);return function(e){return n(e.model&&e.model.attributes)}}if(t.isString(e))return function(t){return t.model&&t.model.get(e)};throw new J({name:"InvalidViewFilterError",message:'"viewFilter" must be a function, predicate object literal, a string indicating a model attribute, or falsy'})},getFilter:function(){return this.viewFilter},setFilter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.preventRender,i=this.viewFilter!==e,r=i&&!n;return this.viewFilter=e,r&&this.filter(),this},removeFilter:function(e){return this.setFilter(null,e)},_detachChildren:function(e){t.each(e,t.bind(this._detachChildView,this))},_detachChildView:function(e){var t=e._isAttached&&this.monitorViewEvents!==!1;t&&o(e,"before:detach",e),this.detachHtml(e),t&&(e._isAttached=!1,o(e,"detach",e))},detachHtml:function(e){this.Dom.detachEl(e.el,e.$el)},_renderChildren:function(e){if(this.isEmpty(!e.length))return void this._showEmptyView();this._destroyEmptyView(),this.triggerMethod("before:render:children",this,e);var t=this._getBuffer(e);this._attachChildren(t,e),this.triggerMethod("render:children",this,e)},_attachChildren:function(e,n){var i=this._isAttached&&this.monitorViewEvents!==!1;n=i?n:[],t.each(n,function(e){e._isAttached||o(e,"before:attach",e)}),this.attachHtml(e),t.each(n,function(e){e._isAttached||(e._isAttached=!0,o(e,"attach",e))})},_getBuffer:function(e){var n=this,i=this.Dom.createBuffer();return t.each(e,function(e){N(e),n.Dom.appendContents(i,e.el,{_$contents:e.$el})}),i},attachHtml:function(e){this.Dom.appendContents(this.el,e,{_$el:this.$el})},swapChildViews:function(e,t){if(!this.children.hasView(e)||!this.children.hasView(t))throw new J({name:"ChildSwapError",message:"Both views must be children of the collection view"});return this.children._swap(e,t),this.Dom.swapEl(e.el,t.el),this.Dom.hasEl(this.el,e.el)!==this.Dom.hasEl(this.el,t.el)&&this.filter(),this},addChildView:function(e,t){return!e||e._isDestroyed?e:((!t||t>=this.children.length)&&(this._addedViews=[e]),this._addChild(e,t),this._showChildren(),e)},detachChildView:function(e){return this.removeChildView(e,{shouldDetach:!0}),e},removeChildView:function(e,t){return e?(this._removeChildView(e,t),this._removeChild(e),this.isEmpty()&&this._showEmptyView(),e):e},_removeChildViews:function(e){t.each(e,t.bind(this._removeChildView,this))},_removeChildView:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.shouldDetach;e.off("destroy",this.removeChildView,this),n?this._detachChildView(e):this._destroyChildView(e),this.stopListening(e)},_destroyChildView:function(e){e._isDestroyed||(e._shouldDisableEvents=this.monitorViewEvents===!1,j(e))},_removeChildren:function(){this._destroyChildren();var e=this.getEmptyRegion();e.destroy(),delete this._addedViews},_destroyChildren:function(){this.children&&this.children.length&&(this.triggerMethod("before:destroy:children",this),this.monitorViewEvents===!1&&this.Dom.detachContents(this.el,this.$el),t.each(this.children._views,t.bind(this._removeChildView,this)),this.triggerMethod("destroy:children",this))}},{setDomApi:D});t.extend(Ve.prototype,ge);var Pe=["childViewContainer","template","templateContext"],De=Me.extend({constructor:function(e){z("CompositeView is deprecated. Convert to View at your earliest convenience"),this.mergeOptions(e,Pe),Me.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"update",this._onCollectionUpdate),this.listenTo(this.collection,"reset",this.renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_getChildView:function(e){var t=this.childView;if(!t)return this.constructor;if(t=this._getView(t,e),!t)throw new J({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'});return t},serializeData:function(){return this.serializeModel()},render:function(){return this._isDestroyed?this:(this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.renderChildren(),this._isRendering=!1,this._isRendered=!0,this.triggerMethod("render",this),this)},renderChildren:function(){(this._isRendered||this._isRendering)&&Me.prototype._renderChildren.call(this)},attachBuffer:function(e,t){var n=this.getChildViewContainer(e);this.Dom.appendContents(n[0],t,{_$el:n})},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);this.Dom.appendContents(t[0],e.el,{_$el:t,_$contents:e.$el})},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);this.Dom.appendContents(t[0],e,{_$el:t})},getChildViewContainer:function(e,n){if(e.$childViewContainer)return e.$childViewContainer;var i=void 0,r=e.childViewContainer;if(r){var o=t.result(e,"childViewContainer");if(i="@"===o.charAt(0)&&e.ui?e.ui[o.substr(4)]:this.$(o),i.length<=0)throw new J({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else i=e.$el;return e.$childViewContainer=i,i},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),Ne=t.pick(Ce.prototype,"serializeModel","getTemplate","_renderTemplate","_renderHtml","mixinTemplateContext","attachElContent");t.extend(De.prototype,Ne);var je=["collectionEvents","events","modelEvents","triggers","ui"],Oe=ne.extend({cidPrefix:"mnb",constructor:function(e,n){this.view=n,this.defaults&&z("Behavior defaults are deprecated. For similar functionality set options on the Behavior class."),this.defaults=t.clone(t.result(this,"defaults",{})),this._setOptions(t.extend({},this.defaults,e)),this.mergeOptions(this.options,je),this.ui=t.extend({},t.result(this,"ui"),t.result(n,"ui")),ne.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this.view._removeBehavior(this),this},proxyViewProperties:function(){return this.$el=this.view.$el,this.el=this.view.el,this},bindUIElements:function(){return this._bindUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this},getUI:function(e){return this._getUI(e)},delegateEntityEvents:function(){return this._delegateEntityEvents(this.view.model,this.view.collection),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.view.model,this.view.collection),this},getEvents:function(){var e=this,n=this.normalizeUIKeys(t.result(this,"events"));return t.reduce(n,function(n,i,r){return t.isFunction(i)||(i=e[i]),i?(r=le(r,e.cid),n[r]=t.bind(i,e),n):n},{})},getTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(t.result(this,"triggers"));return this._getViewTriggers(this.view,e)}}});t.extend(Oe.prototype,se,ce,pe);var Ie=["region","regionClass"],Fe=ne.extend({cidPrefix:"mna",constructor:function(e){this._setOptions(e),this.mergeOptions(e,Ie),this._initRegion(),ne.prototype.constructor.apply(this,arguments)},regionClass:ye,_initRegion:function(){var e=this.region;if(e){var t={regionClass:this.regionClass};this._region=be(e,t)}},getRegion:function(){return this._region},showView:function(e){for(var t=this.getRegion(),n=arguments.length,i=Array(n>1?n-1:0),r=1;n>r;r++)i[r-1]=arguments[r];return t.show.apply(t,[e].concat(i))},getView:function(){return this.getRegion().currentView},start:function(e){return this.triggerMethod("before:start",this,e),this.triggerMethod("start",this,e),this}}),Be=["appRoutes","controller"],qe=e.Router.extend({constructor:function(t){this._setOptions(t),this.mergeOptions(t,Be),e.Router.apply(this,arguments);var n=this.appRoutes,i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var n=this._getController();return this._addAppRoute(n,e,t),this},_processOnRoute:function(e,n){if(t.isFunction(this.onRoute)){var i=t.invert(this.appRoutes)[e];this.onRoute(e,i,n)}},processAppRoutes:function(e,n){var i=this;if(!n)return this;var r=t.keys(n).reverse();return t.each(r,function(t){i._addAppRoute(e,t,n[t])}),this},_getController:function(){return this.controller},_addAppRoute:function(e,n,i){var r=e[i];if(!r)throw new J('Method "'+i+'" was not found on the controller');this.route(n,i,t.bind(r,e))},triggerMethod:r});t.extend(qe.prototype,Z);var $e=e.Marionette,Le=e.Marionette={};return Le.noConflict=function(){return e.Marionette=$e,this},Le.bindEvents=$(_),Le.unbindEvents=$(C),Le.bindRequests=$(E),Le.unbindRequests=$(T),Le.mergeOptions=$(W),Le.getOption=$(U),Le.normalizeMethods=$(X),Le.extend=L,Le.isNodeAttached=H,Le.deprecate=z,Le.triggerMethod=$(r),Le.triggerMethodOn=o,Le.isEnabled=R,Le.setEnabled=A,Le.monitorViewEvents=b,Le.Behaviors={},Le.Behaviors.behaviorsLookup=B,Le.Application=Fe,Le.AppRouter=qe,Le.Renderer=xe,Le.TemplateCache=ie,Le.View=Ce,Le.CollectionView=Me,Le.NextCollectionView=Ve,Le.CompositeView=De,Le.Behavior=Oe,Le.Region=ye,Le.Error=J,Le.Object=ne,Le.DEV_MODE=!1,Le.FEATURES=ue,Le.VERSION=q,Le.DomApi=me,Le.setDomApi=function(e){Me.setDomApi(e),De.setDomApi(e),Ve.setDomApi(e),ye.setDomApi(e),Ce.setDomApi(e)},Le}),this&&this.Marionette&&(this.Mn=this.Marionette),function(){function e(e,t,n){n=u;var i="__p+='"+e.replace(f,function(e){return"\\"+h[e]}).replace(n.escape||c,function(e,t){return"'+_.escape("+m(t)+")+'"}).replace(n.interpolate||c,function(e,t){return"'+("+m(t)+")+'"}).replace(n.evaluate||c,function(e,t){return"';"+m(t)+";__p+='"})+"';";n.variable||(i="with(obj||{}){"+i+"}"),i="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};"+i+"return __p;";var r=new Function(n.variable||"obj","_",i);if(t)return r(t,_);var o=function(e){return r.call(this,e,_)};return o.source="function("+(n.variable||"obj")+"){"+i+"}",o}var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r="undefined"!=typeof location&&location.href,o=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,a=r&&(location.port||void 0),l=[],u={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},c=/.^/,h={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var d in h)h[h[d]]=d;var f=/\\|'|\r|\n|\t|\u2028|\u2029/g,p=/\\(\\|'|r|n|t|u2028|u2029)/g,m=function(e){return e.replace(p,function(e,t){return h[t]})};define("tpl",[],function(){var u,c,h;return"undefined"!=typeof window&&window.navigator&&window.document?c=function(e,t){var n=u.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){4===n.readyState&&t(n.responseText)},n.send(null)}:"undefined"!=typeof process&&process.versions&&process.versions.node?(h=require.nodeRequire("fs"),c=function(e,t){t(h.readFileSync(e,"utf8"))}):"undefined"!=typeof Packages&&(c=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),l="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=a.readLine());)n.append(s),n.append(i);l=String(n.toString())}finally{a.close()}t(l)}),u={version:"1.0.0",strip:function(e){if(e){e=e.replace(n,"");var t=e.match(i);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var e,n,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(n=0;3>n;n++){i=t[n];try{e=new ActiveXObject(i)}catch(r){}if(e){t=[i];break}}if(!e)throw new Error("createXhr(): XMLHttpRequest not available");return e},get:c,parseName:function(e){var t=!1,n=e.indexOf("."),i=e.substring(0,n),r=e.substring(n+1,e.length);return n=r.indexOf("!"),-1!==n&&(t=r.substring(n+1,r.length),t="strip"===t,r=r.substring(0,n)),{moduleName:i,ext:r,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,i){var r,o,s,a=u.xdRegExp.exec(e);return a?(r=a[2],o=a[3],o=o.split(":"),s=o[1],o=o[0],!(r&&r!==t||o&&o!==n||(s||o)&&s!==i)):!0},finishLoad:function(t,n,i,r,o){i=n?u.strip(i):i;var s=e(i),a=s.source;o.isBuild&&o.inlineText&&(l[t]=a),r(s)},load:function(e,t,n,i){var l=u.parseName(e),c=l.moduleName+"."+l.ext,h=t.toUrl(c),d=i&&i.text&&i.text.useXhr||u.useXhr;!r||d(h,o,s,a)?u.get(h,function(t){u.finishLoad(e,l.strip,t,n,i)}):t([c],function(e){u.finishLoad(l.moduleName+"."+l.ext,l.strip,e,n,i)})},write:function(e,t,n,i){if(t in l){var r=l[t];n('define("'+e+"!"+t+'", function() { return '+r+"; });\n")}},writeFile:function(e,t,n,i,r){var o=u.parseName(t),s=o.moduleName+"."+o.ext,a=n.toUrl(o.moduleName+"."+o.ext)+".js";u.load(s,n,function(t){var n=function(e){return i(a,e)};n.asModule=function(e,t){return i.asModule(e,a,t)},u.write(e,s,n,r)},r)}}})}(),define("tpl!templates/header.html",function(){return function(obj){var __p="";with(obj||{})__p+='                <div class="navbar-main">\n                    <ul>\n                        <li>\n                        	<a href="#status">\n                        		<i class="icon-power"></i>\n                        		<span class="title">Status</span>\n                        	</a>\n                        </li>\n                        <li>\n                        	<a href="#element">\n                        		<i class="icon-spectrum"></i>\n                        		<span class="title">Elements</span>\n                    		</a>\n                        </li>\n                        <li>\n                        	<a href="#abs">\n                        		<i class="icon-benzene"></i>\n                        		<span class="title">Absorption</span>\n                        	</a>\n                        </li>\n                        <li>\n                        	<a href="#ion">\n                        		<i class="icon-ion"></i>\n                        		<span class="title">Chamber</span>\n                        	</a>\n                        </li>\n                        <li>\n                        	<a href="#about">\n                        		<i class="icon-info"></i>\n                        		<span class="title">About</span>\n                        	</a>\n                        </li>\n                    </ul>\n                </div>';return __p}}),define("views/header",["backbone.marionette","tpl!templates/header.html"],function(e,t){return e.View.extend({tagName:"nav",className:"navbar",template:t})}),define("tpl!templates/main.html",function(){return function(obj){var __p="";with(obj||{})__p+='\n        <section class="install-banner">\n            <button name="dismiss" class="small-pad">x</button>\n            <span class="icon icon-left">\n                <img src="assets/images/ios/home.png" />\n            </span>\n            Install this app by clicking the share icon \n            <span class="icon icon-small">\n                <img src="assets/images/ios/share.png" />\n            </span>\n            and then "Add to Home Screen"\n        </section>\n\n        <section class="content" role="main">\n            <div class="page-content">\n                <div class="loader"></div>\n            </div>\n        </section>\n\n        <header class="page-header"></header>\n';return __p}}),define("views/main",["backbone.marionette","views/header","tpl!templates/main.html"],function(e,t,n){return e.View.extend({className:"wrapper",template:n,regions:{header:".page-header",content:".page-content"},ui:{banner:".install-banner"},events:{"click button[name=dismiss]":"hideBanner"},onRender:function(){this.getRegion("header").show(new t),this.isIos()&&!this.isInStandaloneMode()&&this.ui.banner.addClass("show")},isIos:function(){const e=window.navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(e)},isInStandaloneMode:function(){return"standalone"in window.navigator&&window.navigator.standalone},hideBanner:function(){this.ui.banner.removeClass("show")}})}),define("utils/kvcollection",[],function(){return{opts:function(){return this.map(function(e){return'<option value="'+e.get(this.valueAttribute)+'">'+e.get(this.keyAttribute)+"</option>"},this)},kv:function(){var e={};return this.each(function(t){e[t.get(this.valueAttribute)]=t.get(this.keyAttribute)},this),e}}}),define("collections/statuses",["backbone","utils/kvcollection"],function(e,t){return e.Collection.extend(_.extend({},t,{keyAttribute:"facility",valueAttribute:"facility",comparator:"facility"}))}),define("tpl!templates/statuses.html",function(){return function(obj){var __p="";with(obj||{})__p+='<select name="facility"></select>\n<div class="image-holder">\n	<img class="status" alt="Facility Status" />\n</div>\n';return __p}}),define("views/status",["backbone.marionette","collections/statuses","json!tables/statuses.json","tpl!templates/statuses.html"],function(e,t,n,i){return e.View.extend({className:"page-panel",template:i,ui:{fac:"select[name=facility]",img:"img.status"},events:{"change @ui.fac":"updateFacility"},updateFacility:function(){var e=this.statuses.findWhere({facility:this.ui.fac.val()});if(e){console.log("loading image"),this.ui.img.removeClass("show");var t=this;setTimeout(function(){t.ui.img.attr("src",e.get("status"))},500)}},showFacility:function(){console.log("image loaded");var e=this;setTimeout(function(){e.ui.img.addClass("show")},100)},populateFacilites:function(){this.ui.fac.html(this.statuses.opts())},initialize:function(e){this.statuses=new t(n)},onRender:function(){this.ui.img[0].onload=this.showFacility.bind(this),this.populateFacilites(),this.updateFacility()}})}),define("tpl!templates/elementlist.html",function(){return function(obj){var __p="";with(obj||{})__p+='<div class="search">\n	<input type="text" name="search" placeholder="Name / Energy (keV)" />\n</div>\n\n\n<div class="elements"></div>\n\n<div class="periodic-table"></div>';return __p}}),define("views/elementlist",["backbone.marionette","tpl!templates/elementlist.html"],function(e,t){var n=e.View.extend({className:function(){return"element"+(this.model.get("edges").length?"":" no-edges")},template:_.template('<h2><%-name%></h2><span class="number"><%-number%></span><span class="symbol"><%-symbol%></span>'),events:{click:"gotoElement"},gotoElement:function(e){e.preventDefault(),app.trigger("show:element",this.model.get("symbol"))}}),i=e.CollectionView.extend({className:"elements",childView:n}),r=e.View.extend({template:_.template('<span class="number"><%-number%></span><h2><%-symbol%></h2><p><%-name%>'),className:function(){return"periodic-element period-"+this.model.get("period")+(this.model.get("isSelected")?" selected":"")+(this.model.get("edges").length?"":" no-edges");
},events:{click:"gotoElement"},gotoElement:function(e){e.preventDefault(),app.trigger("show:element",this.model.get("symbol"))}}),o=e.View.extend({className:"item",template:_.template('<div class="el"></div>'),regions:{el:{el:".el",replaceElement:!0}},onRender:function(){this.listenTo(this.getOption("elements"),"reset change",this.renderModel),this.renderModel()},renderModel:function(){var e=this.model.get("id")>144?-1:0,t=this.getOption("elements").findWhere({xpos:this.model.get("id")%18+1+e,ypos:parseInt(this.model.get("id")/18)+1});t?this.getRegion("el").show(new r({model:t})):this.getRegion("el").empty()}}),s=e.CollectionView.extend({className:"periodic-table",childView:o,onRender:function(){this.listenTo(this.childViewOptions.elements,"reset",this.checkFiltered)},checkFiltered:function(){console.log("check filter"),this.childViewOptions.elements.where({isSelected:!0}).length?this.$el.addClass("filtered"):this.$el.removeClass("filtered")}}),a=function(e,t){var n=new e.constructor;return n._callbacks={},n._currentFilter=t,n.filterItems=function(t){var i=e.filter(t);return n.reset(i),n},e.on("reset change destroy",function(){return n.filterItems(n._currentFilter)}),n.filterItems(t)};return e.View.extend({className:"page-panel",template:t,regions:{elements:{el:".elements",replaceElement:!0},pt:{el:".periodic-table",replaceElement:!0}},ui:{search:"input[name=search]"},events:{"keyup @ui.search":"filterList"},initialize:function(e){this.filterList=_.debounce(this.filterList.bind(this),100);var t=[];_.each(_.range(180),function(e){t.push({id:e})}),this.perioditems=new Backbone.Collection(t),this.listenTo(app,"window:resize",this.resize)},filterList:function(e){console.log("filter list"),this.collection.each(function(e){e.set({isSelected:this.filter(e)},{silent:!0})},this),this.collection.trigger("reset")},filter:function(e){var t=this.ui.search.val();if(!t)return!0;if(isNaN(t))return e.get("name").toLowerCase().startsWith(t.toLowerCase());var t=parseFloat(t),n=.1*t,i=!1;return e.get("lines").each(function(e){e.get("energy")>t-n&&e.get("energy")<t+n&&(i=!0)}),i},onRender:function(){this.filtered=a(this.collection,this.filter.bind(this)),this.resize()},onDomRefresh:function(){this.ui.search.focus()},resize:function(){console.log("resize",app.mobile()),app.mobile()?(this.getRegion("elements").show(new i({collection:this.filtered})),this.getRegion("pt").empty()):(this.getRegion("elements").empty(),this.getRegion("pt").show(new s({collection:this.perioditems,childViewOptions:{elements:this.collection}})))}})}),function(e){e.color={},e.color.make=function(t,n,i,r){var o={};return o.r=t||0,o.g=n||0,o.b=i||0,o.a=null!=r?r:1,o.add=function(e,t){for(var n=0;n<e.length;++n)o[e.charAt(n)]+=t;return o.normalize()},o.scale=function(e,t){for(var n=0;n<e.length;++n)o[e.charAt(n)]*=t;return o.normalize()},o.toString=function(){return o.a>=1?"rgb("+[o.r,o.g,o.b].join(",")+")":"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"},o.normalize=function(){function e(e,t,n){return e>t?e:t>n?n:t}return o.r=e(0,parseInt(o.r),255),o.g=e(0,parseInt(o.g),255),o.b=e(0,parseInt(o.b),255),o.a=e(0,o.a,1),o},o.clone=function(){return e.color.make(o.r,o.b,o.g,o.a)},o.normalize()},e.color.extract=function(t,n){var i;do{if(i=t.css(n).toLowerCase(),""!=i&&"transparent"!=i)break;t=t.parent()}while(t.length&&!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==i&&(i="transparent"),e.color.parse(i)},e.color.parse=function(n){var i,r=e.color.make;if(i=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return r(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10));if(i=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return r(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10),parseFloat(i[4]));if(i=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return r(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]));if(i=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return r(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]),parseFloat(i[4]));if(i=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return r(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16));if(i=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return r(parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16));var o=e.trim(n).toLowerCase();return"transparent"==o?r(255,255,255,0):(i=t[o]||[0,0,0],r(i[0],i[1],i[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function t(t,n){var i=n.children("."+t)[0];if(null==i&&(i=document.createElement("canvas"),i.className=t,e(i).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n),!i.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");i=window.G_vmlCanvasManager.initElement(i)}this.element=i;var r=this.context=i.getContext("2d"),o=window.devicePixelRatio||1,s=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;this.pixelRatio=o/s,this.resize(n.width(),n.height()),this.textContainer=null,this.text={},this._textCache={}}function n(n,r,o,s){function a(e,t){t=[ge].concat(t);for(var n=0;n<e.length;++n)e[n].apply(this,t)}function l(){for(var n={Canvas:t},i=0;i<s.length;++i){var r=s[i];r.init(ge,n),r.options&&e.extend(!0,re,r.options)}}function u(t){e.extend(!0,re,t),t&&t.colors&&(re.colors=t.colors),null==re.xaxis.color&&(re.xaxis.color=e.color.parse(re.grid.color).scale("a",.22).toString()),null==re.yaxis.color&&(re.yaxis.color=e.color.parse(re.grid.color).scale("a",.22).toString()),null==re.xaxis.tickColor&&(re.xaxis.tickColor=re.grid.tickColor||re.xaxis.color),null==re.yaxis.tickColor&&(re.yaxis.tickColor=re.grid.tickColor||re.yaxis.color),null==re.grid.borderColor&&(re.grid.borderColor=re.grid.color),null==re.grid.tickColor&&(re.grid.tickColor=e.color.parse(re.grid.color).scale("a",.22).toString());var i,r,o,s=n.css("font-size"),l=s?+s.replace("px",""):13,u={style:n.css("font-style"),size:Math.round(.8*l),variant:n.css("font-variant"),weight:n.css("font-weight"),family:n.css("font-family")};for(o=re.xaxes.length||1,i=0;o>i;++i)r=re.xaxes[i],r&&!r.tickColor&&(r.tickColor=r.color),r=e.extend(!0,{},re.xaxis,r),re.xaxes[i]=r,r.font&&(r.font=e.extend({},u,r.font),r.font.color||(r.font.color=r.color),r.font.lineHeight||(r.font.lineHeight=Math.round(1.15*r.font.size)));for(o=re.yaxes.length||1,i=0;o>i;++i)r=re.yaxes[i],r&&!r.tickColor&&(r.tickColor=r.color),r=e.extend(!0,{},re.yaxis,r),re.yaxes[i]=r,r.font&&(r.font=e.extend({},u,r.font),r.font.color||(r.font.color=r.color),r.font.lineHeight||(r.font.lineHeight=Math.round(1.15*r.font.size)));for(re.xaxis.noTicks&&null==re.xaxis.ticks&&(re.xaxis.ticks=re.xaxis.noTicks),re.yaxis.noTicks&&null==re.yaxis.ticks&&(re.yaxis.ticks=re.yaxis.noTicks),re.x2axis&&(re.xaxes[1]=e.extend(!0,{},re.xaxis,re.x2axis),re.xaxes[1].position="top",null==re.x2axis.min&&(re.xaxes[1].min=null),null==re.x2axis.max&&(re.xaxes[1].max=null)),re.y2axis&&(re.yaxes[1]=e.extend(!0,{},re.yaxis,re.y2axis),re.yaxes[1].position="right",null==re.y2axis.min&&(re.yaxes[1].min=null),null==re.y2axis.max&&(re.yaxes[1].max=null)),re.grid.coloredAreas&&(re.grid.markings=re.grid.coloredAreas),re.grid.coloredAreasColor&&(re.grid.markingsColor=re.grid.coloredAreasColor),re.lines&&e.extend(!0,re.series.lines,re.lines),re.points&&e.extend(!0,re.series.points,re.points),re.bars&&e.extend(!0,re.series.bars,re.bars),null!=re.shadowSize&&(re.series.shadowSize=re.shadowSize),null!=re.highlightColor&&(re.series.highlightColor=re.highlightColor),i=0;i<re.xaxes.length;++i)g(ce,i+1).options=re.xaxes[i];for(i=0;i<re.yaxes.length;++i)g(he,i+1).options=re.yaxes[i];for(var c in me)re.hooks[c]&&re.hooks[c].length&&(me[c]=me[c].concat(re.hooks[c]));a(me.processOptions,[re])}function c(e){ie=h(e),v(),y()}function h(t){for(var n=[],i=0;i<t.length;++i){var r=e.extend(!0,{},re.series);null!=t[i].data?(r.data=t[i].data,delete t[i].data,e.extend(!0,r,t[i]),t[i].data=r.data):r.data=t[i],n.push(r)}return n}function d(e,t){var n=e[t+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function f(){return e.grep(ce.concat(he),function(e){return e})}function p(e){var t,n,i={};for(t=0;t<ce.length;++t)n=ce[t],n&&n.used&&(i["x"+n.n]=n.c2p(e.left));for(t=0;t<he.length;++t)n=he[t],n&&n.used&&(i["y"+n.n]=n.c2p(e.top));return void 0!==i.x1&&(i.x=i.x1),void 0!==i.y1&&(i.y=i.y1),i}function m(e){var t,n,i,r={};for(t=0;t<ce.length;++t)if(n=ce[t],n&&n.used&&(i="x"+n.n,null==e[i]&&1==n.n&&(i="x"),null!=e[i])){r.left=n.p2c(e[i]);break}for(t=0;t<he.length;++t)if(n=he[t],n&&n.used&&(i="y"+n.n,null==e[i]&&1==n.n&&(i="y"),null!=e[i])){r.top=n.p2c(e[i]);break}return r}function g(t,n){return t[n-1]||(t[n-1]={n:n,direction:t==ce?"x":"y",options:e.extend(!0,{},t==ce?re.xaxis:re.yaxis)}),t[n-1]}function v(){var t,n=ie.length,i=-1;for(t=0;t<ie.length;++t){var r=ie[t].color;null!=r&&(n--,"number"==typeof r&&r>i&&(i=r))}i>=n&&(n=i+1);var o,s=[],a=re.colors,l=a.length,u=0;for(t=0;n>t;t++)o=e.color.parse(a[t%l]||"#666"),t%l==0&&t&&(u=u>=0?.5>u?-u-.2:0:-u),s[t]=o.scale("rgb",1+u);var c,h=0;for(t=0;t<ie.length;++t){if(c=ie[t],null==c.color?(c.color=s[h].toString(),++h):"number"==typeof c.color&&(c.color=s[c.color].toString()),null==c.lines.show){var f,p=!0;for(f in c)if(c[f]&&c[f].show){p=!1;break}p&&(c.lines.show=!0)}null==c.lines.zero&&(c.lines.zero=!!c.lines.fill),c.xaxis=g(ce,d(c,"x")),c.yaxis=g(he,d(c,"y"))}}function y(){function t(e,t,n){t<e.datamin&&t!=-y&&(e.datamin=t),n>e.datamax&&n!=y&&(e.datamax=n)}var n,i,r,o,s,l,u,c,h,d,p,m,g=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,y=Number.MAX_VALUE;for(e.each(f(),function(e,t){t.datamin=g,t.datamax=v,t.used=!1}),n=0;n<ie.length;++n)s=ie[n],s.datapoints={points:[]},a(me.processRawData,[s,s.data,s.datapoints]);for(n=0;n<ie.length;++n){if(s=ie[n],p=s.data,m=s.datapoints.format,!m){if(m=[],m.push({x:!0,number:!0,required:!0}),m.push({y:!0,number:!0,required:!0}),s.bars.show||s.lines.show&&s.lines.fill){var b=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);m.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:b}),s.bars.horizontal&&(delete m[m.length-1].y,m[m.length-1].x=!0)}s.datapoints.format=m}if(null==s.datapoints.pointsize){s.datapoints.pointsize=m.length,u=s.datapoints.pointsize,l=s.datapoints.points;var w=s.lines.show&&s.lines.steps;for(s.xaxis.used=s.yaxis.used=!0,i=r=0;i<p.length;++i,r+=u){d=p[i];var x=null==d;if(!x)for(o=0;u>o;++o)c=d[o],h=m[o],h&&(h.number&&null!=c&&(c=+c,isNaN(c)?c=null:c==1/0?c=y:c==-(1/0)&&(c=-y)),null==c&&(h.required&&(x=!0),null!=h.defaultValue&&(c=h.defaultValue))),l[r+o]=c;if(x)for(o=0;u>o;++o)c=l[r+o],null!=c&&(h=m[o],h.autoscale!==!1&&(h.x&&t(s.xaxis,c,c),h.y&&t(s.yaxis,c,c))),l[r+o]=null;else if(w&&r>0&&null!=l[r-u]&&l[r-u]!=l[r]&&l[r-u+1]!=l[r+1]){for(o=0;u>o;++o)l[r+u+o]=l[r+o];l[r+1]=l[r-u+1],r+=u}}}}for(n=0;n<ie.length;++n)s=ie[n],a(me.processDatapoints,[s,s.datapoints]);for(n=0;n<ie.length;++n){s=ie[n],l=s.datapoints.points,u=s.datapoints.pointsize,m=s.datapoints.format;var _=g,C=g,k=v,E=v;for(i=0;i<l.length;i+=u)if(null!=l[i])for(o=0;u>o;++o)c=l[i+o],h=m[o],h&&h.autoscale!==!1&&c!=y&&c!=-y&&(h.x&&(_>c&&(_=c),c>k&&(k=c)),h.y&&(C>c&&(C=c),c>E&&(E=c)));if(s.bars.show){var T;switch(s.bars.align){case"left":T=0;break;case"right":T=-s.bars.barWidth;break;default:T=-s.bars.barWidth/2}s.bars.horizontal?(C+=T,E+=T+s.bars.barWidth):(_+=T,k+=T+s.bars.barWidth)}t(s.xaxis,_,k),t(s.yaxis,C,E)}e.each(f(),function(e,t){t.datamin==g&&(t.datamin=null),t.datamax==v&&(t.datamax=null)})}function b(){n.css("padding",0).children().filter(function(){return!e(this).hasClass("flot-overlay")&&!e(this).hasClass("flot-base")}).remove(),"static"==n.css("position")&&n.css("position","relative"),oe=new t("flot-base",n),se=new t("flot-overlay",n),le=oe.context,ue=se.context,ae=e(se.element).unbind();var i=n.data("plot");i&&(i.shutdown(),se.clear()),n.data("plot",ge)}function w(){re.grid.hoverable&&(ae.mousemove(W),ae.bind("mouseleave",U)),re.grid.clickable&&ae.click(X),a(me.bindEvents,[ae])}function x(){ye&&clearTimeout(ye),ae.unbind("mousemove",W),ae.unbind("mouseleave",U),ae.unbind("click",X),a(me.shutdown,[ae])}function _(e){function t(e){return e}var n,i,r=e.options.transform||t,o=e.options.inverseTransform;"x"==e.direction?(n=e.scale=fe/Math.abs(r(e.max)-r(e.min)),i=Math.min(r(e.max),r(e.min))):(n=e.scale=pe/Math.abs(r(e.max)-r(e.min)),n=-n,i=Math.max(r(e.max),r(e.min))),r==t?e.p2c=function(e){return(e-i)*n}:e.p2c=function(e){return(r(e)-i)*n},o?e.c2p=function(e){return o(i+e/n)}:e.c2p=function(e){return i+e/n}}function C(e){for(var t=e.options,n=e.ticks||[],i=t.labelWidth||0,r=t.labelHeight||0,o=i||("x"==e.direction?Math.floor(oe.width/(n.length||1)):null),s=e.direction+"Axis "+e.direction+e.n+"Axis",a="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+s,l=t.font||"flot-tick-label tickLabel",u=0;u<n.length;++u){var c=n[u];if(c.label){var h=oe.getTextInfo(a,c.label,l,null,o);i=Math.max(i,h.width),r=Math.max(r,h.height)}}e.labelWidth=t.labelWidth||i,e.labelHeight=t.labelHeight||r}function k(t){var n=t.labelWidth,i=t.labelHeight,r=t.options.position,o="x"===t.direction,s=t.options.tickLength,a=re.grid.axisMargin,l=re.grid.labelMargin,u=!0,c=!0,h=!0,d=!1;e.each(o?ce:he,function(e,n){n&&(n.show||n.reserveSpace)&&(n===t?d=!0:n.options.position===r&&(d?c=!1:u=!1),d||(h=!1))}),c&&(a=0),null==s&&(s=h?"full":5),isNaN(+s)||(l+=+s),o?(i+=l,"bottom"==r?(de.bottom+=i+a,t.box={top:oe.height-de.bottom,height:i}):(t.box={top:de.top+a,height:i},de.top+=i+a)):(n+=l,"left"==r?(t.box={left:de.left+a,width:n},de.left+=n+a):(de.right+=n+a,t.box={left:oe.width-de.right,width:n})),t.position=r,t.tickLength=s,t.box.padding=l,t.innermost=u}function E(e){"x"==e.direction?(e.box.left=de.left-e.labelWidth/2,e.box.width=oe.width-de.left-de.right+e.labelWidth):(e.box.top=de.top-e.labelHeight/2,e.box.height=oe.height-de.bottom-de.top+e.labelHeight)}function T(){var t,n=re.grid.minBorderMargin;if(null==n)for(n=0,t=0;t<ie.length;++t)n=Math.max(n,2*(ie[t].points.radius+ie[t].points.lineWidth/2));var i={left:n,right:n,top:n,bottom:n};e.each(f(),function(e,t){t.reserveSpace&&t.ticks&&t.ticks.length&&("x"===t.direction?(i.left=Math.max(i.left,t.labelWidth/2),i.right=Math.max(i.right,t.labelWidth/2)):(i.bottom=Math.max(i.bottom,t.labelHeight/2),i.top=Math.max(i.top,t.labelHeight/2)))}),de.left=Math.ceil(Math.max(i.left,de.left)),de.right=Math.ceil(Math.max(i.right,de.right)),de.top=Math.ceil(Math.max(i.top,de.top)),de.bottom=Math.ceil(Math.max(i.bottom,de.bottom))}function S(){var t,n=f(),i=re.grid.show;for(var r in de){var o=re.grid.margin||0;de[r]="number"==typeof o?o:o[r]||0}a(me.processOffset,[de]);for(var r in de)"object"==typeof re.grid.borderWidth?de[r]+=i?re.grid.borderWidth[r]:0:de[r]+=i?re.grid.borderWidth:0;if(e.each(n,function(e,t){var n=t.options;t.show=null==n.show?t.used:n.show,t.reserveSpace=null==n.reserveSpace?t.show:n.reserveSpace,M(t)}),i){var s=e.grep(n,function(e){return e.show||e.reserveSpace});for(e.each(s,function(e,t){R(t),A(t),V(t,t.ticks),C(t)}),t=s.length-1;t>=0;--t)k(s[t]);T(),e.each(s,function(e,t){E(t)})}fe=oe.width-de.left-de.right,pe=oe.height-de.bottom-de.top,e.each(n,function(e,t){_(t)}),i&&O(),z()}function M(e){var t=e.options,n=+(null!=t.min?t.min:e.datamin),i=+(null!=t.max?t.max:e.datamax),r=i-n;if(0==r){var o=0==i?1:.01;null==t.min&&(n-=o),(null==t.max||null!=t.min)&&(i+=o)}else{var s=t.autoscaleMargin;null!=s&&(null==t.min&&(n-=r*s,0>n&&null!=e.datamin&&e.datamin>=0&&(n=0)),null==t.max&&(i+=r*s,i>0&&null!=e.datamax&&e.datamax<=0&&(i=0)))}e.min=n,e.max=i}function R(t){var n,r=t.options;n="number"==typeof r.ticks&&r.ticks>0?r.ticks:.3*Math.sqrt("x"==t.direction?oe.width:oe.height);var o=(t.max-t.min)/n,s=-Math.floor(Math.log(o)/Math.LN10),a=r.tickDecimals;null!=a&&s>a&&(s=a);var l,u=Math.pow(10,-s),c=o/u;if(1.5>c?l=1:3>c?(l=2,c>2.25&&(null==a||a>=s+1)&&(l=2.5,++s)):l=7.5>c?5:10,l*=u,null!=r.minTickSize&&l<r.minTickSize&&(l=r.minTickSize),t.delta=o,t.tickDecimals=Math.max(0,null!=a?a:s),t.tickSize=r.tickSize||l,"time"==r.mode&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(t.tickGenerator||(t.tickGenerator=function(e){var t,n=[],r=i(e.min,e.tickSize),o=0,s=Number.NaN;do t=s,s=r+o*e.tickSize,n.push(s),++o;while(s<e.max&&s!=t);return n},t.tickFormatter=function(e,t){var n=t.tickDecimals?Math.pow(10,t.tickDecimals):1,i=""+Math.round(e*n)/n;if(null!=t.tickDecimals){var r=i.indexOf("."),o=-1==r?0:i.length-r-1;if(o<t.tickDecimals)return(o?i:i+".")+(""+n).substr(1,t.tickDecimals-o)}return i}),e.isFunction(r.tickFormatter)&&(t.tickFormatter=function(e,t){return""+r.tickFormatter(e,t)}),null!=r.alignTicksWithAxis){var h=("x"==t.direction?ce:he)[r.alignTicksWithAxis-1];if(h&&h.used&&h!=t){var d=t.tickGenerator(t);if(d.length>0&&(null==r.min&&(t.min=Math.min(t.min,d[0])),null==r.max&&d.length>1&&(t.max=Math.max(t.max,d[d.length-1]))),t.tickGenerator=function(e){var t,n,i=[];for(n=0;n<h.ticks.length;++n)t=(h.ticks[n].v-h.min)/(h.max-h.min),t=e.min+t*(e.max-e.min),i.push(t);return i},!t.mode&&null==r.tickDecimals){var f=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),p=t.tickGenerator(t);p.length>1&&/\..*0$/.test((p[1]-p[0]).toFixed(f))||(t.tickDecimals=f)}}}}function A(t){var n=t.options.ticks,i=[];null==n||"number"==typeof n&&n>0?i=t.tickGenerator(t):n&&(i=e.isFunction(n)?n(t):n);var r,o;for(t.ticks=[],r=0;r<i.length;++r){var s=null,a=i[r];"object"==typeof a?(o=+a[0],a.length>1&&(s=a[1])):o=+a,null==s&&(s=t.tickFormatter(o,t)),isNaN(o)||t.ticks.push({v:o,label:s})}}function V(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function P(){oe.clear(),a(me.drawBackground,[le]);var e=re.grid;e.show&&e.backgroundColor&&N(),e.show&&!e.aboveData&&j();for(var t=0;t<ie.length;++t)a(me.drawSeries,[le,ie[t]]),I(ie[t]);a(me.draw,[le]),e.show&&e.aboveData&&j(),oe.render(),G()}function D(e,t){for(var n,i,r,o,s=f(),a=0;a<s.length;++a)if(n=s[a],n.direction==t&&(o=t+n.n+"axis",e[o]||1!=n.n||(o=t+"axis"),e[o])){i=e[o].from,r=e[o].to;break}if(e[o]||(n="x"==t?ce[0]:he[0],i=e[t+"1"],r=e[t+"2"]),null!=i&&null!=r&&i>r){var l=i;i=r,r=l}return{from:i,to:r,axis:n}}function N(){le.save(),le.translate(de.left,de.top),le.fillStyle=ne(re.grid.backgroundColor,pe,0,"rgba(255, 255, 255, 0)"),le.fillRect(0,0,fe,pe),le.restore()}function j(){var t,n,i,r;le.save(),le.translate(de.left,de.top);var o=re.grid.markings;if(o)for(e.isFunction(o)&&(n=ge.getAxes(),n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,o=o(n)),t=0;t<o.length;++t){var s=o[t],a=D(s,"x"),l=D(s,"y");if(null==a.from&&(a.from=a.axis.min),null==a.to&&(a.to=a.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),!(a.to<a.axis.min||a.from>a.axis.max||l.to<l.axis.min||l.from>l.axis.max)){a.from=Math.max(a.from,a.axis.min),a.to=Math.min(a.to,a.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max);var u=a.from===a.to,c=l.from===l.to;if(!u||!c)if(a.from=Math.floor(a.axis.p2c(a.from)),a.to=Math.floor(a.axis.p2c(a.to)),l.from=Math.floor(l.axis.p2c(l.from)),l.to=Math.floor(l.axis.p2c(l.to)),u||c){var h=s.lineWidth||re.grid.markingsLineWidth,d=h%2?.5:0;le.beginPath(),le.strokeStyle=s.color||re.grid.markingsColor,le.lineWidth=h,u?(le.moveTo(a.to+d,l.from),le.lineTo(a.to+d,l.to)):(le.moveTo(a.from,l.to+d),le.lineTo(a.to,l.to+d)),le.stroke()}else le.fillStyle=s.color||re.grid.markingsColor,le.fillRect(a.from,l.to,a.to-a.from,l.from-l.to)}}n=f(),i=re.grid.borderWidth;for(var p=0;p<n.length;++p){var m,g,v,y,b=n[p],w=b.box,x=b.tickLength;if(b.show&&0!=b.ticks.length){for(le.lineWidth=1,"x"==b.direction?(m=0,g="full"==x?"top"==b.position?0:pe:w.top-de.top+("top"==b.position?w.height:0)):(g=0,m="full"==x?"left"==b.position?0:fe:w.left-de.left+("left"==b.position?w.width:0)),b.innermost||(le.strokeStyle=b.options.color,le.beginPath(),v=y=0,"x"==b.direction?v=fe+1:y=pe+1,1==le.lineWidth&&("x"==b.direction?g=Math.floor(g)+.5:m=Math.floor(m)+.5),le.moveTo(m,g),le.lineTo(m+v,g+y),le.stroke()),le.strokeStyle=b.options.tickColor,le.beginPath(),t=0;t<b.ticks.length;++t){var _=b.ticks[t].v;v=y=0,isNaN(_)||_<b.min||_>b.max||"full"==x&&("object"==typeof i&&i[b.position]>0||i>0)&&(_==b.min||_==b.max)||("x"==b.direction?(m=b.p2c(_),y="full"==x?-pe:x,"top"==b.position&&(y=-y)):(g=b.p2c(_),v="full"==x?-fe:x,"left"==b.position&&(v=-v)),1==le.lineWidth&&("x"==b.direction?m=Math.floor(m)+.5:g=Math.floor(g)+.5),le.moveTo(m,g),le.lineTo(m+v,g+y))}le.stroke()}}i&&(r=re.grid.borderColor,"object"==typeof i||"object"==typeof r?("object"!=typeof i&&(i={top:i,right:i,bottom:i,left:i}),"object"!=typeof r&&(r={top:r,right:r,bottom:r,left:r}),i.top>0&&(le.strokeStyle=r.top,le.lineWidth=i.top,le.beginPath(),le.moveTo(0-i.left,0-i.top/2),le.lineTo(fe,0-i.top/2),le.stroke()),i.right>0&&(le.strokeStyle=r.right,le.lineWidth=i.right,le.beginPath(),le.moveTo(fe+i.right/2,0-i.top),le.lineTo(fe+i.right/2,pe),le.stroke()),i.bottom>0&&(le.strokeStyle=r.bottom,le.lineWidth=i.bottom,le.beginPath(),le.moveTo(fe+i.right,pe+i.bottom/2),le.lineTo(0,pe+i.bottom/2),le.stroke()),i.left>0&&(le.strokeStyle=r.left,le.lineWidth=i.left,le.beginPath(),le.moveTo(0-i.left/2,pe+i.bottom),le.lineTo(0-i.left/2,0),le.stroke())):(le.lineWidth=i,le.strokeStyle=re.grid.borderColor,le.strokeRect(-i/2,-i/2,fe+i,pe+i))),le.restore()}function O(){e.each(f(),function(e,t){var n,i,r,o,s,a=t.box,l=t.direction+"Axis "+t.direction+t.n+"Axis",u="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+l,c=t.options.font||"flot-tick-label tickLabel";if(oe.removeText(u),t.show&&0!=t.ticks.length)for(var h=0;h<t.ticks.length;++h)n=t.ticks[h],!n.label||n.v<t.min||n.v>t.max||("x"==t.direction?(o="center",i=de.left+t.p2c(n.v),"bottom"==t.position?r=a.top+a.padding:(r=a.top+a.height-a.padding,s="bottom")):(s="middle",r=de.top+t.p2c(n.v),"left"==t.position?(i=a.left+a.width-a.padding,o="right"):i=a.left+a.padding),oe.addText(u,i,r,n.label,c,null,null,o,s))})}function I(e){e.lines.show&&F(e),e.bars.show&&$(e),e.points.show&&B(e)}function F(e){function t(e,t,n,i,r){var o=e.points,s=e.pointsize,a=null,l=null;le.beginPath();for(var u=s;u<o.length;u+=s){var c=o[u-s],h=o[u-s+1],d=o[u],f=o[u+1];if(null!=c&&null!=d){if(f>=h&&h<r.min){if(f<r.min)continue;c=(r.min-h)/(f-h)*(d-c)+c,h=r.min}else if(h>=f&&f<r.min){if(h<r.min)continue;d=(r.min-h)/(f-h)*(d-c)+c,f=r.min}if(h>=f&&h>r.max){if(f>r.max)continue;c=(r.max-h)/(f-h)*(d-c)+c,h=r.max}else if(f>=h&&f>r.max){if(h>r.max)continue;d=(r.max-h)/(f-h)*(d-c)+c,f=r.max}if(d>=c&&c<i.min){if(d<i.min)continue;h=(i.min-c)/(d-c)*(f-h)+h,c=i.min}else if(c>=d&&d<i.min){if(c<i.min)continue;f=(i.min-c)/(d-c)*(f-h)+h,d=i.min}if(c>=d&&c>i.max){if(d>i.max)continue;h=(i.max-c)/(d-c)*(f-h)+h,c=i.max}else if(d>=c&&d>i.max){if(c>i.max)continue;f=(i.max-c)/(d-c)*(f-h)+h,d=i.max}(c!=a||h!=l)&&le.moveTo(i.p2c(c)+t,r.p2c(h)+n),a=d,l=f,le.lineTo(i.p2c(d)+t,r.p2c(f)+n)}}le.stroke()}function n(e,t,n){for(var i=e.points,r=e.pointsize,o=Math.min(Math.max(0,n.min),n.max),s=0,a=!1,l=1,u=0,c=0;;){if(r>0&&s>i.length+r)break;s+=r;var h=i[s-r],d=i[s-r+l],f=i[s],p=i[s+l];if(a){if(r>0&&null!=h&&null==f){c=s,r=-r,l=2;continue}if(0>r&&s==u+r){le.fill(),a=!1,r=-r,l=1,s=u=c+r;continue}}if(null!=h&&null!=f){if(f>=h&&h<t.min){if(f<t.min)continue;d=(t.min-h)/(f-h)*(p-d)+d,h=t.min}else if(h>=f&&f<t.min){if(h<t.min)continue;p=(t.min-h)/(f-h)*(p-d)+d,f=t.min}if(h>=f&&h>t.max){if(f>t.max)continue;d=(t.max-h)/(f-h)*(p-d)+d,h=t.max}else if(f>=h&&f>t.max){if(h>t.max)continue;p=(t.max-h)/(f-h)*(p-d)+d,f=t.max}if(a||(le.beginPath(),le.moveTo(t.p2c(h),n.p2c(o)),a=!0),d>=n.max&&p>=n.max)le.lineTo(t.p2c(h),n.p2c(n.max)),le.lineTo(t.p2c(f),n.p2c(n.max));else if(d<=n.min&&p<=n.min)le.lineTo(t.p2c(h),n.p2c(n.min)),le.lineTo(t.p2c(f),n.p2c(n.min));else{var m=h,g=f;p>=d&&d<n.min&&p>=n.min?(h=(n.min-d)/(p-d)*(f-h)+h,d=n.min):d>=p&&p<n.min&&d>=n.min&&(f=(n.min-d)/(p-d)*(f-h)+h,p=n.min),d>=p&&d>n.max&&p<=n.max?(h=(n.max-d)/(p-d)*(f-h)+h,d=n.max):p>=d&&p>n.max&&d<=n.max&&(f=(n.max-d)/(p-d)*(f-h)+h,p=n.max),h!=m&&le.lineTo(t.p2c(m),n.p2c(d)),le.lineTo(t.p2c(h),n.p2c(d)),le.lineTo(t.p2c(f),n.p2c(p)),f!=g&&(le.lineTo(t.p2c(f),n.p2c(p)),le.lineTo(t.p2c(g),n.p2c(p)))}}}}le.save(),le.translate(de.left,de.top),le.lineJoin="round";var i=e.lines.lineWidth,r=e.shadowSize;if(i>0&&r>0){le.lineWidth=r,le.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;t(e.datapoints,Math.sin(o)*(i/2+r/2),Math.cos(o)*(i/2+r/2),e.xaxis,e.yaxis),le.lineWidth=r/2,t(e.datapoints,Math.sin(o)*(i/2+r/4),Math.cos(o)*(i/2+r/4),e.xaxis,e.yaxis)}le.lineWidth=i,le.strokeStyle=e.color;var s=L(e.lines,e.color,0,pe);s&&(le.fillStyle=s,n(e.datapoints,e.xaxis,e.yaxis)),i>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),le.restore()}function B(e){function t(e,t,n,i,r,o,s,a){for(var l=e.points,u=e.pointsize,c=0;c<l.length;c+=u){var h=l[c],d=l[c+1];null==h||h<o.min||h>o.max||d<s.min||d>s.max||(le.beginPath(),h=o.p2c(h),d=s.p2c(d)+i,"circle"==a?le.arc(h,d,t,0,r?Math.PI:2*Math.PI,!1):a(le,h,d,t,r),le.closePath(),n&&(le.fillStyle=n,le.fill()),le.stroke())}}le.save(),le.translate(de.left,de.top);var n=e.points.lineWidth,i=e.shadowSize,r=e.points.radius,o=e.points.symbol;if(0==n&&(n=1e-4),n>0&&i>0){var s=i/2;le.lineWidth=s,le.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,r,null,s+s/2,!0,e.xaxis,e.yaxis,o),le.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,r,null,s/2,!0,e.xaxis,e.yaxis,o)}le.lineWidth=n,le.strokeStyle=e.color,t(e.datapoints,r,L(e.points,e.color),0,!1,e.xaxis,e.yaxis,o),le.restore()}function q(e,t,n,i,r,o,s,a,l,u,c){var h,d,f,p,m,g,v,y,b;u?(y=g=v=!0,m=!1,h=n,d=e,p=t+i,f=t+r,h>d&&(b=d,d=h,h=b,m=!0,g=!1)):(m=g=v=!0,y=!1,h=e+i,d=e+r,f=n,p=t,f>p&&(b=p,p=f,f=b,y=!0,v=!1)),d<s.min||h>s.max||p<a.min||f>a.max||(h<s.min&&(h=s.min,m=!1),d>s.max&&(d=s.max,g=!1),f<a.min&&(f=a.min,y=!1),p>a.max&&(p=a.max,v=!1),h=s.p2c(h),f=a.p2c(f),d=s.p2c(d),p=a.p2c(p),o&&(l.fillStyle=o(f,p),l.fillRect(h,p,d-h,f-p)),c>0&&(m||g||v||y)&&(l.beginPath(),l.moveTo(h,f),m?l.lineTo(h,p):l.moveTo(h,p),v?l.lineTo(d,p):l.moveTo(d,p),g?l.lineTo(d,f):l.moveTo(d,f),y?l.lineTo(h,f):l.moveTo(h,f),l.stroke()))}function $(e){function t(t,n,i,r,o,s){for(var a=t.points,l=t.pointsize,u=0;u<a.length;u+=l)null!=a[u]&&q(a[u],a[u+1],a[u+2],n,i,r,o,s,le,e.bars.horizontal,e.bars.lineWidth)}le.save(),le.translate(de.left,de.top),le.lineWidth=e.bars.lineWidth,le.strokeStyle=e.color;var n;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;default:n=-e.bars.barWidth/2}var i=e.bars.fill?function(t,n){return L(e.bars,e.color,t,n)}:null;t(e.datapoints,n,n+e.bars.barWidth,i,e.xaxis,e.yaxis),le.restore()}function L(t,n,i,r){var o=t.fill;if(!o)return null;if(t.fillColor)return ne(t.fillColor,i,r,n);var s=e.color.parse(n);return s.a="number"==typeof o?o:.4,s.normalize(),s.toString()}function z(){if(null!=re.legend.container?e(re.legend.container).html(""):n.find(".legend").remove(),re.legend.show){for(var t,i,r=[],o=[],s=!1,a=re.legend.labelFormatter,l=0;l<ie.length;++l)t=ie[l],t.label&&(i=a?a(t.label,t):t.label,i&&o.push({label:i,color:t.color}));if(re.legend.sorted)if(e.isFunction(re.legend.sorted))o.sort(re.legend.sorted);else if("reverse"==re.legend.sorted)o.reverse();else{var u="descending"!=re.legend.sorted;o.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=u?1:-1})}for(var l=0;l<o.length;++l){var c=o[l];l%re.legend.noColumns==0&&(s&&r.push("</tr>"),r.push("<tr>"),s=!0),r.push('<td class="legendColorBox"><div style="border:1px solid '+re.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+c.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+c.label+"</td>")}if(s&&r.push("</tr>"),0!=r.length){var h='<table style="font-size:smaller;color:'+re.grid.color+'">'+r.join("")+"</table>";if(null!=re.legend.container)e(re.legend.container).html(h);else{var d="",f=re.legend.position,p=re.legend.margin;null==p[0]&&(p=[p,p]),"n"==f.charAt(0)?d+="top:"+(p[1]+de.top)+"px;":"s"==f.charAt(0)&&(d+="bottom:"+(p[1]+de.bottom)+"px;"),"e"==f.charAt(1)?d+="right:"+(p[0]+de.right)+"px;":"w"==f.charAt(1)&&(d+="left:"+(p[0]+de.left)+"px;");var m=e('<div class="legend">'+h.replace('style="','style="position:absolute;'+d+";")+"</div>").appendTo(n);if(0!=re.legend.backgroundOpacity){var g=re.legend.backgroundColor;null==g&&(g=re.grid.backgroundColor,g=g&&"string"==typeof g?e.color.parse(g):e.color.extract(m,"background-color"),g.a=1,g=g.toString());var v=m.children();e('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+d+"background-color:"+g+';"> </div>').prependTo(m).css("opacity",re.legend.backgroundOpacity)}}}}}function H(e,t,n){var i,r,o,s=re.grid.mouseActiveRadius,a=s*s+1,l=null;for(i=ie.length-1;i>=0;--i)if(n(ie[i])){var u=ie[i],c=u.xaxis,h=u.yaxis,d=u.datapoints.points,f=c.c2p(e),p=h.c2p(t),m=s/c.scale,g=s/h.scale;if(o=u.datapoints.pointsize,c.options.inverseTransform&&(m=Number.MAX_VALUE),h.options.inverseTransform&&(g=Number.MAX_VALUE),u.lines.show||u.points.show)for(r=0;r<d.length;r+=o){var v=d[r],y=d[r+1];if(null!=v&&!(v-f>m||-m>v-f||y-p>g||-g>y-p)){var b=Math.abs(c.p2c(v)-e),w=Math.abs(h.p2c(y)-t),x=b*b+w*w;a>x&&(a=x,l=[i,r/o])}}if(u.bars.show&&!l){var _,C;switch(u.bars.align){case"left":_=0;break;case"right":_=-u.bars.barWidth;break;default:_=-u.bars.barWidth/2}for(C=_+u.bars.barWidth,r=0;r<d.length;r+=o){var v=d[r],y=d[r+1],k=d[r+2];null!=v&&(ie[i].bars.horizontal?f<=Math.max(k,v)&&f>=Math.min(k,v)&&p>=y+_&&y+C>=p:f>=v+_&&v+C>=f&&p>=Math.min(k,y)&&p<=Math.max(k,y))&&(l=[i,r/o])}}}return l?(i=l[0],r=l[1],o=ie[i].datapoints.pointsize,{datapoint:ie[i].datapoints.points.slice(r*o,(r+1)*o),dataIndex:r,series:ie[i],seriesIndex:i}):null}function W(e){re.grid.hoverable&&K("plothover",e,function(e){return 0!=e.hoverable})}function U(e){re.grid.hoverable&&K("plothover",e,function(e){return!1})}function X(e){K("plotclick",e,function(e){return 0!=e.clickable})}function K(e,t,i){var r=ae.offset(),o=t.pageX-r.left-de.left,s=t.pageY-r.top-de.top,a=p({left:o,top:s});a.pageX=t.pageX,a.pageY=t.pageY;var l=H(o,s,i);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+r.left+de.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+r.top+de.top,10)),re.grid.autoHighlight){for(var u=0;u<ve.length;++u){var c=ve[u];c.auto!=e||l&&c.series==l.series&&c.point[0]==l.datapoint[0]&&c.point[1]==l.datapoint[1]||Q(c.series,c.point)}l&&J(l.series,l.datapoint,e)}n.trigger(e,[a,l])}function G(){var e=re.interaction.redrawOverlayInterval;return-1==e?void Y():void(ye||(ye=setTimeout(Y,e)))}function Y(){ye=null,ue.save(),se.clear(),ue.translate(de.left,de.top);var e,t;for(e=0;e<ve.length;++e)t=ve[e],t.series.bars.show?te(t.series,t.point):ee(t.series,t.point);ue.restore(),a(me.drawOverlay,[ue]);
}function J(e,t,n){if("number"==typeof e&&(e=ie[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var r=Z(e,t);-1==r?(ve.push({series:e,point:t,auto:n}),G()):n||(ve[r].auto=!1)}function Q(e,t){if(null==e&&null==t)return ve=[],void G();if("number"==typeof e&&(e=ie[e]),"number"==typeof t){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var i=Z(e,t);-1!=i&&(ve.splice(i,1),G())}function Z(e,t){for(var n=0;n<ve.length;++n){var i=ve[n];if(i.series==e&&i.point[0]==t[0]&&i.point[1]==t[1])return n}return-1}function ee(t,n){var i=n[0],r=n[1],o=t.xaxis,s=t.yaxis,a="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(!(i<o.min||i>o.max||r<s.min||r>s.max)){var l=t.points.radius+t.points.lineWidth/2;ue.lineWidth=l,ue.strokeStyle=a;var u=1.5*l;i=o.p2c(i),r=s.p2c(r),ue.beginPath(),"circle"==t.points.symbol?ue.arc(i,r,u,0,2*Math.PI,!1):t.points.symbol(ue,i,r,u,!1),ue.closePath(),ue.stroke()}}function te(t,n){var i,r="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),o=r;switch(t.bars.align){case"left":i=0;break;case"right":i=-t.bars.barWidth;break;default:i=-t.bars.barWidth/2}ue.lineWidth=t.bars.lineWidth,ue.strokeStyle=r,q(n[0],n[1],n[2]||0,i,i+t.bars.barWidth,function(){return o},t.xaxis,t.yaxis,ue,t.bars.horizontal,t.bars.lineWidth)}function ne(t,n,i,r){if("string"==typeof t)return t;for(var o=le.createLinearGradient(0,i,0,n),s=0,a=t.colors.length;a>s;++s){var l=t.colors[s];if("string"!=typeof l){var u=e.color.parse(r);null!=l.brightness&&(u=u.scale("rgb",l.brightness)),null!=l.opacity&&(u.a*=l.opacity),l=u.toString()}o.addColorStop(s/(a-1),l)}return o}var ie=[],re={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},oe=null,se=null,ae=null,le=null,ue=null,ce=[],he=[],de={left:0,right:0,top:0,bottom:0},fe=0,pe=0,me={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},ge=this;ge.setData=c,ge.setupGrid=S,ge.draw=P,ge.getPlaceholder=function(){return n},ge.getCanvas=function(){return oe.element},ge.getPlotOffset=function(){return de},ge.width=function(){return fe},ge.height=function(){return pe},ge.offset=function(){var e=ae.offset();return e.left+=de.left,e.top+=de.top,e},ge.getData=function(){return ie},ge.getAxes=function(){var t={};return e.each(ce.concat(he),function(e,n){n&&(t[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),t},ge.getXAxes=function(){return ce},ge.getYAxes=function(){return he},ge.c2p=p,ge.p2c=m,ge.getOptions=function(){return re},ge.highlight=J,ge.unhighlight=Q,ge.triggerRedrawOverlay=G,ge.pointOffset=function(e){return{left:parseInt(ce[d(e,"x")-1].p2c(+e.x)+de.left,10),top:parseInt(he[d(e,"y")-1].p2c(+e.y)+de.top,10)}},ge.shutdown=x,ge.destroy=function(){x(),n.removeData("plot").empty(),ie=[],re=null,oe=null,se=null,ae=null,le=null,ue=null,ce=[],he=[],me=null,ve=[],ge=null},ge.resize=function(){var e=n.width(),t=n.height();oe.resize(e,t),se.resize(e,t)},ge.hooks=me,l(ge),u(o),b(),c(r),S(),P(),w();var ve=[],ye=null}function i(e,t){return t*Math.floor(e/t)}var r=Object.prototype.hasOwnProperty;e.fn.detach||(e.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),t.prototype.resize=function(e,t){if(0>=e||0>=t)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var n=this.element,i=this.context,r=this.pixelRatio;this.width!=e&&(n.width=e*r,n.style.width=e+"px",this.width=e),this.height!=t&&(n.height=t*r,n.style.height=t+"px",this.height=t),i.restore(),i.save(),i.scale(r,r)},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.render=function(){var e=this._textCache;for(var t in e)if(r.call(e,t)){var n=this.getTextLayer(t),i=e[t];n.hide();for(var o in i)if(r.call(i,o)){var s=i[o];for(var a in s)if(r.call(s,a)){for(var l,u=s[a].positions,c=0;l=u[c];c++)l.active?l.rendered||(n.append(l.element),l.rendered=!0):(u.splice(c--,1),l.rendered&&l.element.detach());0==u.length&&delete s[a]}}n.show()}},t.prototype.getTextLayer=function(t){var n=this.text[t];return null==n&&(null==this.textContainer&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),n=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),n},t.prototype.getTextInfo=function(t,n,i,r,o){var s,a,l,u;if(n=""+n,s="object"==typeof i?i.style+" "+i.variant+" "+i.weight+" "+i.size+"px/"+i.lineHeight+"px "+i.family:i,a=this._textCache[t],null==a&&(a=this._textCache[t]={}),l=a[s],null==l&&(l=a[s]={}),u=l[n],null==u){var c=e("<div></div>").html(n).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(t));"object"==typeof i?c.css({font:s,color:i.color}):"string"==typeof i&&c.addClass(i),u=l[n]={width:c.outerWidth(!0),height:c.outerHeight(!0),element:c,positions:[]},c.detach()}return u},t.prototype.addText=function(e,t,n,i,r,o,s,a,l){var u=this.getTextInfo(e,i,r,o,s),c=u.positions;"center"==a?t-=u.width/2:"right"==a&&(t-=u.width),"middle"==l?n-=u.height/2:"bottom"==l&&(n-=u.height);for(var h,d=0;h=c[d];d++)if(h.x==t&&h.y==n)return void(h.active=!0);h={active:!0,rendered:!1,element:c.length?u.element.clone():u.element,x:t,y:n},c.push(h),h.element.css({top:Math.round(n),left:Math.round(t),"text-align":a})},t.prototype.removeText=function(e,t,n,i,o,s){if(null==i){var a=this._textCache[e];if(null!=a)for(var l in a)if(r.call(a,l)){var u=a[l];for(var c in u)if(r.call(u,c))for(var h,d=u[c].positions,f=0;h=d[f];f++)h.active=!1}}else for(var h,d=this.getTextInfo(e,i,o,s).positions,f=0;h=d[f];f++)h.x==t&&h.y==n&&(h.active=!1)},e.plot=function(t,i,r){var o=new n(e(t),i,r,e.plot.plugins);return o},e.plot.version="0.8.3",e.plot.plugins=[],e.fn.plot=function(t,n){return this.each(function(){e.plot(this,t,n)})}}(jQuery),define("Flot",["jquery"],function(e){return function(){var t;return t||e.$.plot}}(this)),function(e){function t(t){function n(e){p.active&&(u(e),t.getPlaceholder().trigger("plotselecting",[o()]),p.touch===!0&&e.preventDefault())}function i(t){if("touchstart"===t.type&&1===t.originalEvent.touches.length)p.touch=!0;else if(1!==t.which||t.originalEvent.touches&&t.originalEvent.touches.length>1)return;document.body.focus(),void 0!==document.onselectstart&&null===m.onselectstart&&(m.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),void 0!==document.ondrag&&null===m.ondrag&&(m.ondrag=document.ondrag,document.ondrag=function(){return!1}),l(p.first,t),p.active=!0,g=function(e){r(e)},e(document).one(p.touch?"touchend":"mouseup",g)}function r(e){return g=null,void 0!==document.onselectstart&&(document.onselectstart=m.onselectstart),void 0!==document.ondrag&&(document.ondrag=m.ondrag),p.active=!1,u(e),f()?s():(t.getPlaceholder().trigger("plotunselected",[]),t.getPlaceholder().trigger("plotselecting",[null])),p.touch=!1,!1}function o(){if(!f()||!p.show)return null;var n={},i=p.first,r=p.second;return e.each(t.getAxes(),function(e,t){if(t.used){var o=t.c2p(i[t.direction]),s=t.c2p(r[t.direction]);n[e]={from:Math.min(o,s),to:Math.max(o,s)}}}),n}function s(){var e=o();t.getPlaceholder().trigger("plotselected",[e]),e.xaxis&&e.yaxis&&t.getPlaceholder().trigger("selected",[{x1:e.xaxis.from,y1:e.yaxis.from,x2:e.xaxis.to,y2:e.yaxis.to}])}function a(e,t,n){return e>t?e:t>n?n:t}function l(e,n){var i=t.getOptions(),r=t.getPlaceholder().offset(),o=t.getPlotOffset(),s=p.touch?n.originalEvent.changedTouches[0]:n;e.x=a(0,s.pageX-r.left-o.left,t.width()),e.y=a(0,s.pageY-r.top-o.top,t.height()),"y"===i.selection.mode&&(e.x=e===p.first?0:t.width()),"x"===i.selection.mode&&(e.y=e===p.first?0:t.height())}function u(e){var n=p.touch?e.originalEvent.changedTouches[0]:e;null!==n.pageX&&(l(p.second,e),f()?(p.show=!0,t.triggerRedrawOverlay()):c(!0))}function c(e){p.show&&(p.show=!1,t.triggerRedrawOverlay(),e||t.getPlaceholder().trigger("plotunselected",[]))}function h(e,n){var i,r,o,s,a=t.getAxes();for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l)&&(i=a[l],i.direction===n&&(s=n+i.n+"axis",e[s]||1!==i.n||(s=n+"axis"),e[s]))){r=e[s].from,o=e[s].to;break}if(e[s]||(i="x"===n?t.getXAxes()[0]:t.getYAxes()[0],r=e[n+"1"],o=e[n+"2"]),null!=r&&null!=o&&r>o){var u=r;r=o,o=u}return{from:r,to:o,axis:i}}function d(e,n){var i,r=t.getOptions();"y"===r.selection.mode?(p.first.x=0,p.second.x=t.width()):(i=h(e,"x"),p.first.x=i.axis.p2c(i.from),p.second.x=i.axis.p2c(i.to)),"x"===r.selection.mode?(p.first.y=0,p.second.y=t.height()):(i=h(e,"y"),p.first.y=i.axis.p2c(i.from),p.second.y=i.axis.p2c(i.to)),p.show=!0,t.triggerRedrawOverlay(),!n&&f()&&s()}function f(){var e=t.getOptions().selection.minSize;return Math.abs(p.second.x-p.first.x)>=e&&Math.abs(p.second.y-p.first.y)>=e}var p={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1,touch:!1},m={},g=null;t.clearSelection=c,t.setSelection=d,t.getSelection=o,t.hooks.bindEvents.push(function(e,t){var r=e.getOptions();null!=r.selection.mode&&(t.mousemove(n),t.mousedown(i),t.bind("touchstart",function(e){t.unbind("mousedown",i),i(e)}),t.bind("touchmove",n))}),t.hooks.drawOverlay.push(function(t,n){if(p.show&&f()){var i=t.getPlotOffset(),r=t.getOptions();n.save(),n.translate(i.left,i.top);var o=e.color.parse(r.selection.color);n.strokeStyle=o.scale("a",.8).toString(),n.lineWidth=1,n.lineJoin=r.selection.shape,n.fillStyle=o.scale("a",.4).toString();var s=Math.min(p.first.x,p.second.x)+.5,a=Math.min(p.first.y,p.second.y)+.5,l=Math.abs(p.second.x-p.first.x)-1,u=Math.abs(p.second.y-p.first.y)-1;n.fillRect(s,a,l,u),n.strokeRect(s,a,l,u),n.restore()}}),t.hooks.shutdown.push(function(t,r){r.unbind("mousemove",n),r.unbind("mousedown",i),g&&e(document).unbind("mouseup",g)})}e.plot.plugins.push({init:t,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})}(jQuery),define("Flot-selection",["Flot"],function(){}),function(e,t,n){"$:nomunge";function i(n){a===!0&&(a=n||1);for(var l=o.length-1;l>=0;l--){var d=e(o[l]);if(d[0]==t||d.is(":visible")){var f=d.width(),p=d.height(),m=d.data(c);!m||f===m.w&&p===m.h||(d.trigger(u,[m.w=f,m.h=p]),a=n||!0)}else m=d.data(c),m.w=0,m.h=0}null!==r&&(a&&(null==n||1e3>n-a)?r=t.requestAnimationFrame(i):(r=setTimeout(i,s[h]),a=!1))}var r,o=[],s=e.resize=e.extend(e.resize,{}),a=!1,l="setTimeout",u="resize",c=u+"-special-event",h="pendingDelay",d="activeDelay",f="throttleWindow";s[h]=200,s[d]=20,s[f]=!0,e.event.special[u]={setup:function(){if(!s[f]&&this[l])return!1;var t=e(this);o.push(this),t.data(c,{w:t.width(),h:t.height()}),1===o.length&&(r=n,i())},teardown:function(){if(!s[f]&&this[l])return!1;for(var t=e(this),n=o.length-1;n>=0;n--)if(o[n]==this){o.splice(n,1);break}t.removeData(c),o.length||(a?cancelAnimationFrame(r):clearTimeout(r),r=null)},add:function(t){function i(t,i,o){var s=e(this),a=s.data(c)||{};a.w=i!==n?i:s.width(),a.h=o!==n?o:s.height(),r.apply(this,arguments)}if(!s[f]&&this[l])return!1;var r;return e.isFunction(t)?(r=t,i):(r=t.handler,void(t.handler=i))}},t.requestAnimationFrame||(t.requestAnimationFrame=function(){return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e,n){return t.setTimeout(function(){e((new Date).getTime())},s[d])}}()),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(){return t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}())}(jQuery,this),function(e){function t(e){function t(){var t=e.getPlaceholder();0!=t.width()&&0!=t.height()&&(e.resize(),e.setupGrid(),e.draw())}function n(e,n){e.getPlaceholder().resize(t)}function i(e,n){e.getPlaceholder().unbind("resize",t)}e.hooks.bindEvents.push(n),e.hooks.shutdown.push(i)}var n={};e.plot.plugins.push({init:t,options:n,name:"resize",version:"1.0"})}(jQuery),define("Flot-resize",["Flot"],function(){}),define("views/spectrum",["backbone.marionette","jquery","Flot","Flot-selection","Flot-resize"],function(e,t){return e.View.extend({template:_.template("<h2>Theoretical Spectrum</h2><figure></figure>"),ui:{fig:"figure"},events:{plotselected:"zoom","dblclick canvas":"reset",touchstart:"touchStart"},initialize:function(){},onRender:function(){this.ui.fig.height(.4*t(window).height())},onDomRefresh:function(){this.plotSpectrum()},touchStart:function(e){if(!(e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(e.preventDefault(),e.originalEvent.touches&&e.originalEvent.touches.length)){if(this.lastClick&&new Date-this.lastClick<1e3)return void this.reset(e);this.lastClick=new Date}},reset:function(e){this.zoom(e,{xaxis:{from:null,to:null},yaxis:{from:null,to:null}})},zoom:function(e,t){if(console.log("zoom",e,t),t.xaxis){var n=this.plot.getOptions();_.each(n.xaxes,function(e){e.min=t.xaxis.from,e.max=t.xaxis.to}),_.each(n.yaxes,function(e){e.min=t.yaxis.from,e.max=t.yaxis.to}),this.plot.setupGrid(),this.plot.draw(),this.plot.clearSelection()}},plotSpectrum:function(){var e={grid:{borderWidth:0},selection:{mode:"xy"},xaxes:[{axisLabel:"Energy (eV)"}],yaxes:[{axisLabel:"Intensity"}]},n=this.model.get("lines"),i=this.generateSeries({min:_.min(n.pluck("energy")),max:_.max(n.pluck("energy"))});n.each(function(e){i=this.generateFn({energy:e.get("energy"),"yield":e.get("sum_yield"),data:i})},this),this.plot=t.plot(this.ui.fig,[i],e)},generateSeries:function(e){var t=[],n=e.max-e.min;1>n&&(n=2);var i=10*Math.round(2*(n+e.min)*10);return _.each(_.range(i),function(e){t.push([10*e,0])}),t},generateFn:function(e){var t=10*Math.round(10*e.energy),n=10;return _.each(_.range(t-10*n,t+10*n),function(i,r){e.data[i]&&(e.data[i][1]+=this.fnGaussian({height:e["yield"],x:i,centre:t,sigma:n}))},this),e.data},fnGaussian:function(e){return e.height*Math.exp(-(Math.pow(e.x-e.centre,2)/(2*Math.pow(e.sigma,2))))},fnLorentzian:function(e){return e.height*(1/Math.PI)*(.5*e.sigma/(Math.pow(e.x-e.centre,2)+Math.pow(.5*e.sigma,2)))}})}),function(e,t){"function"==typeof define&&define.amd?define("backgrid",["underscore","backbone"],function(n,i){return e.Backgrid=t(n,i)}):"object"==typeof exports?module.exports=t(require("underscore"),require("backbone")):e.Backgrid=t(e._,e.Backbone)}(this,function(e,t){"use strict";function n(e,t,n){var i=t-(e+"").length;i=0>i?0:i;for(var r="",o=0;i>o;o++)r+=n;return r+e}var i="	\n\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||i.trim()){i="["+i+"]";var r=new RegExp("^"+i+i+"*"),o=new RegExp(i+i+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(r,"").replace(o,"")}}var s=t.$,a={Extension:{},resolveNameToClass:function(t,n){if(e.isString(t)){var i=e.map(t.split("-"),function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("")+n,r=a[i]||a.Extension[i];if(e.isUndefined(r))throw new ReferenceError("Class '"+i+"' not found");return r}return t},callByNeed:function(){var t=arguments[0];if(!e.isFunction(t))return t;var n=arguments[1],i=[].slice.call(arguments,2);return t.apply(n,i+""?i:[])}};e.extend(a,t.Events);var l=a.Command=function(t){e.extend(this,{altKey:!!t.altKey,"char":t["char"],charCode:t.charCode,ctrlKey:!!t.ctrlKey,key:t.key,keyCode:t.keyCode,locale:t.locale,location:t.location,metaKey:!!t.metaKey,repeat:!!t.repeat,shiftKey:!!t.shiftKey,which:t.which})};e.extend(l.prototype,{moveUp:function(){return 38==this.keyCode},moveDown:function(){return 40===this.keyCode},moveLeft:function(){return this.shiftKey&&9===this.keyCode},moveRight:function(){return!this.shiftKey&&9===this.keyCode},save:function(){return 13===this.keyCode},cancel:function(){return 27===this.keyCode},passThru:function(){return!(this.moveUp()||this.moveDown()||this.moveLeft()||this.moveRight()||this.save()||this.cancel())}});var u=a.CellFormatter=function(){};e.extend(u.prototype,{fromRaw:function(e,t){return e},toRaw:function(e,t){return e}});var c=a.NumberFormatter=function(t){if(e.extend(this,this.defaults,t||{}),this.decimals<0||this.decimals>20)throw new RangeError("decimals must be between 0 and 20")};c.prototype=new u,e.extend(c.prototype,{defaults:{decimals:2,decimalSeparator:".",orderSeparator:","},HUMANIZED_NUM_RE:/(\d)(?=(?:\d{3})+$)/g,fromRaw:function(t,n){if(e.isNull(t)||e.isUndefined(t))return"";t=parseFloat(t).toFixed(~~this.decimals);var i=t.split("."),r=i[0],o=i[1]?(this.decimalSeparator||".")+i[1]:"";return r.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+o},toRaw:function(t,n){if(t=t.trim(),""===t)return null;for(var i="",r=t.split(this.orderSeparator),o=0;o<r.length;o++)i+=r[o];var s=i.split(this.decimalSeparator);i="";for(var o=0;o<s.length;o++)i=i+s[o]+".";"."===i[i.length-1]&&(i=i.slice(0,i.length-1));var a=1*(1*i).toFixed(~~this.decimals);return e.isNumber(a)&&!e.isNaN(a)?a:void 0}});var h=a.PercentFormatter=function(){a.NumberFormatter.apply(this,arguments)};h.prototype=new a.NumberFormatter,e.extend(h.prototype,{defaults:e.extend({},c.prototype.defaults,{multiplier:1,symbol:"%"}),fromRaw:function(e,t){var n=[].slice.call(arguments,1);return n.unshift(e*this.multiplier),(c.prototype.fromRaw.apply(this,n)||"0")+this.symbol},toRaw:function(t,n){var i=t.split(this.symbol);if(i&&i[0]&&""===i[1]||null==i[1]){var r=c.prototype.toRaw.call(this,i[0]);return e.isUndefined(r)?r:r/this.multiplier}}});var d=a.DatetimeFormatter=function(t){if(e.extend(this,this.defaults,t||{}),!this.includeDate&&!this.includeTime)throw new Error("Either includeDate or includeTime must be true")};d.prototype=new u,e.extend(d.prototype,{defaults:{includeDate:!0,includeTime:!0,includeMilli:!1},DATE_RE:/^([+\-]?\d{4})-(\d{2})-(\d{2})$/,TIME_RE:/^(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?$/,ISO_SPLITTER_RE:/T|Z| +/,_convert:function(t,i){if(""===(t+"").trim())return null;var r,o=null;if(e.isNumber(t)){var s=new Date(t);r=n(s.getUTCFullYear(),4,0)+"-"+n(s.getUTCMonth()+1,2,0)+"-"+n(s.getUTCDate(),2,0),o=n(s.getUTCHours(),2,0)+":"+n(s.getUTCMinutes(),2,0)+":"+n(s.getUTCSeconds(),2,0)}else{t=t.trim();var a=t.split(this.ISO_SPLITTER_RE)||[];r=this.DATE_RE.test(a[0])?a[0]:"",o=r&&a[1]?a[1]:this.TIME_RE.test(a[0])?a[0]:""}var l=this.DATE_RE.exec(r)||[],u=this.TIME_RE.exec(o)||[];if(i){if(this.includeDate&&e.isUndefined(l[0]))return;if(this.includeTime&&e.isUndefined(u[0]))return;if(!this.includeDate&&r)return;if(!this.includeTime&&o)return}var s=new Date(Date.UTC(1*l[1]||0,1*l[2]-1||0,1*l[3]||0,1*u[1]||null,1*u[2]||null,1*u[3]||null,1*u[5]||null)),c="";return this.includeDate&&(c=n(s.getUTCFullYear(),4,0)+"-"+n(s.getUTCMonth()+1,2,0)+"-"+n(s.getUTCDate(),2,0)),this.includeTime&&(c=c+(this.includeDate?"T":"")+n(s.getUTCHours(),2,0)+":"+n(s.getUTCMinutes(),2,0)+":"+n(s.getUTCSeconds(),2,0),this.includeMilli&&(c=c+"."+n(s.getUTCMilliseconds(),3,0))),this.includeDate&&this.includeTime&&(c+="Z"),c},fromRaw:function(t,n){return e.isNull(t)||e.isUndefined(t)?"":this._convert(t)},toRaw:function(e,t){return this._convert(e,!0)}});var f=a.StringFormatter=function(){};f.prototype=new u,e.extend(f.prototype,{fromRaw:function(t,n){return e.isUndefined(t)||e.isNull(t)?"":t+""}});var p=a.EmailFormatter=function(){};p.prototype=new u,e.extend(p.prototype,{toRaw:function(t,n){var i=t.trim().split("@");return 2===i.length&&e.all(i)?t:void 0}});var m=a.SelectFormatter=function(){};m.prototype=new u,e.extend(m.prototype,{fromRaw:function(t,n){return e.isArray(t)?t:null!=t?[t]:[]}});var g=a.CellEditor=t.View.extend({initialize:function(e){this.formatter=e.formatter,this.column=e.column,this.column instanceof S||(this.column=new S(this.column)),this.listenTo(this.model,"backgrid:editing",this.postRender)},postRender:function(e,t){return(null==t||t.get("name")==this.column.get("name"))&&this.$el.focus(),this}}),v=a.InputCellEditor=g.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(e){v.__super__.initialize.apply(this,arguments),e.placeholder&&this.$el.attr("placeholder",e.placeholder)},render:function(){var e=this.model;return this.$el.val(this.formatter.fromRaw(e.get(this.column.get("name")),e)),this},saveOrCancel:function(t){var n=this.formatter,i=this.model,r=this.column,o=new l(t),s="blur"===t.type;if(o.moveUp()||o.moveDown()||o.moveLeft()||o.moveRight()||o.save()||s){t.preventDefault(),t.stopPropagation();var a=this.$el.val(),u=n.toRaw(a,i);e.isUndefined(u)?i.trigger("backgrid:error",i,r,a):(i.set(r.get("name"),u),i.trigger("backgrid:edited",i,r,o))}else o.cancel()&&(t.stopPropagation(),i.trigger("backgrid:edited",i,r,o))},postRender:function(e,t){if(null==t||t.get("name")==this.column.get("name"))if("right"===this.$el.css("text-align")){var n=this.$el.val();this.$el.focus().val(null).val(n)}else this.$el.focus();return this}}),y=a.Cell=t.View.extend({tagName:"td",formatter:u,editor:v,events:{click:"enterEditMode"},initialize:function(t){this.column=t.column,this.column instanceof S||(this.column=new S(this.column));var n=this.column,i=this.model,r=this.$el,o=a.resolveNameToClass(n.get("formatter")||this.formatter,"Formatter");e.isFunction(o.fromRaw)||e.isFunction(o.toRaw)||(o=new o),this.formatter=o,this.editor=a.resolveNameToClass(this.editor,"CellEditor"),this.listenTo(i,"change:"+n.get("name"),function(){r.hasClass("editor")||this.render()}),this.listenTo(i,"backgrid:error",this.renderError),this.listenTo(n,"change:editable change:sortable change:renderable",function(e){var t=e.changedAttributes();for(var n in t)t.hasOwnProperty(n)&&r.toggleClass(n,t[n])}),this.updateStateClassesMaybe()},updateStateClassesMaybe:function(){var e=this.model,t=this.column,n=this.$el;n.toggleClass("editable",a.callByNeed(t.editable(),t,e)),n.toggleClass("sortable",a.callByNeed(t.sortable(),t,e)),n.toggleClass("renderable",a.callByNeed(t.renderable(),t,e))},render:function(){var e=this.$el;e.empty();var t=this.model,n=this.column.get("name");return e.text(this.formatter.fromRaw(t.get(n),t)),e.addClass(n),this.updateStateClassesMaybe(),this.delegateEvents(),this},enterEditMode:function(){var e=this.model,t=this.column,n=a.callByNeed(t.editable(),t,e);n&&(this.currentEditor=new this.editor({column:this.column,model:this.model,formatter:this.formatter}),e.trigger("backgrid:edit",e,t,this,this.currentEditor),this.undelegateEvents(),this.$el.empty(),this.$el.append(this.currentEditor.$el),this.currentEditor.render(),this.$el.addClass("editor"),e.trigger("backgrid:editing",e,t,this,this.currentEditor))},renderError:function(e,t){(null==t||t.get("name")==this.column.get("name"))&&this.$el.addClass("error")},exitEditMode:function(){this.$el.removeClass("error"),this.currentEditor.remove(),this.stopListening(this.currentEditor),delete this.currentEditor,this.$el.removeClass("editor"),this.render()},remove:function(){return this.currentEditor&&(this.currentEditor.remove.apply(this.currentEditor,arguments),delete this.currentEditor),y.__super__.remove.apply(this,arguments)}}),b=a.StringCell=y.extend({className:"string-cell",formatter:f}),w=a.UriCell=y.extend({className:"uri-cell",title:null,target:"_blank",initialize:function(e){w.__super__.initialize.apply(this,arguments),this.title=e.title||this.title,this.target=e.target||this.target},render:function(){this.$el.empty();var e=this.model.get(this.column.get("name")),t=this.formatter.fromRaw(e,this.model);return this.$el.append(s("<a>",{tabIndex:-1,href:e,title:this.title||t,target:this.target}).text(t)),this.delegateEvents(),this}}),x=(a.EmailCell=b.extend({className:"email-cell",formatter:p,render:function(){this.$el.empty();var e=this.model,t=this.formatter.fromRaw(e.get(this.column.get("name")),e);return this.$el.append(s("<a>",{tabIndex:-1,href:"mailto:"+t,title:t}).text(t)),this.delegateEvents(),this}}),a.NumberCell=y.extend({className:"number-cell",decimals:c.prototype.defaults.decimals,decimalSeparator:c.prototype.defaults.decimalSeparator,orderSeparator:c.prototype.defaults.orderSeparator,formatter:c,initialize:function(e){x.__super__.initialize.apply(this,arguments);var t=this.formatter;t.decimals=this.decimals,t.decimalSeparator=this.decimalSeparator,t.orderSeparator=this.orderSeparator}})),_=(a.IntegerCell=x.extend({className:"integer-cell",decimals:0}),a.PercentCell=x.extend({className:"percent-cell",multiplier:h.prototype.defaults.multiplier,symbol:h.prototype.defaults.symbol,formatter:h,initialize:function(){_.__super__.initialize.apply(this,arguments);var e=this.formatter;e.multiplier=this.multiplier,e.symbol=this.symbol}})),C=a.DatetimeCell=y.extend({className:"datetime-cell",includeDate:d.prototype.defaults.includeDate,includeTime:d.prototype.defaults.includeTime,includeMilli:d.prototype.defaults.includeMilli,formatter:d,initialize:function(t){C.__super__.initialize.apply(this,arguments);var n=this.formatter;n.includeDate=this.includeDate,n.includeTime=this.includeTime,n.includeMilli=this.includeMilli;var i=this.includeDate?"YYYY-MM-DD":"";i+=this.includeDate&&this.includeTime?"T":"",i+=this.includeTime?"HH:mm:ss":"",i+=this.includeTime&&this.includeMilli?".SSS":"",this.editor=this.editor.extend({attributes:e.extend({},this.editor.prototype.attributes,this.editor.attributes,{placeholder:i})})}}),k=(a.DateCell=C.extend({className:"date-cell",includeTime:!1}),a.TimeCell=C.extend({className:"time-cell",includeDate:!1}),a.BooleanCellEditor=g.extend({tagName:"input",attributes:{tabIndex:-1,type:"checkbox"},events:{mousedown:function(){this.mouseDown=!0},blur:"enterOrExitEditMode",mouseup:function(){this.mouseDown=!1},change:"saveOrCancel",keydown:"saveOrCancel"},render:function(){var e=this.model,t=this.formatter.fromRaw(e.get(this.column.get("name")),e);return this.$el.prop("checked",t),this},enterOrExitEditMode:function(e){if(!this.mouseDown){var t=this.model;t.trigger("backgrid:edited",t,this.column,new l(e))}},saveOrCancel:function(e){var t=this.model,n=this.column,i=this.formatter,r=new l(e);if(r.passThru()&&"change"!=e.type)return!0;r.cancel()&&(e.stopPropagation(),t.trigger("backgrid:edited",t,n,r));var o=this.$el;if(r.save()||r.moveLeft()||r.moveRight()||r.moveUp()||r.moveDown()){e.preventDefault(),e.stopPropagation();var s=i.toRaw(o.prop("checked"),t);t.set(n.get("name"),s),t.trigger("backgrid:edited",t,n,r)}else if("change"==e.type){var s=i.toRaw(o.prop("checked"),t);t.set(n.get("name"),s),o.focus()}}})),E=(a.BooleanCell=y.extend({className:"boolean-cell",editor:k,events:{click:"enterEditMode"},render:function(){this.$el.empty();var e=this.model,t=this.column,n=a.callByNeed(t.editable(),t,e);return this.$el.append(s("<input>",{tabIndex:-1,type:"checkbox",checked:this.formatter.fromRaw(e.get(t.get("name")),e),disabled:!n})),this.delegateEvents(),this}}),a.SelectCellEditor=g.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:e.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %></option>',null,{variable:null,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}),setOptionValues:function(t){this.optionValues=t,this.optionValues=e.result(this,"optionValues")},setMultiple:function(e){this.multiple=e,this.$el.prop("multiple",e)},_renderOptions:function(t,n){for(var i="",r=0;r<t.length;r++)i+=this.template({text:t[r][0],value:t[r][1],selected:e.indexOf(n,t[r][1])>-1});return i},render:function(){this.$el.empty();var t=e.result(this,"optionValues"),n=this.model,i=this.formatter.fromRaw(n.get(this.column.get("name")),n);if(!e.isArray(t))throw new TypeError("optionValues must be an array");for(var r=null,o=null,r=null,a=null,l=null,u=0;u<t.length;u++){var r=t[u];if(e.isArray(r))o=r[0],r=r[1],this.$el.append(this.template({text:o,value:r,selected:e.indexOf(i,r)>-1}));else{if(!e.isObject(r))throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");a=r.name,l=s("<optgroup></optgroup>",{label:a}),l.append(this._renderOptions.call(this,r.values,i)),this.$el.append(l)}}return this.delegateEvents(),this},save:function(e){var t=this.model,n=this.column;t.set(n.get("name"),this.formatter.toRaw(this.$el.val(),t))},close:function(e){var t=this.model,n=this.column,i=new l(e);i.cancel()?(e.stopPropagation(),t.trigger("backgrid:edited",t,n,new l(e))):(i.save()||i.moveLeft()||i.moveRight()||i.moveUp()||i.moveDown()||"blur"==e.type)&&(e.preventDefault(),e.stopPropagation(),this.save(e),t.trigger("backgrid:edited",t,n,new l(e)))}})),T=a.SelectCell=y.extend({className:"select-cell",editor:E,multiple:!1,formatter:m,optionValues:void 0,delimiter:", ",initialize:function(e){T.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"backgrid:edit",function(e,t,n,i){t.get("name")==this.column.get("name")&&(i.setOptionValues(this.optionValues),i.setMultiple(this.multiple))})},render:function(){this.$el.empty();var t=e.result(this,"optionValues"),n=this.model,i=this.formatter.fromRaw(n.get(this.column.get("name")),n),r=[];try{if(!e.isArray(t)||e.isEmpty(t))throw new TypeError;for(var o=0;o<i.length;o++)for(var s=i[o],a=0;a<t.length;a++){var l=t[a];if(e.isArray(l)){var u=l[0],l=l[1];l==s&&r.push(u)}else{if(!e.isObject(l))throw new TypeError;for(var c=l.values,h=0;h<c.length;h++){var d=c[h];d[1]==s&&r.push(d[0])}}}this.$el.append(r.join(this.delimiter))}catch(f){if(f instanceof TypeError)throw new TypeError("'optionValues' must be of type {Array.<Array>|Array.<{name: string, values: Array.<Array>}>}");throw f}return this.delegateEvents(),this}}),S=a.Column=t.Model.extend({defaults:{name:void 0,label:void 0,sortable:!0,editable:!0,renderable:!0,formatter:void 0,sortType:"cycle",sortValue:void 0,direction:null,cell:void 0,headerCell:void 0},initialize:function(){this.has("label")||this.set({label:this.get("name")},{silent:!0});var e=a.resolveNameToClass(this.get("headerCell"),"HeaderCell"),t=a.resolveNameToClass(this.get("cell"),"Cell");this.set({cell:t,headerCell:e},{silent:!0})},sortValue:function(){var t=this.get("sortValue");return e.isString(t)?this[t]:e.isFunction(t)?t:function(e,t){return e.get(t)}}});e.each(["sortable","renderable","editable"],function(t){S.prototype[t]=function(){var n=this.get(t);return e.isString(n)?this[n]:e.isFunction(n)?n:!!n}});var M=a.Columns=t.Collection.extend({model:S}),R=a.Row=t.View.extend({tagName:"tr",initialize:function(e){var n=this.columns=e.columns;n instanceof t.Collection||(n=this.columns=new M(n));for(var i=this.cells=[],r=0;r<n.length;r++)i.push(this.makeCell(n.at(r),e));this.listenTo(n,"add",function(t,n){var r=n.indexOf(t),o=this.makeCell(t,e);i.splice(r,0,o);var s=this.$el;0===r?s.prepend(o.render().$el):r===n.length-1?s.append(o.render().$el):s.children().eq(r).before(o.render().$el);
}),this.listenTo(n,"remove",function(e,t,n){i[n.index].remove(),i.splice(n.index,1)})},makeCell:function(e){return new(e.get("cell"))({column:e,model:this.model})},render:function(){this.$el.empty();for(var e=document.createDocumentFragment(),t=0;t<this.cells.length;t++)e.appendChild(this.cells[t].render().el);return this.el.appendChild(e),this.delegateEvents(),this},remove:function(){for(var e=0;e<this.cells.length;e++){var n=this.cells[e];n.remove.apply(n,arguments)}return t.View.prototype.remove.apply(this,arguments)}}),A=a.EmptyRow=t.View.extend({tagName:"tr",emptyText:null,initialize:function(e){this.emptyText=e.emptyText,this.columns=e.columns},render:function(){this.$el.empty();var t=document.createElement("td");t.setAttribute("colspan",this.columns.length);var n=document.createElement("span");return n.innerHTML=e.result(this,"emptyText"),t.appendChild(n),this.el.className="empty",this.el.appendChild(t),this}}),V=a.HeaderCell=t.View.extend({tagName:"th",events:{"click button":"onClick"},initialize:function(e){this.column=e.column,this.column instanceof S||(this.column=new S(this.column));var t=this.column,n=this.collection,i=this.$el;this.listenTo(t,"change:editable change:sortable change:renderable",function(e){var t=e.changedAttributes();for(var n in t)t.hasOwnProperty(n)&&i.toggleClass(n,t[n])}),this.listenTo(t,"change:direction",this.setCellDirection),this.listenTo(t,"change:name change:label",this.render),a.callByNeed(t.editable(),t,n)&&i.addClass("editable"),a.callByNeed(t.sortable(),t,n)&&i.addClass("sortable"),a.callByNeed(t.renderable(),t,n)&&i.addClass("renderable"),this.listenTo(n.fullCollection||n,"backgrid:sorted",this.removeCellDirection)},removeCellDirection:function(){this.$el.removeClass("ascending").removeClass("descending"),this.column.set("direction",null)},setCellDirection:function(e,t){this.$el.removeClass("ascending").removeClass("descending"),e.cid==this.column.cid&&this.$el.addClass(t)},onClick:function(e){function t(e,t){"ascending"===i.get("direction")?r.trigger(o,t,"descending"):"descending"===i.get("direction")?r.trigger(o,t,null):r.trigger(o,t,"ascending")}function n(e,t){"ascending"===i.get("direction")?r.trigger(o,t,"descending"):r.trigger(o,t,"ascending")}e.preventDefault();var i=this.column,r=this.collection,o="backgrid:sort",s=a.callByNeed(i.sortable(),i,this.collection);if(s){var l=i.get("sortType");"toggle"===l?n(this,i):t(this,i)}},render:function(){this.$el.empty();var e,t=this.column,n=a.callByNeed(t.sortable(),t,this.collection);return e=n?s("<button>").text(t.get("label")).append("<span class='sort-caret' aria-hidden='true'></span>"):document.createTextNode(t.get("label")),this.$el.append(e),this.$el.addClass(t.get("name")),this.$el.addClass(t.get("direction")),this.delegateEvents(),this}}),P=(a.HeaderRow=a.Row.extend({initialize:function(){a.Row.prototype.initialize.apply(this,arguments)},makeCell:function(e,t){var n=e.get("headerCell")||t.headerCell||V;return n=new n({column:e,collection:this.collection})}}),a.Header=t.View.extend({tagName:"thead",initialize:function(e){this.columns=e.columns,this.columns instanceof t.Collection||(this.columns=new M(this.columns)),this.row=new a.HeaderRow({columns:this.columns,collection:this.collection})},render:function(){return this.$el.append(this.row.render().$el),this.delegateEvents(),this},remove:function(){return this.row.remove.apply(this.row,arguments),t.View.prototype.remove.apply(this,arguments)}})),D=a.Body=t.View.extend({tagName:"tbody",initialize:function(e){this.columns=e.columns,this.columns instanceof t.Collection||(this.columns=new M(this.columns)),this.row=e.row||this.row||R,this.rows=this.collection.map(function(e){var t=new this.row({columns:this.columns,model:e});return t},this),this.emptyText=e.emptyText,this._unshiftEmptyRowMayBe();var n=this.collection;this.listenTo(n,"add",this.insertRow),this.listenTo(n,"remove",this.removeRow),this.listenTo(n,"sort",this.refresh),this.listenTo(n,"reset",this.refresh),this.listenTo(n,"backgrid:sort",this.sort),this.listenTo(n,"backgrid:edited",this.moveToNextCell),this.listenTo(this.columns,"add remove",this.updateEmptyRow)},_unshiftEmptyRowMayBe:function(){return 0===this.rows.length&&null!=this.emptyText?(this.emptyRow=new A({emptyText:this.emptyText,columns:this.columns}),this.rows.unshift(this.emptyRow),!0):void 0},insertRow:function(e,n,i){if(this.rows[0]instanceof A&&this.rows.pop().remove(),!(n instanceof t.Collection||i))return void this.collection.add(e,i=n);var r=new this.row({columns:this.columns,model:e}),o=n.indexOf(e);this.rows.splice(o,0,r);var s=this.$el,a=s.children(),l=r.render().$el;return o>=a.length?s.append(l):a.eq(o).before(l),this},removeRow:function(t,n,i){return i?((e.isUndefined(i.render)||i.render)&&this.rows[i.index].remove(),this.rows.splice(i.index,1),this._unshiftEmptyRowMayBe()&&this.render(),this):(this.collection.remove(t,i=n),void(this._unshiftEmptyRowMayBe()&&this.render()))},updateEmptyRow:function(){null!=this.emptyRow&&this.emptyRow.render()},refresh:function(){for(var e=0;e<this.rows.length;e++)this.rows[e].remove();return this.rows=this.collection.map(function(e){var t=new this.row({columns:this.columns,model:e});return t},this),this._unshiftEmptyRowMayBe(),this.render(),this.collection.trigger("backgrid:refresh",this),this},render:function(){this.$el.empty();for(var e=document.createDocumentFragment(),t=0;t<this.rows.length;t++){var n=this.rows[t];e.appendChild(n.render().el)}return this.el.appendChild(e),this.delegateEvents(),this},remove:function(){for(var e=0;e<this.rows.length;e++){var n=this.rows[e];n.remove.apply(n,arguments)}return t.View.prototype.remove.apply(this,arguments)},sort:function(n,i){if(!e.contains(["ascending","descending",null],i))throw new RangeError('direction must be one of "ascending", "descending" or `null`');e.isString(n)&&(n=this.columns.findWhere({name:n}));var r,o=this.collection;r="ascending"===i?-1:"descending"===i?1:null;var s=this.makeComparator(n.get("name"),r,r?n.sortValue():function(e){return 1*e.cid.replace("c","")});return t.PageableCollection&&o instanceof t.PageableCollection?(o.setSorting(r&&n.get("name"),r,{sortValue:n.sortValue()}),o.fullCollection?(null==o.fullCollection.comparator&&(o.fullCollection.comparator=s),o.fullCollection.sort(),o.trigger("backgrid:sorted",n,i,o),n.set("direction",i)):o.fetch({reset:!0,success:function(){o.trigger("backgrid:sorted",n,i,o),n.set("direction",i)}})):(o.comparator=s,o.sort(),o.trigger("backgrid:sorted",n,i,o),n.set("direction",i)),this},makeComparator:function(e,t,n){return function(i,r){var o,s=n(i,e),a=n(r,e);return 1===t&&(o=s,s=a,a=o),s===a?0:a>s?-1:1}},moveToNextCell:function(e,t,n){var i,r,o,s,l,u=this.collection.indexOf(e),c=this.columns.indexOf(t);if(-1===c)return this;if(this.rows[u].cells[c].exitEditMode(),n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()){var h=this.columns.length,d=h*this.collection.length;if(n.moveUp()||n.moveDown()){s=u+(n.moveUp()?-1:1);var f=this.rows[s];f?(i=f.cells[c],a.callByNeed(i.column.editable(),i.column,e)&&(i.enterEditMode(),e.trigger("backgrid:next",s,c,!1))):e.trigger("backgrid:next",s,c,!0)}else if(n.moveLeft()||n.moveRight()){for(var p=n.moveRight(),m=u*h+c+(p?1:-1);m>=0&&d>m;p?m++:m--)if(s=~~(m/h),l=m-s*h,i=this.rows[s].cells[l],r=a.callByNeed(i.column.renderable(),i.column,i.model),o=a.callByNeed(i.column.editable(),i.column,e),r&&o){i.enterEditMode(),e.trigger("backgrid:next",s,l,!1);break}m==d&&e.trigger("backgrid:next",~~(m/h),m-s*h,!0)}}return this}});a.Footer=t.View.extend({tagName:"tfoot",initialize:function(e){this.columns=e.columns,this.columns instanceof t.Collection||(this.columns=new a.Columns(this.columns))}}),a.Grid=t.View.extend({tagName:"table",className:"backgrid",header:P,body:D,footer:null,initialize:function(n){n.columns instanceof t.Collection||(n.columns=new M(n.columns||this.columns)),this.columns=n.columns,this.caption=n.caption;var i=e.omit(n,["el","id","attributes","className","tagName","events"]);this.body=n.body||this.body,this.body=new this.body(i),this.header=n.header||this.header,this.header&&(this.header=new this.header(i)),this.footer=n.footer||this.footer,this.footer&&(this.footer=new this.footer(i)),this.listenTo(this.columns,"reset",function(){this.header&&(this.header=new(this.header.remove().constructor)(i)),this.body=new(this.body.remove().constructor)(i),this.footer&&(this.footer=new(this.footer.remove().constructor)(i)),this.render()})},insertRow:function(){return this.body.insertRow.apply(this.body,arguments),this},removeRow:function(){return this.body.removeRow.apply(this.body,arguments),this},insertColumn:function(){return this.columns.add.apply(this.columns,arguments),this},removeColumn:function(){return this.columns.remove.apply(this.columns,arguments),this},sort:function(){return this.body.sort.apply(this.body,arguments),this},render:function(){return this.$el.empty(),this.caption&&this.$el.append(s("<caption>").text(this.caption)),this.header&&this.$el.append(this.header.render().$el),this.footer&&this.$el.append(this.footer.render().$el),this.$el.append(this.body.render().$el),this.delegateEvents(),this.trigger("backgrid:rendered",this),this},remove:function(){return this.header&&this.header.remove.apply(this.header,arguments),this.body.remove.apply(this.body,arguments),this.footer&&this.footer.remove.apply(this.footer,arguments),t.View.prototype.remove.apply(this,arguments)}});return a}),define("views/search",["backbone"],function(e){var t=e.View.extend({tagName:"div",className:"search hide",template:function(e){return'<input type="search" '+(e.placeholder?'placeholder="'+e.placeholder+'"':"")+' name="'+e.name+'" '+(e.value?'value="'+e.value+'"':"")+"/>"},events:{"keyup input[type=search]":"search","click a[data-backgrid-action=clear]":"clear",submit:"search"},name:"s",value:null,placeholder:"Search",url:!0,urlFragment:"s",initialize:function(n){t.__super__.initialize.apply(this,arguments),this.name=n.name||this.name,this.value=n.value||this.value,this.placeholder=n.placeholder||this.placeholder,this.template=n.template||this.template,0==n.url&&(this.url=!1),this.urlFragment=n.urlFragment||this.urlFragment;var i=this.collection,r=this;e.PageableCollection&&i instanceof e.PageableCollection&&"server"==i.mode&&(i.queryParams[this.name]=function(){return r.searchBox().val()||null}),this.search=_.debounce(this.search,400)},clearSearchBox:function(){this.value=null,this.searchBox().val(null),this.showClearButtonMaybe()},showClearButtonMaybe:function(){var e=this.clearButton(),t=this.searchBox().val();t?e.show():e.hide()},searchBox:function(){return this.$el.find("input[type=search]")},clearButton:function(){return this.$el.find("a[data-backgrid-action=clear]")},query:function(){return this.value=this.searchBox().val(),this.value},search:function(t){t&&t.preventDefault();var n={},i=this.query();i&&(n[this.name]=i);var r=this.collection;if(e.PageableCollection&&r instanceof e.PageableCollection?r.getFirstPage({data:n,reset:!0,fetch:!0}):r.fetch({data:n,reset:!0}),this.url){if(this.urlFragment)var o=window.location.pathname.replace(new RegExp("\\/"+this.urlFragment+"\\/(\\w|-)+"),"")+(this.value?"/"+this.urlFragment+"/"+this.value:"");else var o=window.location.pathname.replace(/\/\w+$/,"")+(this.value?"/"+this.value:"");window.history.pushState({},"",o)}},clear:function(t){t&&t.preventDefault(),this.clearSearchBox();var n=this.collection;e.PageableCollection&&n instanceof e.PageableCollection?n.getFirstPage({reset:!0,fetch:!0}):n.fetch({reset:!0})},render:function(){return $("input.search-mobile").focus().keyup(function(){$("input[type=search]").val($(this).val()).trigger("keyup")}).parent("span").addClass("enable"),$("#sidebar,.cont_wrap").addClass("searchbox"),this.$el.empty().append(this.template({name:this.name,placeholder:this.placeholder,value:this.value})),this.showClearButtonMaybe(),this.delegateEvents(),this},destroy:function(){$("input.search-mobile").unbind("keyup").parent("span").removeClass("enable"),$("#sidebar,.cont_wrap").removeClass("searchbox")}});return t}),function(e){if("object"==typeof exports&&"function"==typeof require)module.exports=e(require("underscore"),require("backbone"));else if("function"==typeof define&&define.amd)define("backbone.paginator",["underscore","backbone"],e);else if("undefined"!=typeof _&&"undefined"!=typeof Backbone){var t=Backbone.PageableCollection,n=e(_,Backbone);Backbone.PageableCollection.noConflict=function(){return Backbone.PageableCollection=t,n}}}(function(e,t){"use strict";function n(t,n){if(!e.isNumber(t)||e.isNaN(t)||!e.isFinite(t)||~~t!==t)throw new TypeError("`"+n+"` must be a finite integer");return t}function i(e){for(var t,n,i,r,o={},s=decodeURIComponent,a=e.split("&"),l=0,u=a.length;u>l;l++){var c=a[l];t=c.split("="),n=t[0],i=t[1],null==i&&(i=!0),n=s(n),i=s(i),r=o[n],p(r)?r.push(i):r?o[n]=[r,i]:o[n]=i}return o}function r(e,t,n){var i=e._events[t];if(i&&i.length){var r=i[i.length-1],o=r.callback;r.callback=function(){try{o.apply(this,arguments),n()}catch(e){throw e}finally{r.callback=o}}}else n()}var o=e.extend,s=e.omit,a=e.clone,l=e.each,u=e.pick,c=e.includes,h=e.isEmpty,d=e.pairs||e.toPairs,f=e.invert,p=e.isArray,m=e.isFunction,g=e.isObject,v=e.keys,y=e.isUndefined,b=Math.ceil,w=Math.floor,x=Math.max,_=t.Collection.prototype,C=/[\s'"]/g,k=/[<>\s'"]/g,E=t.PageableCollection=t.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc",1:"desc"}},constructor:function(e,t){_.constructor.apply(this,arguments),t=t||{};var n=this.mode=t.mode||this.mode||T.mode,i=o({},T.queryParams,this.queryParams,t.queryParams||{});i.directions=o({},T.queryParams.directions,this.queryParams.directions,i.directions),this.queryParams=i;var r=this.state=o({},T.state,this.state,t.state);r.currentPage=null==r.currentPage?r.firstPage:r.currentPage,p(e)||(e=e?[e]:[]),e=e.slice(),"server"==n||null!=r.totalRecords||h(e)||(r.totalRecords=this.length),this.switchMode(n,o({fetch:!1,resetState:!1,models:e},t));var s=t.comparator;if(r.sortKey&&!s&&this.setSorting(r.sortKey,r.order,t),"server"!=n){var l=this.fullCollection;s&&t.full&&(this.comparator=null,l.comparator=s),t.full&&l.sort(),h(e)||this.getPage(r.currentPage)}this._initState=a(this.state)},_makeFullCollection:function(e,n){var i,r,o,s=["url","model","sync","comparator"],a=this.constructor.prototype,l={};for(i=0,r=s.length;r>i;i++)o=s[i],y(a[o])||(l[o]=a[o]);var u=new(t.Collection.extend(l))(e,n);for(i=0,r=s.length;r>i;i++)o=s[i],this[o]!==a[o]&&(u[o]=this[o]);return u},_makeCollectionEventHandler:function(e,t){return function(n,i,s,u){var c=e._handlers;l(v(c),function(n){var i=c[n];e.off(n,i),t.off(n,i)});var h=a(e.state),d=h.firstPage,f=0===d?h.currentPage:h.currentPage-1,p=h.pageSize,m=f*p,g=m+p;if("add"==n){var w,x,_,C,u=u||{};if(s==t)x=t.indexOf(i),x>=m&&g>x&&(C=e,w=_=x-m);else{w=e.indexOf(i),x=m+w,C=t;var _=y(u.at)?x:u.at+m}if(u.onRemove||(++h.totalRecords,delete u.onRemove),e.state=e._checkState(h),C){C.add(i,o({},u,{at:_}));var k=w>=p?i:!y(u.at)&&g>_&&e.length>p?e.at(p):null;k&&r(s,n,function(){e.remove(k,{onAdd:!0})})}u.silent||e.trigger("pageable:state:change",e.state)}if("remove"==n){if(u.onAdd)delete u.onAdd;else{if(--h.totalRecords){var E=h.totalPages=b(h.totalRecords/p);h.lastPage=0===d?E-1:E||d,h.currentPage>E&&(h.currentPage=h.lastPage)}else h.totalRecords=null,h.totalPages=null;e.state=e._checkState(h);var T,S=u.index;s==e?((T=t.at(g))?r(e,n,function(){e.push(T,{onRemove:!0})}):!e.length&&h.totalRecords&&e.reset(t.models.slice(m-p,g-p),o({},u,{parse:!1})),t.remove(i)):S>=m&&g>S&&((T=t.at(g-1))&&r(e,n,function(){e.push(T,{onRemove:!0})}),e.remove(i),!e.length&&h.totalRecords&&e.reset(t.models.slice(m-p,g-p),o({},u,{parse:!1})))}u.silent||e.trigger("pageable:state:change",e.state)}if("reset"==n){if(u=s,s=i,s==e&&null==u.from&&null==u.to){var M=t.models.slice(0,m),R=t.models.slice(m+e.models.length);t.reset(M.concat(e.models).concat(R),u)}else s==t&&((h.totalRecords=t.models.length)||(h.totalRecords=null,h.totalPages=null),"client"==e.mode&&(d=h.lastPage=h.currentPage=h.firstPage,f=0===d?h.currentPage:h.currentPage-1,m=f*p,g=m+p),e.state=e._checkState(h),e.reset(t.models.slice(m,g),o({},u,{parse:!1})));u.silent||e.trigger("pageable:state:change",e.state)}"sort"==n&&(u=s,s=i,s===t&&e.reset(t.models.slice(m,g),o({},u,{parse:!1}))),l(v(c),function(n){var i=c[n];l([e,t],function(e){e.on(n,i);var t=e._events[n]||[];t.unshift(t.pop())})})}},_checkState:function(e){var t=this.mode,i=this.links,r=e.totalRecords,o=e.pageSize,s=e.currentPage,a=e.firstPage,l=e.totalPages;if(null!=r&&null!=o&&null!=s&&null!=a&&("infinite"==t?i:!0)){if(r=n(r,"totalRecords"),o=n(o,"pageSize"),s=n(s,"currentPage"),a=n(a,"firstPage"),1>o)throw new RangeError("`pageSize` must be >= 1");if(l=e.totalPages=b(r/o),0>a||a>1)throw new RangeError("`firstPage must be 0 or 1`");if(e.lastPage=0===a?x(0,l-1):l||a,"infinite"==t){if(!i[s])throw new RangeError("No link found for page "+s)}else if(a>s||l>0&&(a?s>l:s>=l))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(a?"<":"<=")+" totalPages if "+a+"-based. Got "+s+".")}return e},setPageSize:function(e,t){e=n(e,"pageSize"),t=t||{first:!1};var i=this.state,r=b(i.totalRecords/e),a=r?x(i.firstPage,w(r*i.currentPage/i.totalPages)):i.firstPage;return i=this.state=this._checkState(o({},i,{pageSize:e,currentPage:t.first?i.firstPage:a,totalPages:r})),this.getPage(i.currentPage,s(t,["first"]))},switchMode:function(t,n){if(!c(["server","client","infinite"],t))throw new TypeError('`mode` must be one of "server", "client" or "infinite"');n=n||{fetch:!0,resetState:!0};var i=this.state=n.resetState?a(this._initState):this._checkState(o({},this.state));this.mode=t;var r,u=this,h=this.fullCollection,d=this._handlers=this._handlers||{};if("server"==t||h)"server"==t&&h&&(l(v(d),function(e){r=d[e],u.off(e,r),h.off(e,r)}),delete this._handlers,this._fullComparator=h.comparator,delete this.fullCollection);else{h=this._makeFullCollection(n.models||[],n),h.pageableCollection=this,this.fullCollection=h;var f=this._makeCollectionEventHandler(this,h);l(["add","remove","reset","sort"],function(t){d[t]=r=e.bind(f,{},t),u.on(t,r),h.on(t,r)}),h.comparator=this._fullComparator}if("infinite"==t)for(var p=this.links={},m=i.firstPage,g=b(i.totalRecords/i.pageSize),y=0===m?x(0,g-1):g||m,w=i.firstPage;y>=w;w++)p[w]=this.url;else this.links&&delete this.links;return n.silent||this.trigger("pageable:state:change",i),n.fetch?this.fetch(s(n,"fetch","resetState")):this},hasPreviousPage:function(){var e=this.state,t=e.currentPage;return"infinite"!=this.mode?t>e.firstPage:!!this.links[t-1]},hasNextPage:function(){var e=this.state,t=this.state.currentPage;return"infinite"!=this.mode?t<e.lastPage:!!this.links[t+1]},getFirstPage:function(e){return this.getPage("first",e)},getPreviousPage:function(e){return this.getPage("prev",e)},getNextPage:function(e){return this.getPage("next",e)},getLastPage:function(e){return this.getPage("last",e)},getPage:function(e,t){var i=this.mode,r=this.fullCollection;t=t||{fetch:!1};var a=this.state,l=a.firstPage,u=a.currentPage,c=a.lastPage,d=a.pageSize,f=e;switch(e){case"first":f=l;break;case"prev":f=u-1;break;case"next":f=u+1;break;case"last":f=c;break;default:f=n(e,"index")}this.state=this._checkState(o({},a,{currentPage:f})),t.silent||this.trigger("pageable:state:change",this.state),t.from=u,t.to=f;var p=(0===l?f:f-1)*d,m=r&&r.length?r.models.slice(p,p+d):[];return"client"!=i&&("infinite"!=i||h(m))||t.fetch?("infinite"==i&&(t.url=this.links[f]),this.fetch(s(t,"fetch"))):(this.reset(m,s(t,"fetch")),this)},getPageByOffset:function(e,t){if(0>e)throw new RangeError("`offset must be > 0`");e=n(e,"offset");var i=w(e/this.state.pageSize);return 0!==this.state.firstPage&&i++,i>this.state.lastPage&&(i=this.state.lastPage),this.getPage(i,t)},sync:function(e,n,i){var r=this;if("infinite"==r.mode){var s=i.success,a=r.state.currentPage;i.success=function(e,t,n){var l=r.links,u=r.parseLinks(e,o({xhr:n},i));u.first&&(l[r.state.firstPage]=u.first),u.prev&&(l[a-1]=u.prev),u.next&&(l[a+1]=u.next),s&&s(e,t,n)}}return(_.sync||t.sync).call(r,e,n,i)},parseLinks:function(e,t){var n={},i=t.xhr.getResponseHeader("Link");if(i){var r=["first","prev","next"];l(i.split(","),function(e){var t=e.split(";"),i=t[0].replace(k,""),o=t.slice(1);l(o,function(e){var t=e.split("="),o=t[0].replace(C,""),s=t[1].replace(C,"");"rel"==o&&c(r,s)&&(n[s]=i)})})}return n},parse:function(e,t){var n=this.parseState(e,a(this.queryParams),a(this.state),t);return n&&(this.state=this._checkState(o({},this.state,n)),(t||{}).silent||this.trigger("pageable:state:change",this.state)),this.parseRecords(e,t)},parseState:function(t,n,i,r){if(t&&2===t.length&&g(t[0])&&p(t[1])){var o=a(i),u=t[0];return l(d(s(n,"directions")),function(t){var n=t[0],i=t[1],r=u[i];y(r)||e.isNull(r)||(o[n]=u[i])}),u.order&&(o.order=1*f(n.directions)[u.order]),o}},parseRecords:function(e,t){return e&&2===e.length&&g(e[0])&&p(e[1])?e[1]:e},fetch:function(t){t=t||{};var n=this._checkState(this.state),r=this.mode;"infinite"!=r||t.url||(t.url=this.links[n.currentPage]);var a=t.data||{},c=t.url||this.url||"";m(c)&&(c=c.call(this));var h=c.indexOf("?");-1!=h&&(o(a,i(c.slice(h+1))),c=c.slice(0,h)),t.url=c,t.data=a;var f="client"==this.mode?u(this.queryParams,"sortKey"):s(u(this.queryParams,v(T.queryParams)),"order","directions","totalPages","totalRecords");l(f,function(t,i){t=m(t)?t.call(this):t,null!=n[i]&&null!=t&&e.isUndefined(a[t])&&(a[t]=n[i])},this);var g=m(this.queryParams.sortKey)?this.queryParams.sortKey.call(this):this.queryParams.sortKey,b=m(this.queryParams.order)?this.queryParams.order.call(this):this.queryParams.order;if(null!=g&&null!=n.sortKey&&null!=b&&null!=n.order)if(p(n.order)){a[b]=[];for(var w=0;w<n.order.length;w++)a[b].push(this.queryParams.directions[n.order[w]])}else a[b]=this.queryParams.directions[n.order+""];for(var x=d(s(this.queryParams,v(T.queryParams))),w=0;w<x.length;w++){var C=x[w],k=C[1];k=m(k)?k.call(this):k,null!=k&&(a[C[0]]=k)}if("server"!=r){var E=this,S=this.fullCollection,M=t.success;return t.success=function(e,n,i){i=i||{},y(t.silent)?delete i.silent:i.silent=t.silent;var s=e.models;"client"==r?S.reset(s,i):(S.add(s,o({at:S.length},o(i,{parse:!1}))),E.trigger("reset",E,i)),M&&M(e,n,i)},_.fetch.call(this,o({},t,{silent:!0}))}return _.fetch.call(this,t)},_makeComparator:function(e,t,n){var i=this.state;return e=e||i.sortKey,t=t||i.order,e&&t?(n||(n=function(e,t){return e.get(t)}),function(i,r){var o,s=n(i,e),a=n(r,e);return 1===t&&(o=s,s=a,a=o),s===a?0:a>s?-1:1}):void 0},setSorting:function(e,t,n){var i=this.state;i.sortKey=e,i.order=t=t||i.order;var r=this.fullCollection,s=!1,a=!1;e||(s=a=!0);var l=this.mode;n=o({side:"client"==l?l:"server",full:!0},n);var u=this._makeComparator(e,t,n.sortValue),c=n.full,h=n.side;return"client"==h?c?(r&&(r.comparator=u),s=!0):(this.comparator=u,a=!0):"server"!=h||c||(this.comparator=u),s&&(this.comparator=null),a&&r&&(r.comparator=null),this}}),T=E.prototype;return E}),function(e,t){"object"==typeof exports?module.exports=t(require("underscore"),require("backbone"),require("backgrid"),require("backbone.paginator")):"function"==typeof define&&define.amd?define("backgrid-paginator",["underscore","backbone","backgrid","backbone.paginator"],t):t(e._,e.Backbone,e.Backgrid)}(this,function(e,t,n){"use strict";var i=n.Extension.PageHandle=t.View.extend({tagName:"li",events:{"click a":"changePage"},title:function(e){return"Page "+e.label},isRewind:!1,isBack:!1,isForward:!1,isFastForward:!1,initialize:function(t){var n=this.collection,i=n.state,r=i.currentPage,o=i.firstPage,s=i.lastPage;e.extend(this,e.pick(t,["isRewind","isBack","isForward","isFastForward"]));var a;this.isRewind?a=o:this.isBack?a=Math.max(o,r-1):this.isForward?a=Math.min(s,r+1):this.isFastForward?a=s:(a=+t.pageIndex,a=o?a+1:a),this.pageIndex=a,this.label=(t.label||(o?a:a+1))+"";var l=t.title||this.title;this.title=e.isFunction(l)?l({label:this.label}):l},render:function(){this.$el.empty();var e=document.createElement("a");e.href="#",this.title&&(e.title=this.title),e.innerHTML=this.label,this.el.appendChild(e);var t=this.collection,n=t.state,i=n.currentPage,r=this.pageIndex;return this.isRewind&&i==n.firstPage||this.isBack&&!t.hasPreviousPage()||this.isForward&&!t.hasNextPage()||this.isFastForward&&(i==n.lastPage||n.totalPages<1)?this.$el.addClass("disabled"):this.isRewind||this.isBack||this.isForward||this.isFastForward||n.currentPage!=r||this.$el.addClass("active"),this.delegateEvents(),this},changePage:function(e){e.preventDefault();var t=this.$el,n=this.collection;return t.hasClass("active")||t.hasClass("disabled")||(this.isRewind?n.getFirstPage({reset:!0}):this.isBack?n.getPreviousPage({reset:!0}):this.isForward?n.getNextPage({reset:!0}):this.isFastForward?n.getLastPage({reset:!0}):n.getPage(this.pageIndex,{reset:!0})),this}}),r=n.Extension.Paginator=t.View.extend({className:"backgrid-paginator",windowSize:10,slideScale:.5,controls:{rewind:{label:"《",title:"First"},back:{label:"〈",title:"Previous"},forward:{label:"〉",title:"Next"},fastForward:{label:"》",title:"Last"}},renderIndexedPageHandles:!0,renderMultiplePagesOnly:!1,pageHandle:i,goBackFirstOnSort:!0,initialize:function(t){var n=this;n.controls=e.defaults(t.controls||{},n.controls,r.prototype.controls),e.extend(n,e.pick(t||{},"windowSize","pageHandle","slideScale","goBackFirstOnSort","renderIndexedPageHandles","renderMultiplePagesOnly"));var i=n.collection;n.listenTo(i,"add",n.render),n.listenTo(i,"remove",n.render),n.listenTo(i,"reset",n.render),n.listenTo(i,"backgrid:sorted",function(){n.goBackFirstOnSort&&i.state.currentPage!==i.state.firstPage&&i.getFirstPage({reset:!0})})},slideMaybe:function(e,t,n,i,r){return Math.round(n%i/i)},slideThisMuch:function(e,t,n,i,r){return~~(i*r)},_calculateWindow:function(){var e=this.collection,t=e.state,n=t.firstPage,i=+t.lastPage;i=Math.max(0,n?i-1:i);var r=Math.max(t.currentPage,t.firstPage);r=n?r-1:r;var o=this.windowSize,s=this.slideScale,a=Math.floor(r/o)*o;r<=i-this.slideThisMuch()&&(a+=this.slideMaybe(n,i,r,o,s)*this.slideThisMuch(n,i,r,o,s));var l=Math.min(i+1,a+o);return[a,l]},makeHandles:function(){var t=[],n=this.collection,i=this._calculateWindow(),r=i[0],o=i[1];if(this.renderIndexedPageHandles)for(var s=r;o>s;s++)t.push(new this.pageHandle({collection:n,pageIndex:s}));var a=this.controls;return e.each(["back","rewind","forward","fastForward"],function(e){var i=a[e];if(i){var r={collection:n,title:i.title,label:i.label};r["is"+e.slice(0,1).toUpperCase()+e.slice(1)]=!0;var o=new this.pageHandle(r);"rewind"==e||"back"==e?t.unshift(o):t.push(o)}},this),t},render:function(){this.$el.empty();var e=this.collection.state.totalPages;if(this.renderMultiplePagesOnly&&1>=e)return this;if(this.handles)for(var t=0,n=this.handles.length;n>t;t++)this.handles[t].remove();for(var i=this.handles=this.makeHandles(),r=document.createElement("ul"),t=0;t<i.length;t++)r.appendChild(i[t].render().el);return this.el.appendChild(r),this}})}),define("views/pages",["backbone.marionette","backgrid","backgrid-paginator"],function(e,t){return e.View.extend({template:_.template('<div class="per_page"><select name="pp"></select></div>'),events:{"change select":"changePageSize"},ui:{pp:"select[name=pp]"},initialize:function(e){this.paginator=new t.Extension.Paginator({className:"pages pp",collection:e.collection,url:!e.noUrl})},pages:[5,15,25,50,100,500],onRender:function(){var e=this.getOption("collection").state.pageSize;this.ui.pp.html(_.map(this.getOption("pages"),function(e){return'<option value="'+e+'">'+e+"</option>"}).join("")).val(e),this.$el.append(this.paginator.render().$el)},changePageSize:function(){console.log(this.$el.find("select").val()),this.getOption("collection").setPageSize(parseInt(this.ui.pp.val()))}})}),define("views/table",["backbone.marionette","backgrid","views/search","views/pages"],function(e,t,n,i){return e.View.extend({template:_.template('<div class="perp"></div><div class="srch clearfix"></div><div class="table bg"></div><div class="page_wrap"></div>'),regions:{table:".table",pages:".page_wrap",search:".srch",pp:".perp"},pages:!0,mobileHidden:[],initialize:function(e){this.collection=e.collection,e.loading&&(this.listenTo(this.collection,"request",this.displaySpinner),this.listenTo(this.collection,"sync",this.removeSpinner),this.listenTo(this.collection,"error",this.removeSpinner)),app.mobile()&&_.each(this.getOption("mobileHidden"),function(t){e.columns[t].renderable=!1});var r=$.extend({},{columns:e.columns,collection:e.collection,className:e.tableClass},e.backgrid);this.grid=new t.Grid(r),this.getOption("pages")&&(this.paginator=new i({collection:e.collection,noUrl:e.noPageUrl})),e.filter&&(this.filter=new n({collection:e.collection,name:e.filter,url:!e.noSearchUrl,value:e.search}))},displaySpinner:function(){this.getRegion("table").$el.addClass("loading")},removeSpinner:function(){this.getRegion("table").$el.removeClass("loading")},onRender:function(){console.log("render"),this.getRegion("table").show(this.grid),this.getOption("pages")&&this.getRegion("pages").show(this.paginator),this.filter&&this.getRegion("search").show(this.filter)},focusSearch:function(){this.$el.find("input[type=search]").focus()}})}),define("tpl!templates/element.html",function(){return function(obj){var __p="";with(obj||{})__p+="<h1>"+_.escape(name)+": "+_.escape(symbol)+'</h1>\n<div class="details">\n	<h2>General Properties</h2>\n	<ul>\n		<li>\n			<span class="label">Atomic Number:</span>\n			<span class="value">'+_.escape(number)+'</span>\n		</li>\n		<li>\n			<span class="label">Atomic Weight:</span>\n			<span class="value">'+_.escape(atomic_mass)+'</span>\n		</li>\n		<li>\n			<span class="label">Density:</span>\n			<span class="value">'+_.escape(density)+'</span>\n		</li>\n	</ul>\n</div>\n\n<h2>Absorption Edges</h2>\n<div class="abs"></div>\n\n<div class="spectra"></div>\n\n<h2>Emission Lines</h2>\n<div class="emis"></div>\n';return __p}}),define("views/element",["backbone.marionette","views/spectrum","views/table","tpl!templates/element.html"],function(e,t,n,i){var r=Backgrid.NumberCell.extend({decimals:5});return e.View.extend({className:"page-panel",template:i,regions:{abs:".abs",emis:".emis",spec:".spectra"},onRender:function(){console.log("el view",this.model),this.getRegion("abs").show(new n({collection:this.model.get("edges"),columns:[{name:"label",label:"Edge",cell:"string",editable:!1},{name:"energy",label:"Energy (keV)",cell:r,editable:!1},{name:"yield",label:"Yield",cell:r,editable:!1}],pages:!1,backgrid:{emptyText:"No absorption edges for this element"}})),this.getRegion("emis").show(new n({collection:this.model.get("lines"),columns:[{name:"iupac",label:"IUPAC",cell:"string",editable:!1},{name:"siegbahn",label:"Siegbahn",cell:"string",editable:!1},{name:"energy",label:"Energy (keV)",cell:r,editable:!1},{name:"intensity",label:"Intensity",cell:r,editable:!1}],pages:!1,backgrid:{emptyText:"No emission lines for this element"}})),this.model.get("lines").length&&this.getRegion("spec").show(new t({model:this.model}))}})}),define("models/element",["backbone"],function(e){var t=e.Collection.extend({}),n=e.Model.extend({idAttribute:"edgeid",initialize:function(e,n){this.set({lines:new t(this.get("lines"))},{silent:!0})}}),i=e.Collection.extend({model:n}),r=e.Model.extend({});return e.Model.extend({initialize:function(e,n){var o=[];_.each(this.get("edges"),function(e){_.each(e.lines,function(t){t.sum_yield=t.intensity*e["yield"],o.push(t)})}),this.set({edges:new i(this.get("edges")),lines:new t(o),mcm:new r(this.get("mcm"))},{silent:!0})}})}),define("collections/elements",["backbone","models/element","utils/kvcollection"],function(e,t,n){return e.Collection.extend(_.extend({},n,{model:t,keyAttribute:"element",
valueAttribute:"element"}))}),define("utils/mucalc",["backbone.marionette","collections/elements","json!tables/elements.json"],function(e,t,n){return e.Object.extend({initialize:function(e){this.elements=new t(n),this.ephoton=e.ephoton||10},muCalc:function(e){var t=0,n=0,i=this.hashFromComposition(e.formula);_.each(i,function(e,i){var r=this.elements.findWhere({symbol:i});if(r){var o=this.elementMu({element:i});t+=e*r.get("atomic_mass"),n+=o[3]*e*r.get("atomic_mass")}},this),n*=e.density/t;var r=1/n,o=100*(1-Math.exp(100*-n*e.thickness));return{mu:n,abslen:r/100,absamount:o}},elementMu:function(e){var t=this.elements.findWhere({symbol:e.element}),n=t.get("mcm");if(t){var i=t.get("edges"),r=null,o=null;_.every(["K","L3","M1"],function(e){o=e;var t=i.findWhere({label:e});if(t){if(this.ephoton>=t.get("energy")){if(r=this.mcMasterCalc({fit:n.get(e[0].toLowerCase()+"fit")}),"L3"==e){var s={L1:1,L2:1.16,L3:2.57};_.each(s,function(e,t){var n=i.findWhere({label:t});n&&this.ephoton>n.get("energy")&&(r/=e)},this)}return!1}return!0}},this),null===r&&(r=this.mcMasterCalc({fit:n.get("nfit")}));var s=this.mcMasterCalc({fit:n.get("coherent")}),a=this.mcMasterCalc({fit:n.get("incoherent")}),l=n.get("conversion");return[s/l,a/l,r/l,(s+a+r)/l]}},mcMasterCalc:function(e){var t=Math.log(this.ephoton),n=0;return _.each(e.fit,function(e,i){n+=e*Math.pow(t,i)}),Math.exp(n)},hashFromComposition:function(e){for(var t=new RegExp(/\(/),n=(new RegExp(/\)/),t),i=new RegExp(/\d*\.?\d+/),r=e;-1!=r.search(n);){var o=r.indexOf(")"),s=r.lastIndexOf("(",o),a=1,l=o+1,u=r.substring(l);if(0==u.search(i)){var c=i.exec(u);a=Number.parseFloat(c),l+=c.length}var h=r.substring(s+1,o),d=this.hashFromBracketlessComposition(h);d=this.weightHash(d,a);var f=this.stringifyElementHash(d),p=r.substring(0,s),m=r.substring(l,r.length);r=p+f+m}var g=this.hashFromBracketlessComposition(r);return g},hashFromBracketlessComposition:function(e){var t=new RegExp(/[A-Z][a-z]?\d*\.?\d*/g),n=new RegExp(/\d/),i=new RegExp(/[A-Z][a-z]?/),r=new RegExp(/\d+\.?\d*/),o=e.match(t);o=_.map(o,function(e,t,i){return-1==e.search(n)?e+"1":e});var s=_.reduce(o,function(e,t,n){var o=i.exec(t)[0],s=r.exec(t)[0];return s>0&&(o in e?e[o]+=Number.parseFloat(s):e[o]=Number.parseFloat(s)),e},{});return s},weightHash:function(e,t){return _.reduce(e,function(e,t,n,i){return e[n]=t*this.multiplier,e},{},{multiplier:t})},stringifyElementHash:function(e){var t="C"in e?Object.keys(e).sort(this.compareHill.bind(this)):Object.keys(e).sort();return _.reduce(t,function(t,n,i,r){var o=e[n];return Number.isFinite(o)&&0!=o?t+n+(1!=o?o:""):t},"")},hillOrder:function(e){var t=["C","H","Ac","Ag","Al","Am","Ar","As","At","Au","B","Ba","Be","Bi","Bk","Br","Cd","Ce","Cf","Cl","Cm","Co","Cr","Cs","Cu","Dy","Er","Es","Eu","F","Fe","Fm","Fr","Ga","Gd","Ge","He","Hf","Hg","Ho","I","In","Ir","K","La","Li","Lu","Mg","Mn","Mo","N","Na","Nb","Nd","Ne","Ni","Np","O","Os","P","Pa","Pb","Pd","Pm","Po","Pr","Pt","Pu","Ra","Rb","Re","Rh","Rn","Ru","S","Sb","Sc","Se","Si","Sm","Sn","Sr","Ta","Tb","Tc","Te","Th","Ti","Tl","Tm","U","V","W","Xe","Y","Yb","Zn","Zr"];return _.indexOf(t,e)},compareHill:function(e,t){return this.hillOrder(e)-this.hillOrder(t)}})}),define("views/absplot",["backbone.marionette","jquery","Flot","Flot-selection","Flot-resize"],function(e,t){return e.View.extend({className:"absorption-plot page-panel page-panel-3",template:_.template('<h2>Energy vs Absorption</h2><div class="loading"><div class="loader"></div></div><figure></figure>'),ui:{fig:"figure",load:".loading"},events:{plotselected:"zoom","dblclick canvas":"reset",touchstart:"touchStart"},initialize:function(){this.plotAbsorption=_.debounce(this.plotAbsorption.bind(this),1e3),this.listenTo(this.collection,"change:absorption reset remove add",this.plotAbsorption)},onRender:function(){this.ui.fig.height(.4*t(window).height()),this.ui.load.height(.4*t(window).height()),this.$el.hide()},onDomRefresh:function(){this.plotAbsorption()},touchStart:function(e){if(!(e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(e.preventDefault(),e.originalEvent.touches&&e.originalEvent.touches.length)){if(this.lastClick&&new Date-this.lastClick<1e3)return void this.reset(e);this.lastClick=new Date}},reset:function(e){this.zoom(e,{xaxis:{from:null,to:null},yaxis:{from:null,to:null}})},zoom:function(e,t){if(console.log("zoom",e,t),t.xaxis){var n=this.plot.getOptions();_.each(n.xaxes,function(e){e.min=t.xaxis.from,e.max=t.xaxis.to}),_.each(n.yaxes,function(e){e.min=t.yaxis.from,e.max=t.yaxis.to}),this.plot.setupGrid(),this.plot.draw(),this.plot.clearSelection()}},plotAbsorption:function(){this.collection.length&&_.reduce(this.collection.pluck("thickness"),function(e,t){return e+t},0)&&(console.log("plotting abs"),this.$el.show(),this.ui.load.show(),setTimeout(this.doPlotAbsorption.bind(this),200))},doPlotAbsorption:function(){var e=parseFloat(this.getOption("energy").val()),n={grid:{borderWidth:0,markings:[{xaxis:{from:e,to:e},yaxis:{from:0,to:100},color:"#aaa"}]},selection:{mode:"xy"},xaxes:[{axisLabel:"Energy (keV)"}],yaxes:[{axisLabel:"Absorption (%)",max:100,min:0}]},i=[],r=[];this.collection.each(function(e){if(e.get("thickness")){var t={label:e.get("name"),data:[]},n=e.calcMu({energies:_.range(1,30,.1)});i.push(n),n.then(function(e){_.each(e,function(e){t.data.push([e.energy,e.absamount])})}),r.push(t)}},this);var o=this;Promise.all(i).then(function(e){console.log("all workers done",r),o.plot=t.plot(o.ui.fig,r,n),o.$el.show(),o.ui.load.hide()},this)}})}),define("models/material",["backbone","json!tables/elements.json"],function(e,t){return e.Model.extend({idAttribute:"name",defaults:{formula_formatted:"",custom:!1},initialize:function(e,t){this.listenTo(this,"change:formula",this.formatFormula),this.formatFormula()},formatFormula:function(){this.set({formula_formatted:this.subscriptifyNumbers(this.get("formula"))})},subscriptifyNumbers:function(e){return e?e.replace(/0/g,"₀").replace(/1/g,"₁").replace(/2/g,"₂").replace(/3/g,"₃").replace(/4/g,"₄").replace(/5/g,"₅").replace(/6/g,"₆").replace(/7/g,"₇").replace(/8/g,"₈").replace(/9/g,"₉"):void 0},calcMu:function(e){e.thickness&&this.set({thickness:e.thickness},{silent:!0});var n=this;return new Promise(function(i){var r=new Worker("js/worker.js");r.postMessage({elements:t,ephoton:e.energy,ephotons:e.energies,formula:n.get("formula"),density:n.get("density"),thickness:n.get("thickness")}),r.onmessage=function(t){console.log("message from worker",t),e.set&&n.set({absorption:t.data}),i(t.data),r.terminate()}})}})}),define("collections/materials",["backbone","models/material","utils/kvcollection"],function(e,t,n){return e.Collection.extend(_.extend({},n,{model:t,comparator:"name",keyAttribute:"name",valueAttribute:"name"}))}),function(){function e(e){return Array.prototype.slice.call(e)}function t(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function n(e,n,i){var r,o=new Promise(function(o,s){r=e[n].apply(e,i),t(r).then(o,s)});return o.request=r,o}function i(e,t,i){var r=n(e,t,i);return r.then(function(e){return e?new u(e,r.request):void 0})}function r(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]}})})}function o(e,t,i,r){r.forEach(function(r){r in i.prototype&&(e.prototype[r]=function(){return n(this[t],r,arguments)})})}function s(e,t,n,i){i.forEach(function(i){i in n.prototype&&(e.prototype[i]=function(){return this[t][i].apply(this[t],arguments)})})}function a(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})})}function l(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function c(e){this._store=e}function h(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)}})}function d(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new h(n)}function f(e){this._db=e}r(l,"_index",["name","keyPath","multiEntry","unique"]),o(l,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(l,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(u,"_cursor",["direction","key","primaryKey","value"]),o(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(u.prototype[e]=function(){var n=this,i=arguments;return Promise.resolve().then(function(){return n._cursor[e].apply(n._cursor,i),t(n._request).then(function(e){return e?new u(e,n._request):void 0})})})}),c.prototype.createIndex=function(){return new l(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new l(this._store.index.apply(this._store,arguments))},r(c,"_store",["name","keyPath","indexNames","autoIncrement"]),o(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getAllKeys","count"]),a(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(c,"_store",IDBObjectStore,["deleteIndex"]),h.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},r(h,"_tx",["objectStoreNames","mode"]),s(h,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},r(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new h(this._db.transaction.apply(this._db,arguments))},r(f,"_db",["name","version","objectStoreNames"]),s(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[c,l].forEach(function(n){n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),i=n[n.length-1],r=(this._store||this._index)[t].apply(this._store,n.slice(0,-1));r.onsuccess=function(){i(r.result)}}})}),[l,c].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,i=[];return new Promise(function(r){n.iterateCursor(e,function(e){return e?(i.push(e.value),void 0!==t&&i.length==t?void r(i):void e["continue"]()):void r(i)})})})});var p={open:function(e,t,i){var r=n(indexedDB,"open",[e,t]),o=r.request;return o.onupgradeneeded=function(e){i&&i(new d(o.result,e.oldVersion,o.transaction))},r.then(function(e){return new f(e)})},"delete":function(e){return n(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?module.exports=p:self.idb=p}(),define("utils/idb-promised",function(){}),define("utils/indexdb",["backbone.marionette","utils/idb-promised"],function(e){return e.Object.extend({stores:["materials"],initialize:function(){this.dbpromise=this.createIndexedDB()},createIndexedDB:function(){return"indexedDB"in window?idb.open("xray-utils",1,function(e){if(!e.objectStoreNames.contains("materials")){e.createObjectStore("materials",{keyPath:"name"})}}):null},save:function(e){if(console.log("saving",e),!("indexedDB"in window))return null;var t=this;return this.dbpromise.then(function(n){return t.get({store:e.store}).then(function(t){var i=n.transaction(e.store,"readwrite"),r=i.objectStore(e.store),o=e.objects.filter(function(e){return!t.some(function(t){return e.name==t.name&&e.formula==t.formula})}),s=t.filter(function(t){return!e.objects.some(function(e){return t.name==e.name&&t.formula==e.formula})}),a=o.map(function(e){r.put(e)}),l=s.map(function(e){r["delete"](e.name)}),u=a.concat(l);return Promise.all(u)["catch"](function(){throw i.abort(),Error("Objects were not synchronised to the store: "+e.store)})})})},get:function(e){return"indexedDB"in window?this.dbpromise.then(function(t){var n=t.transaction(e.store,"readonly"),i=n.objectStore(e.store);return i.getAll()}):null}})}),define("tpl!templates/absorption.html",function(){return function(obj){var __p="";with(obj||{})__p+='<div class="plot"></div>\n<div class="page-panel page-panel-2">\n    <div class="form">\n        <div class="label">Energy</div>\n        <div class="field">\n            <input type="number" name="energy" value="10" />\n        </div>\n        <div class="units">keV</div>\n    </div>\n    <div class="selected"></div>\n</div>\n\n<div class="page-panel page-panel-4">\n    <button name="add" class="full">Add Material</button>\n    <div class="newmaterial"></div>\n</div>\n\n<div class="page-panel">\n    <div class="search">\n        <input type="text" name="search" placeholder="Name / Formula" />\n    </div>\n\n    <div class="materials"></div>\n</div>\n';return __p}}),define("tpl!templates/newmaterial.html",function(){return function(obj){var __p="";with(obj||{})__p+='<form>\n<div class="form">\n	<div class="label">\n		Name\n	</div>\n	<div class="field">\n		<input type="text" name="name" required />\n	</div>\n\n	<div class="label">\n		Formula\n	</div>\n	<div class="field">\n		<input type="text" name="formula" required />\n	</div>\n\n	<div class="label">\n		Density\n	</div>\n	<div class="field">\n		<input type="number" name="density" step="0.01" required />\n	</div>\n	<div class="units">g/cm3</div>\n	<div class="field">\n		<button type="submit" name="save" class="half">Save</button>\n		<button name="cancel" class="half">Cancel</button>\n	</div>\n</div>\n</form>\n';return __p}}),define("views/absorption",["backbone.marionette","utils/mucalc","views/absplot","models/material","collections/materials","json!tables/materials.json","utils/indexdb","tpl!templates/absorption.html","tpl!templates/newmaterial.html"],function(e,t,n,i,r,o,s,a,l){var u=e.View.extend({template:l,events:{"click button[name=cancel]":"cancel","click button[name=save]":"save"},ui:{name:"input[name=name]",formula:"input[name=formula]",density:"input[name=density]"},cancel:function(){this.destroy()},save:function(e){this.$el.find("form")[0].checkValidity()&&(e.preventDefault(),this.model.set({name:this.ui.name.val(),formula:this.ui.formula.val(),density:this.ui.density.val(),custom:!0}),this.getOption("collection").add(this.model),this.cancel())},initialize:function(e){this.model=new i}}),c=e.View.extend({template:_.template('<div class="label"><%-name%></div><div class="field"><input type="number" name="thickness"/></div><div class="units">&micro;m</div><div class="result"></div><div class="buttons"><button name="remove">x</button>'),className:"form",ui:{thickness:"input[name=thickness]",res:".result"},events:{"change @ui.thickness":"calcMu","keyup @ui.thickness":"calcMu","click button[name=remove]":"removeModel"},initialize:function(){this.getOption("energy").on("keyup",this.calcMu.bind(this)),this.calcMu=_.debounce(this.calcMu.bind(this),100)},onDomRefresh:function(){console.log("render sel",this.$el.offset().top),$("html, body").animate({scrollTop:0},1e3),this.ui.thickness.focus()},removeModel:function(e){e.preventDefault(),this.model.collection.remove(this.model)},calcMu:function(e){var t=this.model.calcMu({energy:this.getOption("energy").val(),thickness:1e-6*parseFloat(this.ui.thickness.val()),set:!0});t.then(this.showCalcMu.bind(this))},showCalcMu:function(){this.ui.res.html("Absorbs "+this.model.get("absorption").absamount.toFixed(1)+"% Length: "+(this.model.get("absorption").abslen/1e-6).toFixed(2)+"&micro;m")}}),h=e.CollectionView.extend({childView:c}),d=e.View.extend({className:function(){return"element"+(this.model.get("custom")?" custom":"")},template:_.template('<% if (custom) { %><button name="delete" class="right">x</button><% } %><h2><%-name%></h2><span class="formula"><%-formula_formatted%></span>'),events:{'click button[name="delete"]':"deleteCustom",click:"addMaterial"},addMaterial:function(e){e.preventDefault(),$(e.target).is('button[name="delete"]')||(console.log("add done"),this.model.collection.trigger("select",this.model))},deleteCustom:function(e){e.preventDefault();var t=this.getOption("custommaterials").findWhere({name:this.model.get("name"),formula:this.model.get("formula")});t&&this.getOption("custommaterials").remove(t)}}),f=e.CollectionView.extend({className:"materials",childView:d}),p=function(e,t){var n=new e.constructor;return n._callbacks={},n._currentFilter=t,n.filterItems=function(t){var i=e.filter(t);return n.reset(i),n},e.on("reset change destroy",function(){return n.filterItems(n._currentFilter)}),n.filterItems(t)};return e.View.extend({template:a,regions:{materials:{el:".materials",replaceElement:!0},selected:{el:".selected",replaceElement:!0},plot:{el:".plot",replaceElement:!0},nm:".newmaterial"},ui:{search:"input[name=search]",energy:"input[name=energy]"},events:{"keyup @ui.search":"filterList","click button[name=add]":"addMaterial"},initialize:function(){this.custommaterials=new r,this.listenTo(this.custommaterials,"add remove reset",this.updateCustomMaterials),this.materials=new r,this.listenTo(this.materials,"select",this.selectMaterial),this.selected=new r,this.store=new s,this.getCustomMaterials()},getCustomMaterials:function(){var e=this;this.store.get({store:"materials"}).then(function(t){console.log("got custom",t),e.custommaterials.reset(t)})},updateCustomMaterials:function(e,t,n){var r=o.concat(this.custommaterials.toJSON());this.materials.reset(r).sort(),e instanceof i&&(this.store.save({store:"materials",objects:this.custommaterials.toJSON()}).then(function(){console.log("saved custom materials")}),n.add&&this.selected.add(e.clone()))},addMaterial:function(e){e.preventDefault(),this.getRegion("nm").show(new u({collection:this.custommaterials}))},selectMaterial:function(e){console.log("select mat",e),this.selected.add(e.clone())},filterList:function(e){console.log("filter list"),this.materials.trigger("reset")},filter:function(e){var t=this.ui.search.val().toLowerCase();return e.get("name").toLowerCase().startsWith(t)||e.get("formula").toLowerCase().includes(t)},onRender:function(){var e=p(this.materials,this.filter.bind(this));this.getRegion("materials").show(new f({collection:e,childViewOptions:{custommaterials:this.custommaterials}})),this.getRegion("selected").show(new h({collection:this.selected,childViewOptions:{energy:this.ui.energy}})),this.getRegion("plot").show(new n({collection:this.selected,energy:this.ui.energy}))},onDomRefresh:function(){this.ui.search.focus()}})}),define("tpl!templates/ionchamber.html",function(){return function(obj){var __p="";with(obj||{})__p+='<div class="page-panel">\n    <div class="form">\n\n        <div class="label">Gas 1</div>\n        <div class="field">\n            <select name="gas1"></select>\n            <input type="number" name="gas1prop" value="100" min="0" max="100" />\n        </div>\n        <div class="units">%</div>\n\n        <div class="label">Gas 2</div>\n        <div class="field">\n            <select name="gas2"></select>\n            <input type="number" name="gas2prop" value="0" min="0" max="100" />\n        </div>\n        <div class="units">%</div>\n\n\n        <div class="label">Pressure</div>\n        <div class="field">\n            <input type="text" name="pressure" value="760" />\n        </div>\n        <div class="units">torr</div>\n\n        <div class="label">Energy</div>\n        <div class="field">\n            <input type="text" name="energy" value="9" />\n        </div>\n        <div class="units">keV</div>\n\n        <div class="label">Voltage</div>\n        <div class="field">\n            <input type="text" name="voltage" value="5000" />\n        </div>\n        <div class="units">V</div>\n\n        <div class="label">IC Length</div>\n        <div class="field">\n            <input type="text" name="iclength" value="2" />\n        </div>\n        <div class="units">cm</div>\n\n        <div class="label">Gain</div>\n        <div class="field">\n            <input type="number" name="gain" value="8" min="1" max="10" />\n        </div>\n\n    </div>\n</div>\n\n\n<div class="page-panel page-panel-2">\n    <div class="form">\n        <div class="label">Flux</div>\n        <div class="field">\n            <div class="result"></div>\n        </div>\n        <div class="units">ph/s</div>\n    </div>\n</div>\n';return __p}}),define("views/ionchamber",["backbone.marionette","utils/mucalc","models/material","collections/materials","json!tables/materials.json","tpl!templates/ionchamber.html"],function(e,t,n,i,r,o){return e.View.extend({template:o,ui:{g1p:"input[name=gas1prop]",g2p:"input[name=gas2prop]",g1:"select[name=gas1]",g2:"select[name=gas2]",pressure:"input[name=pressure]",energy:"input[name=energy]",voltage:"input[name=voltage]",iclength:"input[name=iclength]",gain:"input[name=gain]",result:".result"},events:{"change @ui.g1p":"updateGas2","change @ui.g2p":"updateGas1","change @ui.g1":"calculateIC","change @ui.g2":"calculateIC","change @ui.pressure":"calculateIC","change @ui.energy":"calculateIC","change @ui.voltage":"calculateIC","change @ui.iclength":"calculateIC","change @ui.gain":"calculateIC"},initialize:function(e){var t=new i(r);this.materials=new i(t.filter(function(e){return e.get("ip")}))},updateGas1:function(){this.ui.g1p.val(100-this.ui.g2p.val()),this.calculateIC()},updateGas2:function(){this.ui.g2p.val(100-this.ui.g1p.val()),this.calculateIC()},onRender:function(){this.ui.g1.html(this.materials.opts()),this.ui.g2.html(this.materials.opts()),this.calculateIC()},calculateIC:function(){if(console.log("calc",!this.ui.energy.val(),!this.ui.pressure.val(),!this.ui.voltage.val(),!this.ui.iclength.val()),this.ui.energy.val()&&this.ui.pressure.val()&&this.ui.voltage.val()&&this.ui.iclength.val()){var e=this.materials.findWhere({name:this.ui.g1.val()}),t=this.materials.findWhere({name:this.ui.g2.val()}),i="("+e.get("formula")+")"+this.ui.g1p.val()/100+"("+t.get("formula")+")"+this.ui.g2p.val()/100,r=this.ui.g1p.val()/100*this.ui.pressure.val()/760*e.get("density")+this.ui.g2p.val()/100*this.ui.pressure.val()/760*t.get("density"),o=new n({formula:i,density:r,thickness:this.ui.iclength.val()/100}),s=o.calcMu({energy:this.ui.energy.val(),set:!0}),a=this;s.then(function(){var n=o.get("absorption");console.log(i,r,n);var s=a.ui.g1p.val()/100*e.get("ip")+a.ui.g2p.val()/100*t.get("ip"),l=a.ui.voltage.val()*s/(1.6e-19*Math.pow(10,1*a.ui.gain.val())*a.ui.energy.val()*1e3*n.absamount/100);console.log(s,l),a.ui.result.text(l.toExponential(6))})}}})}),define("tpl!templates/about.html",function(){return function(obj){var __p="";with(obj||{})__p+='<h1>Quantum Detectors</h1>\n<p><a href="https://quantumdetectors.com/">https://quantumdetectors.com/</a></p>\n\n<p>\nThis a port of Xray-Utils by Sam Webb\n<a href="https://www.sams-xrays.com/xru">https://www.sams-xrays.com/xru</a>\n</p>\n\n<h2>References</h2>\n<ul class="references">\n	<li>\n		McMaster Calculations derrived from:<br />\n		W.H. McMaster N.K. Del Grande, J.H. Mallett and J.H. Hubbell, "Compilation of x-ray cross sections", Lawrence Livermore National Laboratory Report UCRL-50174 (section I 1970, section II 1969, section III 1969 and section IV 1969).\n	</li>\n\n	<li>\n		X-ray Absorption and Emission Lines data from:<br />\n		<a href="https://github.com/scikit-beam/XrayDB">https://github.com/scikit-beam/XrayDB</a>\n	</li>\n\n	<li>\n		JSON Periodic Table<br />\n		<a href="https://github.com/Bowserinator/Periodic-Table-JSON">https://github.com/Bowserinator/Periodic-Table-JSON</a>\n	</li>\n</ul>\n\n\n<h2>Other Useful Tools</h2>\n<p>\n	Online MCA fitting\n	<a href="https://quantumdetectors.com/xrf-web">https://quantumdetectors.com/xrf-web</a>\n</p>\n\n<h2>Source Code</h2>\n<p>\n	<a href="https://github.com/quantumdetectors/xray-utils">https://github.com/quantumdetectors/xray-utils</a>\n</p>\n';return __p}}),define("views/about",["backbone.marionette","tpl!templates/about.html"],function(e,t){return e.View.extend({className:"page-panel",template:t})}),define("controller",["views/status","views/elementlist","views/element","views/absorption","views/ionchamber","views/about","collections/elements","json!tables/elements.json"],function(e,t,n,i,r,o,s,a){var l={facility_status:function(){app.bc.reset([{title:"Facility Status"}]),app.content.show(new e)},element_list:function(){var e=new s(a);app.bc.reset([{title:"Element List"}]),app.content.show(new t({collection:e}))},element:function(e){var t=new s(a),i=t.findWhere({symbol:e});app.bc.reset([{title:"Element"}]),i&&(console.log("loading eview"),app.content.show(new n({model:i})))},absorption:function(){var e=new s(a);app.bc.reset([{title:"Absorption"}]),app.content.show(new i({elements:e}))},ionchamber:function(){app.bc.reset([{title:"Ion Chamber"}]),app.content.show(new r)},about:function(){app.bc.reset([{title:"About"}]),app.content.show(new o)}};return app.on("show:element",function(e){l.element(e),app.navigate("#element/"+e)}),l}),define("router",["backbone.marionette","controller"],function(e,t){var n=e.AppRouter.extend({appRoutes:{status:"facility_status",element:"element_list","element/:element":"element",abs:"absorption",ion:"ionchamber",about:"about","*home":"element_list"},onRoute:function(e,t,n){"*home"==t&&(t="element"),$(".navbar-main a").removeClass("active"),$(".navbar-main a").each(function(e,n){var i=$(n),r=i.attr("href").replace(/#/,"");r==t&&i.addClass("active")})}});return new n({controller:t})}),define("app",["backbone","backbone.marionette","views/main","jquery"],function(e,t,n,i){var r=t.Application.extend({region:"body",onStart:function(){this.bc=new e.Collection,require(["router"],this.starthistory.bind(this)),this.main=new n({bc:this.bc}),this.showView(this.main),this.content=this.main.getRegion("content")},starthistory:function(){console.log("start history"),e.history&&e.history.start()},navigate:function(t,n){n||(n={}),e.history.navigate(t,n)},mobile:function(){return i(window).width()<568}});return window.app=new r,i(window).scroll(_.debounce(function(){app.trigger("window:scroll")},10)),i(window).resize(_.debounce(function(){app.trigger("window:resize")},50)),app}),require.config({shim:{Flot:{deps:["jquery"],exports:"$.plot"},"Flot-pie":{deps:["Flot"]},"Flot-stack":{deps:["Flot"]},"Flot-selection":{deps:["Flot"]},"Flot-resize":{deps:["Flot"]},"flot.tooltip.pib":{deps:["Flot"]},"Flot-axislabels":{deps:["Flot"]},"Flot-time":{deps:["Flot"]},"jquery-color":{deps:["jquery"]}},paths:{Flot:"vendor/Flot/jquery.flot","Flot-pie":"vendor/Flot/jquery.flot.pie","Flot-stack":"vendor/Flot/jquery.flot.stack","Flot-time":"vendor/Flot/jquery.flot.time","Flot-selection":"vendor/Flot/jquery.flot.selection","Flot-resize":"vendor/Flot/jquery.flot.resize","backbone.marionette":"vendor/backbone.marionette/lib/backbone.marionette","backbone.validation":"vendor/backbone.validation/dist/backbone-validation",requirejs:"vendor/requirejs/require",backgrid:"vendor/backgrid/lib/backgrid","backgrid-paginator":"vendor/backgrid-paginator/backgrid-paginator","backbone.paginator":"vendor/backbone.paginator/lib/backbone.paginator",backbone:"vendor/backbone/backbone",jquery:"vendor/jquery/dist/jquery","jquery-color":"vendor/jquery-color/jquery.color",underscore:"vendor/underscore/underscore","backbone.radio":"vendor/backbone.radio/build/backbone.radio","flot.tooltip.pib":"vendor/flot.tooltip.pib/js/jquery.flot.tooltip","backbone.syphon":"vendor/backbone.syphon/lib/backbone.syphon",moment:"vendor/moment/moment"}}),require(["app"],function(e){"use strict";e.start()}),define("main",function(){});